# title: "**Generating moment arm plot from palaeognath SIMM model**"
# project for: "thesis!"
# author: "Wani2Y"
# first created: "18/11/2022"
# last modified: "26/03/2023"

# load the necessary libraries
library(tidyverse)
library(reshape2)
library(data.table)
library(ggplot2)
library(ggpubr)
library(gridExtra)
library(stringi)


#read in the moment arm csv files
filenames <- tools::file_path_sans_ext(
  list.files(path ="./crocodylian/",
             pattern ="*.csv")) 

#read in oROM file
oROM <- read.csv("oROM_croc.csv", header = TRUE)

big_table <- list()
for(i in filenames){
  filepath <- file.path("./crocodylian/",paste(i,".csv",sep =""))
  big_table[[i]] <- read.csv(filepath)
}

# seprate big tables into lists of muscles
# LC
LC_list <- list()
for(i in 1: length(big_table)){
  if (str_detect(names(big_table[i]), "MLC_")){
    LC_list = append(LC_list, big_table[i])
  }
}

# VIC
VIC_list <- list()
for(i in 1: length(big_table)){
  if (str_detect(names(big_table[i]), "VIC_")){
    VIC_list = append(VIC_list, big_table[i])
  }
}

# IE
IE_list <- list()
for(i in 1: length(big_table)){
  if (str_detect(names(big_table[i]), "MIE_")){
    IE_list = append(IE_list, big_table[i])
  }
}

# APC
APC_list <- list()
for(i in 1: length(big_table)){
  if (str_detect(names(big_table[i]), "MA_")){
    APC_list = append(APC_list, big_table[i])
  }
}

# II
II_list <- list()
for(i in 1: length(big_table)){
  if (str_detect(names(big_table[i]), "MII_")){
    II_list = append(II_list, big_table[i])
  }
}

# SC
SC_list <- list()
for(i in 1: length(big_table)){
  if (str_detect(names(big_table[i]), "MSUB_")){
    SC_list = append(SC_list, big_table[i])
  }
}

Rib_names <- c(
  "C10", "C11", "C13", "C15",
  "IR11", "IR13", "IR16",
  "SR11", "SR13", "SR15"
)

# get max moment arm values for bar graphs
#VIC
VIC_clean_list <- VIC_list[-c(1:3)]
VIC_clean_data <- data.frame(
  jnt = c("C10", "C11", "C13", "C15", "PC10", "PC11"),
  max_u1_x = c(VIC_clean_list[[1]][which.max(abs(VIC_clean_list[[1]][[2]])), which(colnames(VIC_clean_list[[1]]) == "um_u1_axial")],
               VIC_clean_list[[2]][which.max(abs(VIC_clean_list[[2]][[2]])), which(colnames(VIC_clean_list[[2]]) == "um_u1_axial")],
               VIC_clean_list[[3]][which.max(abs(VIC_clean_list[[3]][[2]])), which(colnames(VIC_clean_list[[3]]) == "um_u1_axial")],
               VIC_clean_list[[4]][which.max(abs(VIC_clean_list[[4]][[2]])), which(colnames(VIC_clean_list[[4]]) == "um_u1_axial")],
               VIC_clean_list[[13]][which.max(abs(VIC_clean_list[[13]][[2]])), which(colnames(VIC_clean_list[[13]]) == "um_u1_axial")],
               VIC_clean_list[[14]][which.max(abs(VIC_clean_list[[14]][[2]])), which(colnames(VIC_clean_list[[14]]) == "um_u1_axial")]),
  
  max_u2_x = c(VIC_clean_list[[1]][which.max(abs(VIC_clean_list[[1]][[2]])), which(colnames(VIC_clean_list[[1]]) == "um_u2_axial")],
               VIC_clean_list[[2]][which.max(abs(VIC_clean_list[[2]][[2]])), which(colnames(VIC_clean_list[[2]]) == "um_u2_axial")],
               VIC_clean_list[[3]][which.max(abs(VIC_clean_list[[3]][[2]])), which(colnames(VIC_clean_list[[3]]) == "um_u2_axial")],
               VIC_clean_list[[4]][which.max(abs(VIC_clean_list[[4]][[2]])), which(colnames(VIC_clean_list[[4]]) == "um_u2_axial")],
               NA,
               NA),
  
  max_u3_x = c(VIC_clean_list[[1]][which.max(abs(VIC_clean_list[[1]][[2]])), which(colnames(VIC_clean_list[[1]]) == "um_u3_axial")],
               VIC_clean_list[[2]][which.max(abs(VIC_clean_list[[2]][[2]])), which(colnames(VIC_clean_list[[2]]) == "um_u3_axial")],
               VIC_clean_list[[3]][which.max(abs(VIC_clean_list[[3]][[2]])), which(colnames(VIC_clean_list[[3]]) == "um_u3_axial")],
               VIC_clean_list[[4]][which.max(abs(VIC_clean_list[[4]][[2]])), which(colnames(VIC_clean_list[[4]]) == "um_u3_axial")],
               NA,
               NA),
  
  max_u4_x = c(VIC_clean_list[[1]][which.max(abs(VIC_clean_list[[1]][[2]])), which(colnames(VIC_clean_list[[1]]) == "um_u4_axial")],
               VIC_clean_list[[2]][which.max(abs(VIC_clean_list[[2]][[2]])), which(colnames(VIC_clean_list[[2]]) == "um_u4_axial")],
               VIC_clean_list[[3]][which.max(abs(VIC_clean_list[[3]][[2]])), which(colnames(VIC_clean_list[[3]]) == "um_u4_axial")],
               VIC_clean_list[[4]][which.max(abs(VIC_clean_list[[4]][[2]])), which(colnames(VIC_clean_list[[4]]) == "um_u4_axial")],
               NA,
               NA),
  
  max_u5_x = c(VIC_clean_list[[1]][which.max(abs(VIC_clean_list[[1]][[2]])), which(colnames(VIC_clean_list[[1]]) == "um_u5_axial")],
               VIC_clean_list[[2]][which.max(abs(VIC_clean_list[[2]][[2]])), which(colnames(VIC_clean_list[[2]]) == "um_u5_axial")],
               VIC_clean_list[[3]][which.max(abs(VIC_clean_list[[3]][[2]])), which(colnames(VIC_clean_list[[3]]) == "um_u5_axial")],
               VIC_clean_list[[4]][which.max(abs(VIC_clean_list[[4]][[2]])), which(colnames(VIC_clean_list[[4]]) == "um_u5_axial")],
               NA,
               NA),
  
  max_u1_y = c(VIC_clean_list[[1]][which.max(abs(VIC_clean_list[[1]][[3]])), which(colnames(VIC_clean_list[[1]]) == "um_u1_abd_add")],
               VIC_clean_list[[2]][which.max(abs(VIC_clean_list[[2]][[3]])), which(colnames(VIC_clean_list[[2]]) == "um_u1_abd_add")],
               VIC_clean_list[[3]][which.max(abs(VIC_clean_list[[3]][[3]])), which(colnames(VIC_clean_list[[3]]) == "um_u1_abd_add")],
               VIC_clean_list[[4]][which.max(abs(VIC_clean_list[[4]][[3]])), which(colnames(VIC_clean_list[[4]]) == "um_u1_abd_add")],
               VIC_clean_list[[13]][which.max(abs(VIC_clean_list[[13]][[3]])), which(colnames(VIC_clean_list[[13]]) == "um_u1_abd_add")],
               VIC_clean_list[[14]][which.max(abs(VIC_clean_list[[14]][[3]])), which(colnames(VIC_clean_list[[14]]) == "um_u1_abd_add")]),
  
  max_u2_y = c(VIC_clean_list[[1]][which.max(abs(VIC_clean_list[[1]][[3]])), which(colnames(VIC_clean_list[[1]]) == "um_u2_abd_add")],
               VIC_clean_list[[2]][which.max(abs(VIC_clean_list[[2]][[3]])), which(colnames(VIC_clean_list[[2]]) == "um_u2_abd_add")],
               VIC_clean_list[[3]][which.max(abs(VIC_clean_list[[3]][[3]])), which(colnames(VIC_clean_list[[3]]) == "um_u2_abd_add")],
               VIC_clean_list[[4]][which.max(abs(VIC_clean_list[[4]][[3]])), which(colnames(VIC_clean_list[[4]]) == "um_u2_abd_add")],
               NA,
               NA),

  max_u3_y = c(VIC_clean_list[[1]][which.max(abs(VIC_clean_list[[1]][[3]])), which(colnames(VIC_clean_list[[1]]) == "um_u3_abd_add")],
               VIC_clean_list[[2]][which.max(abs(VIC_clean_list[[2]][[3]])), which(colnames(VIC_clean_list[[2]]) == "um_u3_abd_add")],
               VIC_clean_list[[3]][which.max(abs(VIC_clean_list[[3]][[3]])), which(colnames(VIC_clean_list[[3]]) == "um_u3_abd_add")],
               VIC_clean_list[[4]][which.max(abs(VIC_clean_list[[4]][[3]])), which(colnames(VIC_clean_list[[4]]) == "um_u3_abd_add")],
               NA,
               NA),
  
  max_u4_y = c(VIC_clean_list[[1]][which.max(abs(VIC_clean_list[[1]][[3]])), which(colnames(VIC_clean_list[[1]]) == "um_u4_abd_add")],
               VIC_clean_list[[2]][which.max(abs(VIC_clean_list[[2]][[3]])), which(colnames(VIC_clean_list[[2]]) == "um_u4_abd_add")],
               VIC_clean_list[[3]][which.max(abs(VIC_clean_list[[3]][[3]])), which(colnames(VIC_clean_list[[3]]) == "um_u4_abd_add")],
               VIC_clean_list[[4]][which.max(abs(VIC_clean_list[[4]][[3]])), which(colnames(VIC_clean_list[[4]]) == "um_u4_abd_add")],
               NA,
               NA),
  
  max_u5_y = c(VIC_clean_list[[1]][which.max(abs(VIC_clean_list[[1]][[3]])), which(colnames(VIC_clean_list[[1]]) == "um_u5_abd_add")],
               VIC_clean_list[[2]][which.max(abs(VIC_clean_list[[2]][[3]])), which(colnames(VIC_clean_list[[2]]) == "um_u5_abd_add")],
               VIC_clean_list[[3]][which.max(abs(VIC_clean_list[[3]][[3]])), which(colnames(VIC_clean_list[[3]]) == "um_u5_abd_add")],
               VIC_clean_list[[4]][which.max(abs(VIC_clean_list[[4]][[3]])), which(colnames(VIC_clean_list[[4]]) == "um_u5_abd_add")],
               NA,
               NA),
  
  max_u1_z = c(VIC_clean_list[[1]][which.max(abs(VIC_clean_list[[1]][[4]])), which(colnames(VIC_clean_list[[1]]) == "um_u1_pro_re")],
               VIC_clean_list[[2]][which.max(abs(VIC_clean_list[[2]][[4]])), which(colnames(VIC_clean_list[[2]]) == "um_u1_pro_re")],
               VIC_clean_list[[3]][which.max(abs(VIC_clean_list[[3]][[4]])), which(colnames(VIC_clean_list[[3]]) == "um_u1_pro_re")],
               VIC_clean_list[[4]][which.max(abs(VIC_clean_list[[4]][[4]])), which(colnames(VIC_clean_list[[4]]) == "um_u1_pro_re")],
               VIC_clean_list[[13]][which.max(abs(VIC_clean_list[[13]][[4]])), which(colnames(VIC_clean_list[[13]]) == "um_u1_pro_re")],
               VIC_clean_list[[14]][which.max(abs(VIC_clean_list[[14]][[4]])), which(colnames(VIC_clean_list[[14]]) == "um_u1_pro_re")]),
  
  max_u2_z = c(VIC_clean_list[[1]][which.max(abs(VIC_clean_list[[1]][[4]])), which(colnames(VIC_clean_list[[1]]) == "um_u2_pro_re")],
               VIC_clean_list[[2]][which.max(abs(VIC_clean_list[[2]][[4]])), which(colnames(VIC_clean_list[[2]]) == "um_u2_pro_re")],
               VIC_clean_list[[3]][which.max(abs(VIC_clean_list[[3]][[4]])), which(colnames(VIC_clean_list[[3]]) == "um_u2_pro_re")],
               VIC_clean_list[[4]][which.max(abs(VIC_clean_list[[4]][[4]])), which(colnames(VIC_clean_list[[4]]) == "um_u2_pro_re")],
               NA,
               NA),
  
  max_u3_z = c(VIC_clean_list[[1]][which.max(abs(VIC_clean_list[[1]][[4]])), which(colnames(VIC_clean_list[[1]]) == "um_u3_pro_re")],
               VIC_clean_list[[2]][which.max(abs(VIC_clean_list[[2]][[4]])), which(colnames(VIC_clean_list[[2]]) == "um_u3_pro_re")],
               VIC_clean_list[[3]][which.max(abs(VIC_clean_list[[3]][[4]])), which(colnames(VIC_clean_list[[3]]) == "um_u3_pro_re")],
               VIC_clean_list[[4]][which.max(abs(VIC_clean_list[[4]][[4]])), which(colnames(VIC_clean_list[[4]]) == "um_u3_pro_re")],
               NA,
               NA),
  
  max_u4_z = c(VIC_clean_list[[1]][which.max(abs(VIC_clean_list[[1]][[4]])), which(colnames(VIC_clean_list[[1]]) == "um_u4_pro_re")],
               VIC_clean_list[[2]][which.max(abs(VIC_clean_list[[2]][[4]])), which(colnames(VIC_clean_list[[2]]) == "um_u4_pro_re")],
               VIC_clean_list[[3]][which.max(abs(VIC_clean_list[[3]][[4]])), which(colnames(VIC_clean_list[[3]]) == "um_u4_pro_re")],
               VIC_clean_list[[4]][which.max(abs(VIC_clean_list[[4]][[4]])), which(colnames(VIC_clean_list[[4]]) == "um_u4_pro_re")],
               NA,
               NA),
  
  max_u5_z = c(VIC_clean_list[[1]][which.max(abs(VIC_clean_list[[1]][[4]])), which(colnames(VIC_clean_list[[1]]) == "um_u5_pro_re")],
               VIC_clean_list[[2]][which.max(abs(VIC_clean_list[[2]][[4]])), which(colnames(VIC_clean_list[[2]]) == "um_u5_pro_re")],
               VIC_clean_list[[3]][which.max(abs(VIC_clean_list[[3]][[4]])), which(colnames(VIC_clean_list[[3]]) == "um_u5_pro_re")],
               VIC_clean_list[[4]][which.max(abs(VIC_clean_list[[4]][[4]])), which(colnames(VIC_clean_list[[4]]) == "um_u5_pro_re")],
               NA,
               NA),
  
  wd_u1_x = c(VIC_clean_list[[5]][which.max(abs(VIC_clean_list[[5]][[2]])), which(colnames(VIC_clean_list[[5]]) == "um_u1_axial")],
               VIC_clean_list[[6]][which.max(abs(VIC_clean_list[[6]][[2]])), which(colnames(VIC_clean_list[[6]]) == "um_u1_axial")],
               VIC_clean_list[[7]][which.max(abs(VIC_clean_list[[7]][[2]])), which(colnames(VIC_clean_list[[7]]) == "um_u1_axial")],
               VIC_clean_list[[8]][which.max(abs(VIC_clean_list[[8]][[2]])), which(colnames(VIC_clean_list[[8]]) == "um_u1_axial")],
               VIC_clean_list[[15]][which.max(abs(VIC_clean_list[[15]][[2]])), which(colnames(VIC_clean_list[[15]]) == "um_u1_axial")],
               VIC_clean_list[[16]][which.max(abs(VIC_clean_list[[16]][[2]])), which(colnames(VIC_clean_list[[16]]) == "um_u1_axial")]),
  
  wd_u2_x = c(VIC_clean_list[[5]][which.max(abs(VIC_clean_list[[5]][[2]])), which(colnames(VIC_clean_list[[5]]) == "um_u2_axial")],
               VIC_clean_list[[6]][which.max(abs(VIC_clean_list[[6]][[2]])), which(colnames(VIC_clean_list[[6]]) == "um_u2_axial")],
               VIC_clean_list[[7]][which.max(abs(VIC_clean_list[[7]][[2]])), which(colnames(VIC_clean_list[[7]]) == "um_u2_axial")],
               VIC_clean_list[[8]][which.max(abs(VIC_clean_list[[8]][[2]])), which(colnames(VIC_clean_list[[8]]) == "um_u2_axial")],
              NA,
              NA),
  
  wd_u3_x = c(VIC_clean_list[[5]][which.max(abs(VIC_clean_list[[5]][[2]])), which(colnames(VIC_clean_list[[5]]) == "um_u3_axial")],
               VIC_clean_list[[6]][which.max(abs(VIC_clean_list[[6]][[2]])), which(colnames(VIC_clean_list[[6]]) == "um_u3_axial")],
               VIC_clean_list[[7]][which.max(abs(VIC_clean_list[[7]][[2]])), which(colnames(VIC_clean_list[[7]]) == "um_u3_axial")],
               VIC_clean_list[[8]][which.max(abs(VIC_clean_list[[8]][[2]])), which(colnames(VIC_clean_list[[8]]) == "um_u3_axial")],
              NA,
              NA),
  
  wd_u4_x = c(VIC_clean_list[[5]][which.max(abs(VIC_clean_list[[5]][[2]])), which(colnames(VIC_clean_list[[5]]) == "um_u4_axial")],
               VIC_clean_list[[6]][which.max(abs(VIC_clean_list[[6]][[2]])), which(colnames(VIC_clean_list[[6]]) == "um_u4_axial")],
               VIC_clean_list[[7]][which.max(abs(VIC_clean_list[[7]][[2]])), which(colnames(VIC_clean_list[[7]]) == "um_u4_axial")],
               VIC_clean_list[[8]][which.max(abs(VIC_clean_list[[8]][[2]])), which(colnames(VIC_clean_list[[8]]) == "um_u4_axial")],
              NA,
              NA),
  
  wd_u5_x = c(VIC_clean_list[[5]][which.max(abs(VIC_clean_list[[5]][[2]])), which(colnames(VIC_clean_list[[5]]) == "um_u5_axial")],
               VIC_clean_list[[6]][which.max(abs(VIC_clean_list[[6]][[2]])), which(colnames(VIC_clean_list[[6]]) == "um_u5_axial")],
               VIC_clean_list[[7]][which.max(abs(VIC_clean_list[[7]][[2]])), which(colnames(VIC_clean_list[[7]]) == "um_u5_axial")],
               VIC_clean_list[[8]][which.max(abs(VIC_clean_list[[8]][[2]])), which(colnames(VIC_clean_list[[8]]) == "um_u5_axial")],
              NA,
              NA),
  
  wd_u1_y = c(VIC_clean_list[[5]][which.max(abs(VIC_clean_list[[5]][[3]])), which(colnames(VIC_clean_list[[5]]) == "um_u1_abd_add")],
               VIC_clean_list[[6]][which.max(abs(VIC_clean_list[[6]][[3]])), which(colnames(VIC_clean_list[[6]]) == "um_u1_abd_add")],
               VIC_clean_list[[7]][which.max(abs(VIC_clean_list[[7]][[3]])), which(colnames(VIC_clean_list[[7]]) == "um_u1_abd_add")],
               VIC_clean_list[[8]][which.max(abs(VIC_clean_list[[8]][[3]])), which(colnames(VIC_clean_list[[8]]) == "um_u1_abd_add")],
               VIC_clean_list[[15]][which.max(abs(VIC_clean_list[[15]][[3]])), which(colnames(VIC_clean_list[[15]]) == "um_u1_abd_add")],
               VIC_clean_list[[16]][which.max(abs(VIC_clean_list[[16]][[3]])), which(colnames(VIC_clean_list[[16]]) == "um_u1_abd_add")]),
  
  wd_u2_y = c(VIC_clean_list[[5]][which.max(abs(VIC_clean_list[[5]][[3]])), which(colnames(VIC_clean_list[[5]]) == "um_u2_abd_add")],
               VIC_clean_list[[6]][which.max(abs(VIC_clean_list[[6]][[3]])), which(colnames(VIC_clean_list[[6]]) == "um_u2_abd_add")],
               VIC_clean_list[[7]][which.max(abs(VIC_clean_list[[7]][[3]])), which(colnames(VIC_clean_list[[7]]) == "um_u2_abd_add")],
               VIC_clean_list[[8]][which.max(abs(VIC_clean_list[[8]][[3]])), which(colnames(VIC_clean_list[[8]]) == "um_u2_abd_add")],
              NA,
              NA),
  
  wd_u3_y = c(VIC_clean_list[[5]][which.max(abs(VIC_clean_list[[5]][[3]])), which(colnames(VIC_clean_list[[5]]) == "um_u3_abd_add")],
               VIC_clean_list[[6]][which.max(abs(VIC_clean_list[[6]][[3]])), which(colnames(VIC_clean_list[[6]]) == "um_u3_abd_add")],
               VIC_clean_list[[7]][which.max(abs(VIC_clean_list[[7]][[3]])), which(colnames(VIC_clean_list[[7]]) == "um_u3_abd_add")],
               VIC_clean_list[[8]][which.max(abs(VIC_clean_list[[8]][[3]])), which(colnames(VIC_clean_list[[8]]) == "um_u3_abd_add")],
              NA,
              NA),
  
  wd_u4_y = c(VIC_clean_list[[5]][which.max(abs(VIC_clean_list[[5]][[3]])), which(colnames(VIC_clean_list[[5]]) == "um_u4_abd_add")],
               VIC_clean_list[[6]][which.max(abs(VIC_clean_list[[6]][[3]])), which(colnames(VIC_clean_list[[6]]) == "um_u4_abd_add")],
               VIC_clean_list[[7]][which.max(abs(VIC_clean_list[[7]][[3]])), which(colnames(VIC_clean_list[[7]]) == "um_u4_abd_add")],
               VIC_clean_list[[8]][which.max(abs(VIC_clean_list[[8]][[3]])), which(colnames(VIC_clean_list[[8]]) == "um_u4_abd_add")],
              NA,
              NA),
  
  wd_u5_y = c(VIC_clean_list[[5]][which.max(abs(VIC_clean_list[[5]][[3]])), which(colnames(VIC_clean_list[[5]]) == "um_u5_abd_add")],
               VIC_clean_list[[6]][which.max(abs(VIC_clean_list[[6]][[3]])), which(colnames(VIC_clean_list[[6]]) == "um_u5_abd_add")],
               VIC_clean_list[[7]][which.max(abs(VIC_clean_list[[7]][[3]])), which(colnames(VIC_clean_list[[7]]) == "um_u5_abd_add")],
               VIC_clean_list[[8]][which.max(abs(VIC_clean_list[[8]][[3]])), which(colnames(VIC_clean_list[[8]]) == "um_u5_abd_add")],
              NA,
              NA),
  
  wd_u1_z = c(VIC_clean_list[[5]][which.max(abs(VIC_clean_list[[5]][[4]])), which(colnames(VIC_clean_list[[5]]) == "um_u1_pro_re")],
               VIC_clean_list[[6]][which.max(abs(VIC_clean_list[[6]][[4]])), which(colnames(VIC_clean_list[[6]]) == "um_u1_pro_re")],
               VIC_clean_list[[7]][which.max(abs(VIC_clean_list[[7]][[4]])), which(colnames(VIC_clean_list[[7]]) == "um_u1_pro_re")],
               VIC_clean_list[[8]][which.max(abs(VIC_clean_list[[8]][[4]])), which(colnames(VIC_clean_list[[8]]) == "um_u1_pro_re")],
               VIC_clean_list[[15]][which.max(abs(VIC_clean_list[[15]][[4]])), which(colnames(VIC_clean_list[[15]]) == "um_u1_pro_re")],
               VIC_clean_list[[16]][which.max(abs(VIC_clean_list[[16]][[4]])), which(colnames(VIC_clean_list[[16]]) == "um_u1_pro_re")]),
  
  wd_u2_z = c(VIC_clean_list[[5]][which.max(abs(VIC_clean_list[[5]][[4]])), which(colnames(VIC_clean_list[[5]]) == "um_u2_pro_re")],
              VIC_clean_list[[6]][which.max(abs(VIC_clean_list[[6]][[4]])), which(colnames(VIC_clean_list[[6]]) == "um_u2_pro_re")],
              VIC_clean_list[[7]][which.max(abs(VIC_clean_list[[7]][[4]])), which(colnames(VIC_clean_list[[7]]) == "um_u2_pro_re")],
              VIC_clean_list[[8]][which.max(abs(VIC_clean_list[[8]][[4]])), which(colnames(VIC_clean_list[[8]]) == "um_u2_pro_re")],
              NA,
              NA),
  
  wd_u3_z = c(VIC_clean_list[[5]][which.max(abs(VIC_clean_list[[5]][[4]])), which(colnames(VIC_clean_list[[5]]) == "um_u3_pro_re")],
              VIC_clean_list[[6]][which.max(abs(VIC_clean_list[[6]][[4]])), which(colnames(VIC_clean_list[[6]]) == "um_u3_pro_re")],
              VIC_clean_list[[7]][which.max(abs(VIC_clean_list[[7]][[4]])), which(colnames(VIC_clean_list[[7]]) == "um_u3_pro_re")],
              VIC_clean_list[[8]][which.max(abs(VIC_clean_list[[8]][[4]])), which(colnames(VIC_clean_list[[8]]) == "um_u3_pro_re")],
              NA,
              NA),
  
  wd_u4_z = c(VIC_clean_list[[5]][which.max(abs(VIC_clean_list[[5]][[4]])), which(colnames(VIC_clean_list[[5]]) == "um_u4_pro_re")],
              VIC_clean_list[[6]][which.max(abs(VIC_clean_list[[6]][[4]])), which(colnames(VIC_clean_list[[6]]) == "um_u4_pro_re")],
              VIC_clean_list[[7]][which.max(abs(VIC_clean_list[[7]][[4]])), which(colnames(VIC_clean_list[[7]]) == "um_u4_pro_re")],
              VIC_clean_list[[8]][which.max(abs(VIC_clean_list[[8]][[4]])), which(colnames(VIC_clean_list[[8]]) == "um_u4_pro_re")],
              NA,
              NA),
  
  wd_u5_z = c(VIC_clean_list[[5]][which.max(abs(VIC_clean_list[[5]][[4]])), which(colnames(VIC_clean_list[[5]]) == "um_u5_pro_re")],
              VIC_clean_list[[6]][which.max(abs(VIC_clean_list[[6]][[4]])), which(colnames(VIC_clean_list[[6]]) == "um_u5_pro_re")],
              VIC_clean_list[[7]][which.max(abs(VIC_clean_list[[7]][[4]])), which(colnames(VIC_clean_list[[7]]) == "um_u5_pro_re")],
              VIC_clean_list[[8]][which.max(abs(VIC_clean_list[[8]][[4]])), which(colnames(VIC_clean_list[[8]]) == "um_u5_pro_re")],
              NA,
              NA),
 
  wod_u1_x = c(VIC_clean_list[[9]][which.max(abs(VIC_clean_list[[9]][[2]])), which(colnames(VIC_clean_list[[9]]) == "um_u1_axial")],
               VIC_clean_list[[10]][which.max(abs(VIC_clean_list[[10]][[2]])), which(colnames(VIC_clean_list[[10]]) == "um_u1_axial")],
               VIC_clean_list[[11]][which.max(abs(VIC_clean_list[[11]][[2]])), which(colnames(VIC_clean_list[[11]]) == "um_u1_axial")],
               VIC_clean_list[[12]][which.max(abs(VIC_clean_list[[12]][[2]])), which(colnames(VIC_clean_list[[12]]) == "um_u1_axial")],
               VIC_clean_list[[17]][which.max(abs(VIC_clean_list[[17]][[2]])), which(colnames(VIC_clean_list[[17]]) == "um_u1_axial")],
               VIC_clean_list[[18]][which.max(abs(VIC_clean_list[[18]][[2]])), which(colnames(VIC_clean_list[[18]]) == "um_u1_axial")]),
  
  wod_u2_x = c(VIC_clean_list[[9]][which.max(abs(VIC_clean_list[[9]][[2]])), which(colnames(VIC_clean_list[[9]]) == "um_u2_axial")],
               VIC_clean_list[[10]][which.max(abs(VIC_clean_list[[10]][[2]])), which(colnames(VIC_clean_list[[10]]) == "um_u2_axial")],
               VIC_clean_list[[11]][which.max(abs(VIC_clean_list[[11]][[2]])), which(colnames(VIC_clean_list[[11]]) == "um_u2_axial")],
               VIC_clean_list[[12]][which.max(abs(VIC_clean_list[[12]][[2]])), which(colnames(VIC_clean_list[[12]]) == "um_u2_axial")],
               NA,
               NA),
  
  wod_u3_x = c(VIC_clean_list[[9]][which.max(abs(VIC_clean_list[[9]][[2]])), which(colnames(VIC_clean_list[[9]]) == "um_u3_axial")],
               VIC_clean_list[[10]][which.max(abs(VIC_clean_list[[10]][[2]])), which(colnames(VIC_clean_list[[10]]) == "um_u3_axial")],
               VIC_clean_list[[11]][which.max(abs(VIC_clean_list[[11]][[2]])), which(colnames(VIC_clean_list[[11]]) == "um_u3_axial")],
               VIC_clean_list[[12]][which.max(abs(VIC_clean_list[[12]][[2]])), which(colnames(VIC_clean_list[[12]]) == "um_u3_axial")],
               NA,
               NA),
  
  wod_u4_x = c(VIC_clean_list[[9]][which.max(abs(VIC_clean_list[[9]][[2]])), which(colnames(VIC_clean_list[[9]]) == "um_u4_axial")],
               VIC_clean_list[[10]][which.max(abs(VIC_clean_list[[10]][[2]])), which(colnames(VIC_clean_list[[10]]) == "um_u4_axial")],
               VIC_clean_list[[11]][which.max(abs(VIC_clean_list[[11]][[2]])), which(colnames(VIC_clean_list[[11]]) == "um_u4_axial")],
               VIC_clean_list[[12]][which.max(abs(VIC_clean_list[[12]][[2]])), which(colnames(VIC_clean_list[[12]]) == "um_u4_axial")],
               NA,
               NA),
  
  wod_u5_x = c(VIC_clean_list[[9]][which.max(abs(VIC_clean_list[[9]][[2]])), which(colnames(VIC_clean_list[[9]]) == "um_u5_axial")],
               VIC_clean_list[[10]][which.max(abs(VIC_clean_list[[10]][[2]])), which(colnames(VIC_clean_list[[10]]) == "um_u5_axial")],
               VIC_clean_list[[11]][which.max(abs(VIC_clean_list[[11]][[2]])), which(colnames(VIC_clean_list[[11]]) == "um_u5_axial")],
               VIC_clean_list[[12]][which.max(abs(VIC_clean_list[[12]][[2]])), which(colnames(VIC_clean_list[[12]]) == "um_u5_axial")],
               NA,
               NA),
  
  wod_u1_y = c(VIC_clean_list[[9]][which.max(abs(VIC_clean_list[[9]][[3]])), which(colnames(VIC_clean_list[[9]]) == "um_u1_abd_add")],
               VIC_clean_list[[10]][which.max(abs(VIC_clean_list[[10]][[3]])), which(colnames(VIC_clean_list[[10]]) == "um_u1_abd_add")],
               VIC_clean_list[[11]][which.max(abs(VIC_clean_list[[11]][[3]])), which(colnames(VIC_clean_list[[11]]) == "um_u1_abd_add")],
               VIC_clean_list[[12]][which.max(abs(VIC_clean_list[[12]][[3]])), which(colnames(VIC_clean_list[[12]]) == "um_u1_abd_add")],
               VIC_clean_list[[17]][which.max(abs(VIC_clean_list[[17]][[3]])), which(colnames(VIC_clean_list[[17]]) == "um_u1_abd_add")],
               VIC_clean_list[[18]][which.max(abs(VIC_clean_list[[18]][[3]])), which(colnames(VIC_clean_list[[18]]) == "um_u1_abd_add")]),
  
  wod_u2_y = c(VIC_clean_list[[9]][which.max(abs(VIC_clean_list[[9]][[3]])), which(colnames(VIC_clean_list[[9]]) == "um_u2_abd_add")],
               VIC_clean_list[[10]][which.max(abs(VIC_clean_list[[10]][[3]])), which(colnames(VIC_clean_list[[10]]) == "um_u2_abd_add")],
               VIC_clean_list[[11]][which.max(abs(VIC_clean_list[[11]][[3]])), which(colnames(VIC_clean_list[[11]]) == "um_u2_abd_add")],
               VIC_clean_list[[12]][which.max(abs(VIC_clean_list[[12]][[3]])), which(colnames(VIC_clean_list[[12]]) == "um_u2_abd_add")],
               NA,
               NA),
  
  wod_u3_y = c(VIC_clean_list[[9]][which.max(abs(VIC_clean_list[[9]][[3]])), which(colnames(VIC_clean_list[[9]]) == "um_u3_abd_add")],
               VIC_clean_list[[10]][which.max(abs(VIC_clean_list[[10]][[3]])), which(colnames(VIC_clean_list[[10]]) == "um_u3_abd_add")],
               VIC_clean_list[[11]][which.max(abs(VIC_clean_list[[11]][[3]])), which(colnames(VIC_clean_list[[11]]) == "um_u3_abd_add")],
               VIC_clean_list[[12]][which.max(abs(VIC_clean_list[[12]][[3]])), which(colnames(VIC_clean_list[[12]]) == "um_u3_abd_add")],
               NA,
               NA),
  
  wod_u4_y = c(VIC_clean_list[[9]][which.max(abs(VIC_clean_list[[9]][[3]])), which(colnames(VIC_clean_list[[9]]) == "um_u4_abd_add")],
               VIC_clean_list[[10]][which.max(abs(VIC_clean_list[[10]][[3]])), which(colnames(VIC_clean_list[[10]]) == "um_u4_abd_add")],
               VIC_clean_list[[11]][which.max(abs(VIC_clean_list[[11]][[3]])), which(colnames(VIC_clean_list[[11]]) == "um_u4_abd_add")],
               VIC_clean_list[[12]][which.max(abs(VIC_clean_list[[12]][[3]])), which(colnames(VIC_clean_list[[12]]) == "um_u4_abd_add")],
               NA,
               NA),
  
  wod_u5_y = c(VIC_clean_list[[9]][which.max(abs(VIC_clean_list[[9]][[3]])), which(colnames(VIC_clean_list[[9]]) == "um_u5_abd_add")],
               VIC_clean_list[[10]][which.max(abs(VIC_clean_list[[10]][[3]])), which(colnames(VIC_clean_list[[10]]) == "um_u5_abd_add")],
               VIC_clean_list[[11]][which.max(abs(VIC_clean_list[[11]][[3]])), which(colnames(VIC_clean_list[[11]]) == "um_u5_abd_add")],
               VIC_clean_list[[12]][which.max(abs(VIC_clean_list[[12]][[3]])), which(colnames(VIC_clean_list[[12]]) == "um_u5_abd_add")],
               NA,
               NA),
  
  wod_u1_z = c(VIC_clean_list[[9]][which.max(abs(VIC_clean_list[[9]][[4]])), which(colnames(VIC_clean_list[[9]]) == "um_u1_pro_re")],
               VIC_clean_list[[10]][which.max(abs(VIC_clean_list[[10]][[4]])), which(colnames(VIC_clean_list[[10]]) == "um_u1_pro_re")],
               VIC_clean_list[[11]][which.max(abs(VIC_clean_list[[11]][[4]])), which(colnames(VIC_clean_list[[11]]) == "um_u1_pro_re")],
               VIC_clean_list[[12]][which.max(abs(VIC_clean_list[[12]][[4]])), which(colnames(VIC_clean_list[[12]]) == "um_u1_pro_re")],
               VIC_clean_list[[17]][which.max(abs(VIC_clean_list[[17]][[4]])), which(colnames(VIC_clean_list[[17]]) == "um_u1_pro_re")],
               VIC_clean_list[[18]][which.max(abs(VIC_clean_list[[18]][[4]])), which(colnames(VIC_clean_list[[18]]) == "um_u1_pro_re")]),
  
  wod_u2_z = c(VIC_clean_list[[9]][which.max(abs(VIC_clean_list[[9]][[4]])), which(colnames(VIC_clean_list[[9]]) == "um_u2_pro_re")],
               VIC_clean_list[[10]][which.max(abs(VIC_clean_list[[10]][[4]])), which(colnames(VIC_clean_list[[10]]) == "um_u2_pro_re")],
               VIC_clean_list[[11]][which.max(abs(VIC_clean_list[[11]][[4]])), which(colnames(VIC_clean_list[[11]]) == "um_u2_pro_re")],
               VIC_clean_list[[12]][which.max(abs(VIC_clean_list[[12]][[4]])), which(colnames(VIC_clean_list[[12]]) == "um_u2_pro_re")],
               NA,
               NA),
  
  wod_u3_z = c(VIC_clean_list[[9]][which.max(abs(VIC_clean_list[[9]][[4]])), which(colnames(VIC_clean_list[[9]]) == "um_u3_pro_re")],
               VIC_clean_list[[10]][which.max(abs(VIC_clean_list[[10]][[4]])), which(colnames(VIC_clean_list[[10]]) == "um_u3_pro_re")],
               VIC_clean_list[[11]][which.max(abs(VIC_clean_list[[11]][[4]])), which(colnames(VIC_clean_list[[11]]) == "um_u3_pro_re")],
               VIC_clean_list[[12]][which.max(abs(VIC_clean_list[[12]][[4]])), which(colnames(VIC_clean_list[[12]]) == "um_u3_pro_re")],
               NA,
               NA),
  
  wod_u4_z = c(VIC_clean_list[[9]][which.max(abs(VIC_clean_list[[9]][[4]])), which(colnames(VIC_clean_list[[9]]) == "um_u4_pro_re")],
               VIC_clean_list[[10]][which.max(abs(VIC_clean_list[[10]][[4]])), which(colnames(VIC_clean_list[[10]]) == "um_u4_pro_re")],
               VIC_clean_list[[11]][which.max(abs(VIC_clean_list[[11]][[4]])), which(colnames(VIC_clean_list[[11]]) == "um_u4_pro_re")],
               VIC_clean_list[[12]][which.max(abs(VIC_clean_list[[12]][[4]])), which(colnames(VIC_clean_list[[12]]) == "um_u4_pro_re")],
               NA,
               NA),
  
  wod_u5_z = c(VIC_clean_list[[9]][which.max(abs(VIC_clean_list[[9]][[4]])), which(colnames(VIC_clean_list[[9]]) == "um_u5_pro_re")],
               VIC_clean_list[[10]][which.max(abs(VIC_clean_list[[10]][[4]])), which(colnames(VIC_clean_list[[10]]) == "um_u5_pro_re")],
               VIC_clean_list[[11]][which.max(abs(VIC_clean_list[[11]][[4]])), which(colnames(VIC_clean_list[[11]]) == "um_u5_pro_re")],
               VIC_clean_list[[12]][which.max(abs(VIC_clean_list[[12]][[4]])), which(colnames(VIC_clean_list[[12]]) == "um_u5_pro_re")],
               NA,
               NA))


VIC_bar <- reshape2::melt(VIC_clean_data, id.var = "jnt")
VIC_bar <- VIC_bar %>%
  drop_na()
VIC_bar <- VIC_bar %>%
  mutate(oROM = ifelse(str_detect(VIC_bar[[2]], "max_"), "max",
                       ifelse(str_detect(VIC_bar[[2]], "wd_"), "wd", "wod"))) %>%
  mutate(xyz = if_else(str_detect(VIC_bar[[2]], "_x"), "axial_rotation", 
                       if_else(str_detect(VIC_bar[[2]], "_y"), "abduct_adduct",
                               "pro_retract"))) %>%
  mutate(unit = if_else(str_detect(VIC_bar[[2]], "_u1_"), "unit 1", 
                        if_else(str_detect(VIC_bar[[2]], "_u2_"), "unit 2",
                                if_else(str_detect(VIC_bar[[2]], "_u3_"), "unit 3",
                                        if_else(str_detect(VIC_bar[[2]], "_u4_"), "unit 4", "unit 5")))))


#LC
LC_data <- data.frame(
  jnt = c("C10", "C11", "C13", "C15"),
  max_u1_x = c(LC_list[[1]][which.max(abs(LC_list[[1]][[2]])), which(colnames(LC_list[[1]]) == "um_u1_axial")],
               LC_list[[2]][which.max(abs(LC_list[[2]][[2]])), which(colnames(LC_list[[2]]) == "um_u1_axial")],
               LC_list[[3]][which.max(abs(LC_list[[3]][[2]])), which(colnames(LC_list[[3]]) == "um_u1_axial")],
               LC_list[[4]][which.max(abs(LC_list[[4]][[2]])), which(colnames(LC_list[[4]]) == "um_u1_axial")]),
  
  max_u1_y = c(LC_list[[1]][which.max(abs(LC_list[[1]][[3]])), which(colnames(LC_list[[1]]) == "um_u1_abd_add")],
               LC_list[[2]][which.max(abs(LC_list[[2]][[3]])), which(colnames(LC_list[[2]]) == "um_u1_abd_add")],
               LC_list[[3]][which.max(abs(LC_list[[3]][[3]])), which(colnames(LC_list[[3]]) == "um_u1_abd_add")],
               LC_list[[4]][which.max(abs(LC_list[[4]][[3]])), which(colnames(LC_list[[4]]) == "um_u1_abd_add")]),
  
  max_u1_z = c(LC_list[[1]][which.max(abs(LC_list[[1]][[4]])), which(colnames(LC_list[[1]]) == "um_u1_pro_re")],
               LC_list[[2]][which.max(abs(LC_list[[2]][[4]])), which(colnames(LC_list[[2]]) == "um_u1_pro_re")],
               LC_list[[3]][which.max(abs(LC_list[[3]][[4]])), which(colnames(LC_list[[3]]) == "um_u1_pro_re")],
               LC_list[[4]][which.max(abs(LC_list[[4]][[4]])), which(colnames(LC_list[[4]]) == "um_u1_pro_re")]),
  
  wd_u1_x = c(LC_list[[5]][which.max(abs(LC_list[[5]][[2]])), which(colnames(LC_list[[5]]) == "um_u1_axial")],
              LC_list[[6]][which.max(abs(LC_list[[6]][[2]])), which(colnames(LC_list[[6]]) == "um_u1_axial")],
              LC_list[[7]][which.max(abs(LC_list[[7]][[2]])), which(colnames(LC_list[[7]]) == "um_u1_axial")],
              LC_list[[8]][which.max(abs(LC_list[[8]][[2]])), which(colnames(LC_list[[8]]) == "um_u1_axial")]),
  
  wd_u1_y = c(LC_list[[5]][which.max(abs(LC_list[[5]][[3]])), which(colnames(LC_list[[5]]) == "um_u1_abd_add")],
              LC_list[[6]][which.max(abs(LC_list[[6]][[3]])), which(colnames(LC_list[[6]]) == "um_u1_abd_add")],
              LC_list[[7]][which.max(abs(LC_list[[7]][[3]])), which(colnames(LC_list[[7]]) == "um_u1_abd_add")],
              LC_list[[8]][which.max(abs(LC_list[[8]][[3]])), which(colnames(LC_list[[8]]) == "um_u1_abd_add")]),
  
  wd_u1_z = c(LC_list[[5]][which.max(abs(LC_list[[5]][[4]])), which(colnames(LC_list[[5]]) == "um_u1_pro_re")],
              LC_list[[6]][which.max(abs(LC_list[[6]][[4]])), which(colnames(LC_list[[6]]) == "um_u1_pro_re")],
              LC_list[[7]][which.max(abs(LC_list[[7]][[4]])), which(colnames(LC_list[[7]]) == "um_u1_pro_re")],
              LC_list[[8]][which.max(abs(LC_list[[8]][[4]])), which(colnames(LC_list[[8]]) == "um_u1_pro_re")]),
  
  wod_u1_x = c(LC_list[[9]][which.max(abs(LC_list[[9]][[2]])), which(colnames(LC_list[[9]]) == "um_u1_axial")],
               LC_list[[10]][which.max(abs(LC_list[[10]][[2]])), which(colnames(LC_list[[10]]) == "um_u1_axial")],
               LC_list[[11]][which.max(abs(LC_list[[11]][[2]])), which(colnames(LC_list[[11]]) == "um_u1_axial")],
               LC_list[[12]][which.max(abs(LC_list[[12]][[2]])), which(colnames(LC_list[[12]]) == "um_u1_axial")]),
  
  wod_u1_y = c(LC_list[[9]][which.max(abs(LC_list[[9]][[3]])), which(colnames(LC_list[[9]]) == "um_u1_abd_add")],
               LC_list[[10]][which.max(abs(LC_list[[10]][[3]])), which(colnames(LC_list[[10]]) == "um_u1_abd_add")],
               LC_list[[11]][which.max(abs(LC_list[[11]][[3]])), which(colnames(LC_list[[11]]) == "um_u1_abd_add")],
               LC_list[[12]][which.max(abs(LC_list[[12]][[3]])), which(colnames(LC_list[[12]]) == "um_u1_abd_add")]),
  
  wod_u1_z = c(LC_list[[9]][which.max(abs(LC_list[[9]][[4]])), which(colnames(LC_list[[9]]) == "um_u1_pro_re")],
               LC_list[[10]][which.max(abs(LC_list[[10]][[4]])), which(colnames(LC_list[[10]]) == "um_u1_pro_re")],
               LC_list[[11]][which.max(abs(LC_list[[11]][[4]])), which(colnames(LC_list[[11]]) == "um_u1_pro_re")],
               LC_list[[12]][which.max(abs(LC_list[[12]][[4]])), which(colnames(LC_list[[12]]) == "um_u1_pro_re")]))

LC_bar <- reshape2::melt(LC_data, id.var = "jnt")
LC_bar <- LC_bar %>%
  mutate(oROM = ifelse(str_detect(LC_bar[[2]], "max_"), "max",
                       ifelse(str_detect(LC_bar[[2]], "wd_"), "wd", "wod"))) %>%
  mutate(xyz = if_else(str_detect(LC_bar[[2]], "_x"), "axial_rotation", 
                       if_else(str_detect(LC_bar[[2]], "_y"), "abduct_adduct",
                               "pro_retract"))) %>%
  mutate(unit = "unit 1")

#IE
IE_clean_list <- IE_list[-c(1:3)]
IE_clean_data <- data.frame(
  jnt = c("C10", "C11", "C13", "C15", "PC11", "PC13", "PC15"),
  max_u1_x = c(IE_clean_list[[1]][which.max(abs(IE_clean_list[[1]][[2]])), which(colnames(IE_clean_list[[1]]) == "um_u1_axial")],
               IE_clean_list[[2]][which.max(abs(IE_clean_list[[2]][[2]])), which(colnames(IE_clean_list[[2]]) == "um_u1_axial")],
               IE_clean_list[[3]][which.max(abs(IE_clean_list[[3]][[2]])), which(colnames(IE_clean_list[[3]]) == "um_u1_axial")],
               IE_clean_list[[4]][which.max(abs(IE_clean_list[[4]][[2]])), which(colnames(IE_clean_list[[4]]) == "um_u1_axial")],
               IE_clean_list[[13]][which.max(abs(IE_clean_list[[13]][[2]])), which(colnames(IE_clean_list[[13]]) == "um_u1_axial")],
               IE_clean_list[[14]][which.max(abs(IE_clean_list[[14]][[2]])), which(colnames(IE_clean_list[[14]]) == "um_u1_axial")],
               IE_clean_list[[15]][which.max(abs(IE_clean_list[[15]][[2]])), which(colnames(IE_clean_list[[15]]) == "um_u1_axial")]),
  
  max_u2_x = c(IE_clean_list[[1]][which.max(abs(IE_clean_list[[1]][[2]])), which(colnames(IE_clean_list[[1]]) == "um_u2_axial")],
               IE_clean_list[[2]][which.max(abs(IE_clean_list[[2]][[2]])), which(colnames(IE_clean_list[[2]]) == "um_u2_axial")],
               IE_clean_list[[3]][which.max(abs(IE_clean_list[[3]][[2]])), which(colnames(IE_clean_list[[3]]) == "um_u2_axial")],
               IE_clean_list[[4]][which.max(abs(IE_clean_list[[4]][[2]])), which(colnames(IE_clean_list[[4]]) == "um_u2_axial")],
               NA,
               NA,
               NA),
  
  max_u3_x = c(IE_clean_list[[1]][which.max(abs(IE_clean_list[[1]][[2]])), which(colnames(IE_clean_list[[1]]) == "um_u3_axial")],
               IE_clean_list[[2]][which.max(abs(IE_clean_list[[2]][[2]])), which(colnames(IE_clean_list[[2]]) == "um_u3_axial")],
               IE_clean_list[[3]][which.max(abs(IE_clean_list[[3]][[2]])), which(colnames(IE_clean_list[[3]]) == "um_u3_axial")],
               IE_clean_list[[4]][which.max(abs(IE_clean_list[[4]][[2]])), which(colnames(IE_clean_list[[4]]) == "um_u3_axial")],
               NA,
               NA,
               NA),
  
  max_u4_x = c(IE_clean_list[[1]][which.max(abs(IE_clean_list[[1]][[2]])), which(colnames(IE_clean_list[[1]]) == "um_u4_axial")],
               IE_clean_list[[2]][which.max(abs(IE_clean_list[[2]][[2]])), which(colnames(IE_clean_list[[2]]) == "um_u4_axial")],
               IE_clean_list[[3]][which.max(abs(IE_clean_list[[3]][[2]])), which(colnames(IE_clean_list[[3]]) == "um_u4_axial")],
               IE_clean_list[[4]][which.max(abs(IE_clean_list[[4]][[2]])), which(colnames(IE_clean_list[[4]]) == "um_u4_axial")],
               NA,
               NA,
               NA),
  
  max_u1_y = c(IE_clean_list[[1]][which.max(abs(IE_clean_list[[1]][[3]])), which(colnames(IE_clean_list[[1]]) == "um_u1_abd_add")],
               IE_clean_list[[2]][which.max(abs(IE_clean_list[[2]][[3]])), which(colnames(IE_clean_list[[2]]) == "um_u1_abd_add")],
               IE_clean_list[[3]][which.max(abs(IE_clean_list[[3]][[3]])), which(colnames(IE_clean_list[[3]]) == "um_u1_abd_add")],
               IE_clean_list[[4]][which.max(abs(IE_clean_list[[4]][[3]])), which(colnames(IE_clean_list[[4]]) == "um_u1_abd_add")],
               IE_clean_list[[13]][which.max(abs(IE_clean_list[[13]][[3]])), which(colnames(IE_clean_list[[13]]) == "um_u1_abd_add")],
               IE_clean_list[[14]][which.max(abs(IE_clean_list[[14]][[3]])), which(colnames(IE_clean_list[[14]]) == "um_u1_abd_add")],
               IE_clean_list[[15]][which.max(abs(IE_clean_list[[15]][[3]])), which(colnames(IE_clean_list[[15]]) == "um_u1_abd_add")]),
  
  max_u2_y = c(IE_clean_list[[1]][which.max(abs(IE_clean_list[[1]][[3]])), which(colnames(IE_clean_list[[1]]) == "um_u2_abd_add")],
               IE_clean_list[[2]][which.max(abs(IE_clean_list[[2]][[3]])), which(colnames(IE_clean_list[[2]]) == "um_u2_abd_add")],
               IE_clean_list[[3]][which.max(abs(IE_clean_list[[3]][[3]])), which(colnames(IE_clean_list[[3]]) == "um_u2_abd_add")],
               IE_clean_list[[4]][which.max(abs(IE_clean_list[[4]][[3]])), which(colnames(IE_clean_list[[4]]) == "um_u2_abd_add")],
               NA,
               NA,
               NA),
  
  max_u3_y = c(IE_clean_list[[1]][which.max(abs(IE_clean_list[[1]][[3]])), which(colnames(IE_clean_list[[1]]) == "um_u3_abd_add")],
               IE_clean_list[[2]][which.max(abs(IE_clean_list[[2]][[3]])), which(colnames(IE_clean_list[[2]]) == "um_u3_abd_add")],
               IE_clean_list[[3]][which.max(abs(IE_clean_list[[3]][[3]])), which(colnames(IE_clean_list[[3]]) == "um_u3_abd_add")],
               IE_clean_list[[4]][which.max(abs(IE_clean_list[[4]][[3]])), which(colnames(IE_clean_list[[4]]) == "um_u3_abd_add")],
               NA,
               NA,
               NA),
  
  max_u4_y = c(IE_clean_list[[1]][which.max(abs(IE_clean_list[[1]][[3]])), which(colnames(IE_clean_list[[1]]) == "um_u4_abd_add")],
               IE_clean_list[[2]][which.max(abs(IE_clean_list[[2]][[3]])), which(colnames(IE_clean_list[[2]]) == "um_u4_abd_add")],
               IE_clean_list[[3]][which.max(abs(IE_clean_list[[3]][[3]])), which(colnames(IE_clean_list[[3]]) == "um_u4_abd_add")],
               IE_clean_list[[4]][which.max(abs(IE_clean_list[[4]][[3]])), which(colnames(IE_clean_list[[4]]) == "um_u4_abd_add")],
               NA,
               NA,
               NA),
 
  max_u1_z = c(IE_clean_list[[1]][which.max(abs(IE_clean_list[[1]][[4]])), which(colnames(IE_clean_list[[1]]) == "um_u1_pro_re")],
               IE_clean_list[[2]][which.max(abs(IE_clean_list[[2]][[4]])), which(colnames(IE_clean_list[[2]]) == "um_u1_pro_re")],
               IE_clean_list[[3]][which.max(abs(IE_clean_list[[3]][[4]])), which(colnames(IE_clean_list[[3]]) == "um_u1_pro_re")],
               IE_clean_list[[4]][which.max(abs(IE_clean_list[[4]][[4]])), which(colnames(IE_clean_list[[4]]) == "um_u1_pro_re")],
               IE_clean_list[[13]][which.max(abs(IE_clean_list[[13]][[4]])), which(colnames(IE_clean_list[[13]]) == "um_u1_pro_re")],
               IE_clean_list[[14]][which.max(abs(IE_clean_list[[14]][[4]])), which(colnames(IE_clean_list[[14]]) == "um_u1_pro_re")],
               IE_clean_list[[15]][which.max(abs(IE_clean_list[[15]][[4]])), which(colnames(IE_clean_list[[15]]) == "um_u1_pro_re")]),
  
  max_u2_z = c(IE_clean_list[[1]][which.max(abs(IE_clean_list[[1]][[4]])), which(colnames(IE_clean_list[[1]]) == "um_u2_pro_re")],
               IE_clean_list[[2]][which.max(abs(IE_clean_list[[2]][[4]])), which(colnames(IE_clean_list[[2]]) == "um_u2_pro_re")],
               IE_clean_list[[3]][which.max(abs(IE_clean_list[[3]][[4]])), which(colnames(IE_clean_list[[3]]) == "um_u2_pro_re")],
               IE_clean_list[[4]][which.max(abs(IE_clean_list[[4]][[4]])), which(colnames(IE_clean_list[[4]]) == "um_u2_pro_re")],
               NA,
               NA,
               NA),
  
  max_u3_z = c(IE_clean_list[[1]][which.max(abs(IE_clean_list[[1]][[4]])), which(colnames(IE_clean_list[[1]]) == "um_u3_pro_re")],
               IE_clean_list[[2]][which.max(abs(IE_clean_list[[2]][[4]])), which(colnames(IE_clean_list[[2]]) == "um_u3_pro_re")],
               IE_clean_list[[3]][which.max(abs(IE_clean_list[[3]][[4]])), which(colnames(IE_clean_list[[3]]) == "um_u3_pro_re")],
               IE_clean_list[[4]][which.max(abs(IE_clean_list[[4]][[4]])), which(colnames(IE_clean_list[[4]]) == "um_u3_pro_re")],
               NA,
               NA,
               NA),
  
  max_u4_z = c(IE_clean_list[[1]][which.max(abs(IE_clean_list[[1]][[4]])), which(colnames(IE_clean_list[[1]]) == "um_u4_pro_re")],
               IE_clean_list[[2]][which.max(abs(IE_clean_list[[2]][[4]])), which(colnames(IE_clean_list[[2]]) == "um_u4_pro_re")],
               IE_clean_list[[3]][which.max(abs(IE_clean_list[[3]][[4]])), which(colnames(IE_clean_list[[3]]) == "um_u4_pro_re")],
               IE_clean_list[[4]][which.max(abs(IE_clean_list[[4]][[4]])), which(colnames(IE_clean_list[[4]]) == "um_u4_pro_re")],
               NA,
               NA,
               NA),
  
  wd_u1_x = c(IE_clean_list[[5]][which.max(abs(IE_clean_list[[5]][[2]])), which(colnames(IE_clean_list[[5]]) == "um_u1_axial")],
              IE_clean_list[[6]][which.max(abs(IE_clean_list[[6]][[2]])), which(colnames(IE_clean_list[[6]]) == "um_u1_axial")],
              IE_clean_list[[7]][which.max(abs(IE_clean_list[[7]][[2]])), which(colnames(IE_clean_list[[7]]) == "um_u1_axial")],
              IE_clean_list[[8]][which.max(abs(IE_clean_list[[8]][[2]])), which(colnames(IE_clean_list[[8]]) == "um_u1_axial")],
              IE_clean_list[[16]][which.max(abs(IE_clean_list[[16]][[2]])), which(colnames(IE_clean_list[[16]]) == "um_u1_axial")],
              IE_clean_list[[17]][which.max(abs(IE_clean_list[[17]][[2]])), which(colnames(IE_clean_list[[17]]) == "um_u1_axial")],
              IE_clean_list[[18]][which.max(abs(IE_clean_list[[18]][[2]])), which(colnames(IE_clean_list[[18]]) == "um_u1_axial")]),
  
  wd_u2_x = c(IE_clean_list[[5]][which.max(abs(IE_clean_list[[5]][[2]])), which(colnames(IE_clean_list[[5]]) == "um_u2_axial")],
              IE_clean_list[[6]][which.max(abs(IE_clean_list[[6]][[2]])), which(colnames(IE_clean_list[[6]]) == "um_u2_axial")],
              IE_clean_list[[7]][which.max(abs(IE_clean_list[[7]][[2]])), which(colnames(IE_clean_list[[7]]) == "um_u2_axial")],
              IE_clean_list[[8]][which.max(abs(IE_clean_list[[8]][[2]])), which(colnames(IE_clean_list[[8]]) == "um_u2_axial")],
              NA,
              NA,
              NA),
  
  wd_u3_x = c(IE_clean_list[[5]][which.max(abs(IE_clean_list[[5]][[2]])), which(colnames(IE_clean_list[[5]]) == "um_u3_axial")],
              IE_clean_list[[6]][which.max(abs(IE_clean_list[[6]][[2]])), which(colnames(IE_clean_list[[6]]) == "um_u3_axial")],
              IE_clean_list[[7]][which.max(abs(IE_clean_list[[7]][[2]])), which(colnames(IE_clean_list[[7]]) == "um_u3_axial")],
              IE_clean_list[[8]][which.max(abs(IE_clean_list[[8]][[2]])), which(colnames(IE_clean_list[[8]]) == "um_u3_axial")],
              NA,
              NA,
              NA),
  
  wd_u4_x = c(IE_clean_list[[5]][which.max(abs(IE_clean_list[[5]][[2]])), which(colnames(IE_clean_list[[5]]) == "um_u4_axial")],
              IE_clean_list[[6]][which.max(abs(IE_clean_list[[6]][[2]])), which(colnames(IE_clean_list[[6]]) == "um_u4_axial")],
              IE_clean_list[[7]][which.max(abs(IE_clean_list[[7]][[2]])), which(colnames(IE_clean_list[[7]]) == "um_u4_axial")],
              IE_clean_list[[8]][which.max(abs(IE_clean_list[[8]][[2]])), which(colnames(IE_clean_list[[8]]) == "um_u4_axial")],
              NA,
              NA,
              NA),

  wd_u1_y = c(IE_clean_list[[5]][which.max(abs(IE_clean_list[[5]][[3]])), which(colnames(IE_clean_list[[5]]) == "um_u1_abd_add")],
              IE_clean_list[[6]][which.max(abs(IE_clean_list[[6]][[3]])), which(colnames(IE_clean_list[[6]]) == "um_u1_abd_add")],
              IE_clean_list[[7]][which.max(abs(IE_clean_list[[7]][[3]])), which(colnames(IE_clean_list[[7]]) == "um_u1_abd_add")],
              IE_clean_list[[8]][which.max(abs(IE_clean_list[[8]][[3]])), which(colnames(IE_clean_list[[8]]) == "um_u1_abd_add")],
              IE_clean_list[[16]][which.max(abs(IE_clean_list[[16]][[3]])), which(colnames(IE_clean_list[[16]]) == "um_u1_abd_add")],
              IE_clean_list[[17]][which.max(abs(IE_clean_list[[17]][[3]])), which(colnames(IE_clean_list[[17]]) == "um_u1_abd_add")],
              IE_clean_list[[18]][which.max(abs(IE_clean_list[[18]][[3]])), which(colnames(IE_clean_list[[18]]) == "um_u1_abd_add")]),
  
  wd_u2_y = c(IE_clean_list[[5]][which.max(abs(IE_clean_list[[5]][[3]])), which(colnames(IE_clean_list[[5]]) == "um_u2_abd_add")],
              IE_clean_list[[6]][which.max(abs(IE_clean_list[[6]][[3]])), which(colnames(IE_clean_list[[6]]) == "um_u2_abd_add")],
              IE_clean_list[[7]][which.max(abs(IE_clean_list[[7]][[3]])), which(colnames(IE_clean_list[[7]]) == "um_u2_abd_add")],
              IE_clean_list[[8]][which.max(abs(IE_clean_list[[8]][[3]])), which(colnames(IE_clean_list[[8]]) == "um_u2_abd_add")],
              NA,
              NA,
              NA),
  
  wd_u3_y = c(IE_clean_list[[5]][which.max(abs(IE_clean_list[[5]][[3]])), which(colnames(IE_clean_list[[5]]) == "um_u3_abd_add")],
              IE_clean_list[[6]][which.max(abs(IE_clean_list[[6]][[3]])), which(colnames(IE_clean_list[[6]]) == "um_u3_abd_add")],
              IE_clean_list[[7]][which.max(abs(IE_clean_list[[7]][[3]])), which(colnames(IE_clean_list[[7]]) == "um_u3_abd_add")],
              IE_clean_list[[8]][which.max(abs(IE_clean_list[[8]][[3]])), which(colnames(IE_clean_list[[8]]) == "um_u3_abd_add")],
              NA,
              NA,
              NA),
  
  wd_u4_y = c(IE_clean_list[[5]][which.max(abs(IE_clean_list[[5]][[3]])), which(colnames(IE_clean_list[[5]]) == "um_u4_abd_add")],
              IE_clean_list[[6]][which.max(abs(IE_clean_list[[6]][[3]])), which(colnames(IE_clean_list[[6]]) == "um_u4_abd_add")],
              IE_clean_list[[7]][which.max(abs(IE_clean_list[[7]][[3]])), which(colnames(IE_clean_list[[7]]) == "um_u4_abd_add")],
              IE_clean_list[[8]][which.max(abs(IE_clean_list[[8]][[3]])), which(colnames(IE_clean_list[[8]]) == "um_u4_abd_add")],
              NA,
              NA,
              NA),
  
  wd_u1_z = c(IE_clean_list[[5]][which.max(abs(IE_clean_list[[5]][[4]])), which(colnames(IE_clean_list[[5]]) == "um_u1_pro_re")],
              IE_clean_list[[6]][which.max(abs(IE_clean_list[[6]][[4]])), which(colnames(IE_clean_list[[6]]) == "um_u1_pro_re")],
              IE_clean_list[[7]][which.max(abs(IE_clean_list[[7]][[4]])), which(colnames(IE_clean_list[[7]]) == "um_u1_pro_re")],
              IE_clean_list[[8]][which.max(abs(IE_clean_list[[8]][[4]])), which(colnames(IE_clean_list[[8]]) == "um_u1_pro_re")],
              IE_clean_list[[16]][which.max(abs(IE_clean_list[[16]][[4]])), which(colnames(IE_clean_list[[16]]) == "um_u1_pro_re")],
              IE_clean_list[[17]][which.max(abs(IE_clean_list[[17]][[4]])), which(colnames(IE_clean_list[[17]]) == "um_u1_pro_re")],
              IE_clean_list[[18]][which.max(abs(IE_clean_list[[18]][[4]])), which(colnames(IE_clean_list[[18]]) == "um_u1_pro_re")]),
  
  wd_u2_z = c(IE_clean_list[[5]][which.max(abs(IE_clean_list[[5]][[4]])), which(colnames(IE_clean_list[[5]]) == "um_u2_pro_re")],
              IE_clean_list[[6]][which.max(abs(IE_clean_list[[6]][[4]])), which(colnames(IE_clean_list[[6]]) == "um_u2_pro_re")],
              IE_clean_list[[7]][which.max(abs(IE_clean_list[[7]][[4]])), which(colnames(IE_clean_list[[7]]) == "um_u2_pro_re")],
              IE_clean_list[[8]][which.max(abs(IE_clean_list[[8]][[4]])), which(colnames(IE_clean_list[[8]]) == "um_u2_pro_re")],
              NA,
              NA,
              NA),
  
  wd_u3_z = c(IE_clean_list[[5]][which.max(abs(IE_clean_list[[5]][[4]])), which(colnames(IE_clean_list[[5]]) == "um_u3_pro_re")],
              IE_clean_list[[6]][which.max(abs(IE_clean_list[[6]][[4]])), which(colnames(IE_clean_list[[6]]) == "um_u3_pro_re")],
              IE_clean_list[[7]][which.max(abs(IE_clean_list[[7]][[4]])), which(colnames(IE_clean_list[[7]]) == "um_u3_pro_re")],
              IE_clean_list[[8]][which.max(abs(IE_clean_list[[8]][[4]])), which(colnames(IE_clean_list[[8]]) == "um_u3_pro_re")],
              NA,
              NA,
              NA),
  
  wd_u4_z = c(IE_clean_list[[5]][which.max(abs(IE_clean_list[[5]][[4]])), which(colnames(IE_clean_list[[5]]) == "um_u4_pro_re")],
              IE_clean_list[[6]][which.max(abs(IE_clean_list[[6]][[4]])), which(colnames(IE_clean_list[[6]]) == "um_u4_pro_re")],
              IE_clean_list[[7]][which.max(abs(IE_clean_list[[7]][[4]])), which(colnames(IE_clean_list[[7]]) == "um_u4_pro_re")],
              IE_clean_list[[8]][which.max(abs(IE_clean_list[[8]][[4]])), which(colnames(IE_clean_list[[8]]) == "um_u4_pro_re")],
              NA,
              NA,
              NA),
  
  wod_u1_x = c(IE_clean_list[[9]][which.max(abs(IE_clean_list[[9]][[2]])), which(colnames(IE_clean_list[[9]]) == "um_u1_axial")],
               IE_clean_list[[10]][which.max(abs(IE_clean_list[[10]][[2]])), which(colnames(IE_clean_list[[10]]) == "um_u1_axial")],
               IE_clean_list[[11]][which.max(abs(IE_clean_list[[11]][[2]])), which(colnames(IE_clean_list[[11]]) == "um_u1_axial")],
               IE_clean_list[[12]][which.max(abs(IE_clean_list[[12]][[2]])), which(colnames(IE_clean_list[[12]]) == "um_u1_axial")],
               IE_clean_list[[19]][which.max(abs(IE_clean_list[[19]][[2]])), which(colnames(IE_clean_list[[19]]) == "um_u1_axial")],
               IE_clean_list[[20]][which.max(abs(IE_clean_list[[20]][[2]])), which(colnames(IE_clean_list[[20]]) == "um_u1_axial")],
               IE_clean_list[[21]][which.max(abs(IE_clean_list[[21]][[2]])), which(colnames(IE_clean_list[[21]]) == "um_u1_axial")]),
  
  wod_u2_x = c(IE_clean_list[[9]][which.max(abs(IE_clean_list[[9]][[2]])), which(colnames(IE_clean_list[[9]]) == "um_u2_axial")],
               IE_clean_list[[10]][which.max(abs(IE_clean_list[[10]][[2]])), which(colnames(IE_clean_list[[10]]) == "um_u2_axial")],
               IE_clean_list[[11]][which.max(abs(IE_clean_list[[11]][[2]])), which(colnames(IE_clean_list[[11]]) == "um_u2_axial")],
               IE_clean_list[[12]][which.max(abs(IE_clean_list[[12]][[2]])), which(colnames(IE_clean_list[[12]]) == "um_u2_axial")],
               NA,
               NA,
               NA),
  
  wod_u3_x = c(IE_clean_list[[9]][which.max(abs(IE_clean_list[[9]][[2]])), which(colnames(IE_clean_list[[9]]) == "um_u3_axial")],
               IE_clean_list[[10]][which.max(abs(IE_clean_list[[10]][[2]])), which(colnames(IE_clean_list[[10]]) == "um_u3_axial")],
               IE_clean_list[[11]][which.max(abs(IE_clean_list[[11]][[2]])), which(colnames(IE_clean_list[[11]]) == "um_u3_axial")],
               IE_clean_list[[12]][which.max(abs(IE_clean_list[[12]][[2]])), which(colnames(IE_clean_list[[12]]) == "um_u3_axial")],
               NA,
               NA,
               NA),
  
  wod_u4_x = c(IE_clean_list[[9]][which.max(abs(IE_clean_list[[9]][[2]])), which(colnames(IE_clean_list[[9]]) == "um_u4_axial")],
               IE_clean_list[[10]][which.max(abs(IE_clean_list[[10]][[2]])), which(colnames(IE_clean_list[[10]]) == "um_u4_axial")],
               IE_clean_list[[11]][which.max(abs(IE_clean_list[[11]][[2]])), which(colnames(IE_clean_list[[11]]) == "um_u4_axial")],
               IE_clean_list[[12]][which.max(abs(IE_clean_list[[12]][[2]])), which(colnames(IE_clean_list[[12]]) == "um_u4_axial")],
               NA,
               NA,
               NA),
  
  wod_u1_y = c(IE_clean_list[[9]][which.max(abs(IE_clean_list[[9]][[3]])), which(colnames(IE_clean_list[[9]]) == "um_u1_abd_add")],
               IE_clean_list[[10]][which.max(abs(IE_clean_list[[10]][[3]])), which(colnames(IE_clean_list[[10]]) == "um_u1_abd_add")],
               IE_clean_list[[11]][which.max(abs(IE_clean_list[[11]][[3]])), which(colnames(IE_clean_list[[11]]) == "um_u1_abd_add")],
               IE_clean_list[[12]][which.max(abs(IE_clean_list[[12]][[3]])), which(colnames(IE_clean_list[[12]]) == "um_u1_abd_add")],
               IE_clean_list[[19]][which.max(abs(IE_clean_list[[19]][[3]])), which(colnames(IE_clean_list[[19]]) == "um_u1_abd_add")],
               IE_clean_list[[20]][which.max(abs(IE_clean_list[[20]][[3]])), which(colnames(IE_clean_list[[20]]) == "um_u1_abd_add")],
               IE_clean_list[[21]][which.max(abs(IE_clean_list[[21]][[3]])), which(colnames(IE_clean_list[[21]]) == "um_u1_abd_add")]),
  
  wod_u2_y = c(IE_clean_list[[9]][which.max(abs(IE_clean_list[[9]][[3]])), which(colnames(IE_clean_list[[9]]) == "um_u2_abd_add")],
               IE_clean_list[[10]][which.max(abs(IE_clean_list[[10]][[3]])), which(colnames(IE_clean_list[[10]]) == "um_u2_abd_add")],
               IE_clean_list[[11]][which.max(abs(IE_clean_list[[11]][[3]])), which(colnames(IE_clean_list[[11]]) == "um_u2_abd_add")],
               IE_clean_list[[12]][which.max(abs(IE_clean_list[[12]][[3]])), which(colnames(IE_clean_list[[12]]) == "um_u2_abd_add")],
               NA,
               NA,
               NA),
  
  wod_u3_y = c(IE_clean_list[[9]][which.max(abs(IE_clean_list[[9]][[3]])), which(colnames(IE_clean_list[[9]]) == "um_u3_abd_add")],
               IE_clean_list[[10]][which.max(abs(IE_clean_list[[10]][[3]])), which(colnames(IE_clean_list[[10]]) == "um_u3_abd_add")],
               IE_clean_list[[11]][which.max(abs(IE_clean_list[[11]][[3]])), which(colnames(IE_clean_list[[11]]) == "um_u3_abd_add")],
               IE_clean_list[[12]][which.max(abs(IE_clean_list[[12]][[3]])), which(colnames(IE_clean_list[[12]]) == "um_u3_abd_add")],
               NA,
               NA,
               NA),
  
  wod_u4_y = c(IE_clean_list[[9]][which.max(abs(IE_clean_list[[9]][[3]])), which(colnames(IE_clean_list[[9]]) == "um_u4_abd_add")],
               IE_clean_list[[10]][which.max(abs(IE_clean_list[[10]][[3]])), which(colnames(IE_clean_list[[10]]) == "um_u4_abd_add")],
               IE_clean_list[[11]][which.max(abs(IE_clean_list[[11]][[3]])), which(colnames(IE_clean_list[[11]]) == "um_u4_abd_add")],
               IE_clean_list[[12]][which.max(abs(IE_clean_list[[12]][[3]])), which(colnames(IE_clean_list[[12]]) == "um_u4_abd_add")],
               NA,
               NA,
               NA),
  
  wod_u1_z = c(IE_clean_list[[9]][which.max(abs(IE_clean_list[[9]][[4]])), which(colnames(IE_clean_list[[9]]) == "um_u1_pro_re")],
               IE_clean_list[[10]][which.max(abs(IE_clean_list[[10]][[4]])), which(colnames(IE_clean_list[[10]]) == "um_u1_pro_re")],
               IE_clean_list[[11]][which.max(abs(IE_clean_list[[11]][[4]])), which(colnames(IE_clean_list[[11]]) == "um_u1_pro_re")],
               IE_clean_list[[12]][which.max(abs(IE_clean_list[[12]][[4]])), which(colnames(IE_clean_list[[12]]) == "um_u1_pro_re")],
               IE_clean_list[[19]][which.max(abs(IE_clean_list[[19]][[4]])), which(colnames(IE_clean_list[[19]]) == "um_u1_pro_re")],
               IE_clean_list[[20]][which.max(abs(IE_clean_list[[20]][[4]])), which(colnames(IE_clean_list[[20]]) == "um_u1_pro_re")],
               IE_clean_list[[21]][which.max(abs(IE_clean_list[[21]][[4]])), which(colnames(IE_clean_list[[21]]) == "um_u1_pro_re")]),
  
  wod_u2_z = c(IE_clean_list[[9]][which.max(abs(IE_clean_list[[9]][[4]])), which(colnames(IE_clean_list[[9]]) == "um_u2_pro_re")],
               IE_clean_list[[10]][which.max(abs(IE_clean_list[[10]][[4]])), which(colnames(IE_clean_list[[10]]) == "um_u2_pro_re")],
               IE_clean_list[[11]][which.max(abs(IE_clean_list[[11]][[4]])), which(colnames(IE_clean_list[[11]]) == "um_u2_pro_re")],
               IE_clean_list[[12]][which.max(abs(IE_clean_list[[12]][[4]])), which(colnames(IE_clean_list[[12]]) == "um_u2_pro_re")],
               NA,
               NA,
               NA),
  
  wod_u3_z = c(IE_clean_list[[9]][which.max(abs(IE_clean_list[[9]][[4]])), which(colnames(IE_clean_list[[9]]) == "um_u3_pro_re")],
               IE_clean_list[[10]][which.max(abs(IE_clean_list[[10]][[4]])), which(colnames(IE_clean_list[[10]]) == "um_u3_pro_re")],
               IE_clean_list[[11]][which.max(abs(IE_clean_list[[11]][[4]])), which(colnames(IE_clean_list[[11]]) == "um_u3_pro_re")],
               IE_clean_list[[12]][which.max(abs(IE_clean_list[[12]][[4]])), which(colnames(IE_clean_list[[12]]) == "um_u3_pro_re")],
               NA,
               NA,
               NA),
  
  wod_u4_z = c(IE_clean_list[[9]][which.max(abs(IE_clean_list[[9]][[4]])), which(colnames(IE_clean_list[[9]]) == "um_u4_pro_re")],
               IE_clean_list[[10]][which.max(abs(IE_clean_list[[10]][[4]])), which(colnames(IE_clean_list[[10]]) == "um_u4_pro_re")],
               IE_clean_list[[11]][which.max(abs(IE_clean_list[[11]][[4]])), which(colnames(IE_clean_list[[11]]) == "um_u4_pro_re")],
               IE_clean_list[[12]][which.max(abs(IE_clean_list[[12]][[4]])), which(colnames(IE_clean_list[[12]]) == "um_u4_pro_re")],
               NA,
               NA,
               NA))

  
IE_bar <- reshape2::melt(IE_clean_data, id.var = "jnt")
IE_bar <- IE_bar %>%
  mutate(oROM = ifelse(str_detect(IE_bar[[2]], "max_"), "max",
                       ifelse(str_detect(IE_bar[[2]], "wd_"), "wd", "wod"))) %>%
  mutate(xyz = if_else(str_detect(IE_bar[[2]], "_x"), "axial_rotation", 
                       if_else(str_detect(IE_bar[[2]], "_y"), "abduct_adduct",
                               "pro_retract"))) %>%
  mutate(unit = if_else(str_detect(IE_bar[[2]], "_u1_"), "unit 1", 
                        if_else(str_detect(IE_bar[[2]], "_u2_"), "unit 2",
                                if_else(str_detect(IE_bar[[2]], "_u3_"), "unit 3",
                                        if_else(str_detect(IE_bar[[2]], "_u4_"), "unit 4", "unit 5")))))



#APC
APC_data <- data.frame(
  jnt = c("C11", "C13", "C15", "DIR11", "DIR13", "DIR16"),
  max_u1_x = c(APC_list[[4]][which.max(abs(APC_list[[4]][[2]])), which(colnames(APC_list[[4]]) == "um_u1_axial")],
               APC_list[[5]][which.max(abs(APC_list[[5]][[2]])), which(colnames(APC_list[[5]]) == "um_u1_axial")],
               APC_list[[6]][which.max(abs(APC_list[[6]][[2]])), which(colnames(APC_list[[6]]) == "um_u1_axial")],
               APC_list[[1]][which.max(abs(APC_list[[1]][[2]])), which(colnames(APC_list[[1]]) == "um_u1_axial")],
               APC_list[[2]][which.max(abs(APC_list[[2]][[2]])), which(colnames(APC_list[[2]]) == "um_u1_axial")],
               APC_list[[3]][which.max(abs(APC_list[[3]][[2]])), which(colnames(APC_list[[3]]) == "um_u1_axial")]),
  
  max_u2_x = c(APC_list[[4]][which.max(abs(APC_list[[4]][[2]])), which(colnames(APC_list[[4]]) == "um_u2_axial")],
               APC_list[[5]][which.max(abs(APC_list[[5]][[2]])), which(colnames(APC_list[[5]]) == "um_u2_axial")],
               APC_list[[6]][which.max(abs(APC_list[[6]][[2]])), which(colnames(APC_list[[6]]) == "um_u2_axial")],
               APC_list[[1]][which.max(abs(APC_list[[1]][[2]])), which(colnames(APC_list[[1]]) == "um_u2_axial")],
               APC_list[[2]][which.max(abs(APC_list[[2]][[2]])), which(colnames(APC_list[[2]]) == "um_u2_axial")],
               APC_list[[3]][which.max(abs(APC_list[[3]][[2]])), which(colnames(APC_list[[3]]) == "um_u2_axial")]),
  
  max_u3_x = c(APC_list[[4]][which.max(abs(APC_list[[4]][[2]])), which(colnames(APC_list[[4]]) == "um_u3_axial")],
               APC_list[[5]][which.max(abs(APC_list[[5]][[2]])), which(colnames(APC_list[[5]]) == "um_u3_axial")],
               APC_list[[6]][which.max(abs(APC_list[[6]][[2]])), which(colnames(APC_list[[6]]) == "um_u3_axial")],
               APC_list[[1]][which.max(abs(APC_list[[1]][[2]])), which(colnames(APC_list[[1]]) == "um_u3_axial")],
               APC_list[[2]][which.max(abs(APC_list[[2]][[2]])), which(colnames(APC_list[[2]]) == "um_u3_axial")],
               APC_list[[3]][which.max(abs(APC_list[[3]][[2]])), which(colnames(APC_list[[3]]) == "um_u3_axial")]),
  
  max_u1_y = c(APC_list[[4]][which.max(abs(APC_list[[4]][[3]])), which(colnames(APC_list[[4]]) == "um_u1_abd_add")],
               APC_list[[5]][which.max(abs(APC_list[[5]][[3]])), which(colnames(APC_list[[5]]) == "um_u1_abd_add")],
               APC_list[[6]][which.max(abs(APC_list[[6]][[3]])), which(colnames(APC_list[[6]]) == "um_u1_abd_add")],
               APC_list[[1]][which.max(abs(APC_list[[1]][[3]])), which(colnames(APC_list[[1]]) == "um_u1_abd_add")],
               APC_list[[2]][which.max(abs(APC_list[[2]][[3]])), which(colnames(APC_list[[2]]) == "um_u1_abd_add")],
               APC_list[[3]][which.max(abs(APC_list[[3]][[3]])), which(colnames(APC_list[[3]]) == "um_u1_abd_add")]),
  
  max_u2_y = c(APC_list[[4]][which.max(abs(APC_list[[4]][[3]])), which(colnames(APC_list[[4]]) == "um_u2_abd_add")],
               APC_list[[5]][which.max(abs(APC_list[[5]][[3]])), which(colnames(APC_list[[5]]) == "um_u2_abd_add")],
               APC_list[[6]][which.max(abs(APC_list[[6]][[3]])), which(colnames(APC_list[[6]]) == "um_u2_abd_add")],
               APC_list[[1]][which.max(abs(APC_list[[1]][[3]])), which(colnames(APC_list[[1]]) == "um_u2_abd_add")],
               APC_list[[2]][which.max(abs(APC_list[[2]][[3]])), which(colnames(APC_list[[2]]) == "um_u2_abd_add")],
               APC_list[[3]][which.max(abs(APC_list[[3]][[3]])), which(colnames(APC_list[[3]]) == "um_u2_abd_add")]),
  
  max_u3_y = c(APC_list[[4]][which.max(abs(APC_list[[4]][[3]])), which(colnames(APC_list[[4]]) == "um_u3_abd_add")],
               APC_list[[5]][which.max(abs(APC_list[[5]][[3]])), which(colnames(APC_list[[5]]) == "um_u3_abd_add")],
               APC_list[[6]][which.max(abs(APC_list[[6]][[3]])), which(colnames(APC_list[[6]]) == "um_u3_abd_add")],
               APC_list[[1]][which.max(abs(APC_list[[1]][[3]])), which(colnames(APC_list[[1]]) == "um_u3_abd_add")],
               APC_list[[2]][which.max(abs(APC_list[[2]][[3]])), which(colnames(APC_list[[2]]) == "um_u3_abd_add")],
               APC_list[[3]][which.max(abs(APC_list[[3]][[3]])), which(colnames(APC_list[[3]]) == "um_u3_abd_add")]),
  
  max_u1_z = c(APC_list[[4]][which.max(abs(APC_list[[4]][[4]])), which(colnames(APC_list[[4]]) == "um_u1_pro_re")],
               APC_list[[5]][which.max(abs(APC_list[[5]][[4]])), which(colnames(APC_list[[5]]) == "um_u1_pro_re")],
               APC_list[[6]][which.max(abs(APC_list[[6]][[4]])), which(colnames(APC_list[[6]]) == "um_u1_pro_re")],
               APC_list[[1]][which.max(abs(APC_list[[1]][[4]])), which(colnames(APC_list[[1]]) == "um_u1_pro_re")],
               APC_list[[2]][which.max(abs(APC_list[[2]][[4]])), which(colnames(APC_list[[2]]) == "um_u1_pro_re")],
               APC_list[[3]][which.max(abs(APC_list[[3]][[4]])), which(colnames(APC_list[[3]]) == "um_u1_pro_re")]),
  
  max_u2_z = c(APC_list[[4]][which.max(abs(APC_list[[4]][[4]])), which(colnames(APC_list[[4]]) == "um_u2_pro_re")],
               APC_list[[5]][which.max(abs(APC_list[[5]][[4]])), which(colnames(APC_list[[5]]) == "um_u2_pro_re")],
               APC_list[[6]][which.max(abs(APC_list[[6]][[4]])), which(colnames(APC_list[[6]]) == "um_u2_pro_re")],
               APC_list[[1]][which.max(abs(APC_list[[1]][[4]])), which(colnames(APC_list[[1]]) == "um_u2_pro_re")],
               APC_list[[2]][which.max(abs(APC_list[[2]][[4]])), which(colnames(APC_list[[2]]) == "um_u2_pro_re")],
               APC_list[[3]][which.max(abs(APC_list[[3]][[4]])), which(colnames(APC_list[[3]]) == "um_u2_pro_re")]),
  
  max_u3_z = c(APC_list[[4]][which.max(abs(APC_list[[4]][[4]])), which(colnames(APC_list[[4]]) == "um_u3_pro_re")],
               APC_list[[5]][which.max(abs(APC_list[[5]][[4]])), which(colnames(APC_list[[5]]) == "um_u3_pro_re")],
               APC_list[[6]][which.max(abs(APC_list[[6]][[4]])), which(colnames(APC_list[[6]]) == "um_u3_pro_re")],
               APC_list[[1]][which.max(abs(APC_list[[1]][[4]])), which(colnames(APC_list[[1]]) == "um_u3_pro_re")],
               APC_list[[2]][which.max(abs(APC_list[[2]][[4]])), which(colnames(APC_list[[2]]) == "um_u3_pro_re")],
               APC_list[[3]][which.max(abs(APC_list[[3]][[4]])), which(colnames(APC_list[[3]]) == "um_u3_pro_re")]),
  
  wd_u1_x = c(APC_list[[10]][which.max(abs(APC_list[[10]][[2]])), which(colnames(APC_list[[10]]) == "um_u1_axial")],
               APC_list[[11]][which.max(abs(APC_list[[11]][[2]])), which(colnames(APC_list[[11]]) == "um_u1_axial")],
               APC_list[[12]][which.max(abs(APC_list[[12]][[2]])), which(colnames(APC_list[[12]]) == "um_u1_axial")],
               APC_list[[7]][which.max(abs(APC_list[[7]][[2]])), which(colnames(APC_list[[7]]) == "um_u1_axial")],
               APC_list[[8]][which.max(abs(APC_list[[8]][[2]])), which(colnames(APC_list[[8]]) == "um_u1_axial")],
               APC_list[[9]][which.max(abs(APC_list[[9]][[2]])), which(colnames(APC_list[[9]]) == "um_u1_axial")]),
  
  wd_u2_x = c(APC_list[[10]][which.max(abs(APC_list[[10]][[2]])), which(colnames(APC_list[[10]]) == "um_u2_axial")],
               APC_list[[11]][which.max(abs(APC_list[[11]][[2]])), which(colnames(APC_list[[11]]) == "um_u2_axial")],
               APC_list[[12]][which.max(abs(APC_list[[12]][[2]])), which(colnames(APC_list[[12]]) == "um_u2_axial")],
               APC_list[[7]][which.max(abs(APC_list[[7]][[2]])), which(colnames(APC_list[[7]]) == "um_u2_axial")],
               APC_list[[8]][which.max(abs(APC_list[[8]][[2]])), which(colnames(APC_list[[8]]) == "um_u2_axial")],
               APC_list[[9]][which.max(abs(APC_list[[9]][[2]])), which(colnames(APC_list[[9]]) == "um_u2_axial")]),
  
  wd_u3_x = c(APC_list[[10]][which.max(abs(APC_list[[10]][[2]])), which(colnames(APC_list[[10]]) == "um_u3_axial")],
               APC_list[[11]][which.max(abs(APC_list[[11]][[2]])), which(colnames(APC_list[[11]]) == "um_u3_axial")],
               APC_list[[12]][which.max(abs(APC_list[[12]][[2]])), which(colnames(APC_list[[12]]) == "um_u3_axial")],
               APC_list[[7]][which.max(abs(APC_list[[7]][[2]])), which(colnames(APC_list[[7]]) == "um_u3_axial")],
               APC_list[[8]][which.max(abs(APC_list[[8]][[2]])), which(colnames(APC_list[[8]]) == "um_u3_axial")],
               APC_list[[9]][which.max(abs(APC_list[[9]][[2]])), which(colnames(APC_list[[9]]) == "um_u3_axial")]),
  
  wd_u1_y = c(APC_list[[10]][which.max(abs(APC_list[[10]][[3]])), which(colnames(APC_list[[10]]) == "um_u1_abd_add")],
               APC_list[[11]][which.max(abs(APC_list[[11]][[3]])), which(colnames(APC_list[[11]]) == "um_u1_abd_add")],
               APC_list[[12]][which.max(abs(APC_list[[12]][[3]])), which(colnames(APC_list[[12]]) == "um_u1_abd_add")],
               APC_list[[7]][which.max(abs(APC_list[[7]][[3]])), which(colnames(APC_list[[7]]) == "um_u1_abd_add")],
               APC_list[[8]][which.max(abs(APC_list[[8]][[3]])), which(colnames(APC_list[[8]]) == "um_u1_abd_add")],
               APC_list[[9]][which.max(abs(APC_list[[9]][[3]])), which(colnames(APC_list[[9]]) == "um_u1_abd_add")]),
  
  wd_u2_y = c(APC_list[[10]][which.max(abs(APC_list[[10]][[3]])), which(colnames(APC_list[[10]]) == "um_u2_abd_add")],
               APC_list[[11]][which.max(abs(APC_list[[11]][[3]])), which(colnames(APC_list[[11]]) == "um_u2_abd_add")],
               APC_list[[12]][which.max(abs(APC_list[[12]][[3]])), which(colnames(APC_list[[12]]) == "um_u2_abd_add")],
               APC_list[[7]][which.max(abs(APC_list[[7]][[3]])), which(colnames(APC_list[[7]]) == "um_u2_abd_add")],
               APC_list[[8]][which.max(abs(APC_list[[8]][[3]])), which(colnames(APC_list[[8]]) == "um_u2_abd_add")],
               APC_list[[9]][which.max(abs(APC_list[[9]][[3]])), which(colnames(APC_list[[9]]) == "um_u2_abd_add")]),
  
  wd_u3_y = c(APC_list[[10]][which.max(abs(APC_list[[10]][[3]])), which(colnames(APC_list[[10]]) == "um_u3_abd_add")],
               APC_list[[11]][which.max(abs(APC_list[[11]][[3]])), which(colnames(APC_list[[11]]) == "um_u3_abd_add")],
               APC_list[[12]][which.max(abs(APC_list[[12]][[3]])), which(colnames(APC_list[[12]]) == "um_u3_abd_add")],
               APC_list[[7]][which.max(abs(APC_list[[7]][[3]])), which(colnames(APC_list[[7]]) == "um_u3_abd_add")],
               APC_list[[8]][which.max(abs(APC_list[[8]][[3]])), which(colnames(APC_list[[8]]) == "um_u3_abd_add")],
               APC_list[[9]][which.max(abs(APC_list[[9]][[3]])), which(colnames(APC_list[[9]]) == "um_u3_abd_add")]),
  
  wd_u1_z = c(APC_list[[10]][which.max(abs(APC_list[[10]][[4]])), which(colnames(APC_list[[10]]) == "um_u1_pro_re")],
               APC_list[[11]][which.max(abs(APC_list[[11]][[4]])), which(colnames(APC_list[[11]]) == "um_u1_pro_re")],
               APC_list[[12]][which.max(abs(APC_list[[12]][[4]])), which(colnames(APC_list[[12]]) == "um_u1_pro_re")],
               APC_list[[7]][which.max(abs(APC_list[[7]][[4]])), which(colnames(APC_list[[7]]) == "um_u1_pro_re")],
               APC_list[[8]][which.max(abs(APC_list[[8]][[4]])), which(colnames(APC_list[[8]]) == "um_u1_pro_re")],
               APC_list[[9]][which.max(abs(APC_list[[9]][[4]])), which(colnames(APC_list[[9]]) == "um_u1_pro_re")]),
  
  wd_u2_z = c(APC_list[[10]][which.max(abs(APC_list[[10]][[4]])), which(colnames(APC_list[[10]]) == "um_u2_pro_re")],
               APC_list[[11]][which.max(abs(APC_list[[11]][[4]])), which(colnames(APC_list[[11]]) == "um_u2_pro_re")],
               APC_list[[12]][which.max(abs(APC_list[[12]][[4]])), which(colnames(APC_list[[12]]) == "um_u2_pro_re")],
               APC_list[[7]][which.max(abs(APC_list[[7]][[4]])), which(colnames(APC_list[[7]]) == "um_u2_pro_re")],
               APC_list[[8]][which.max(abs(APC_list[[8]][[4]])), which(colnames(APC_list[[8]]) == "um_u2_pro_re")],
               APC_list[[9]][which.max(abs(APC_list[[9]][[4]])), which(colnames(APC_list[[9]]) == "um_u2_pro_re")]),
  
  wd_u3_z = c(APC_list[[10]][which.max(abs(APC_list[[10]][[4]])), which(colnames(APC_list[[10]]) == "um_u3_pro_re")],
               APC_list[[11]][which.max(abs(APC_list[[11]][[4]])), which(colnames(APC_list[[11]]) == "um_u3_pro_re")],
               APC_list[[12]][which.max(abs(APC_list[[12]][[4]])), which(colnames(APC_list[[12]]) == "um_u3_pro_re")],
               APC_list[[7]][which.max(abs(APC_list[[7]][[4]])), which(colnames(APC_list[[7]]) == "um_u3_pro_re")],
               APC_list[[8]][which.max(abs(APC_list[[8]][[4]])), which(colnames(APC_list[[8]]) == "um_u3_pro_re")],
               APC_list[[9]][which.max(abs(APC_list[[9]][[4]])), which(colnames(APC_list[[9]]) == "um_u3_pro_re")]),
 
  wod_u1_x = c(APC_list[[16]][which.max(abs(APC_list[[16]][[2]])), which(colnames(APC_list[[16]]) == "um_u1_axial")],
              APC_list[[17]][which.max(abs(APC_list[[17]][[2]])), which(colnames(APC_list[[17]]) == "um_u1_axial")],
              APC_list[[18]][which.max(abs(APC_list[[18]][[2]])), which(colnames(APC_list[[18]]) == "um_u1_axial")],
              APC_list[[13]][which.max(abs(APC_list[[13]][[2]])), which(colnames(APC_list[[13]]) == "um_u1_axial")],
              APC_list[[14]][which.max(abs(APC_list[[14]][[2]])), which(colnames(APC_list[[14]]) == "um_u1_axial")],
              APC_list[[15]][which.max(abs(APC_list[[15]][[2]])), which(colnames(APC_list[[15]]) == "um_u1_axial")]),
  
  wod_u2_x = c(APC_list[[16]][which.max(abs(APC_list[[16]][[2]])), which(colnames(APC_list[[16]]) == "um_u2_axial")],
              APC_list[[17]][which.max(abs(APC_list[[17]][[2]])), which(colnames(APC_list[[17]]) == "um_u2_axial")],
              APC_list[[18]][which.max(abs(APC_list[[18]][[2]])), which(colnames(APC_list[[18]]) == "um_u2_axial")],
              APC_list[[13]][which.max(abs(APC_list[[13]][[2]])), which(colnames(APC_list[[13]]) == "um_u2_axial")],
              APC_list[[14]][which.max(abs(APC_list[[14]][[2]])), which(colnames(APC_list[[14]]) == "um_u2_axial")],
              APC_list[[15]][which.max(abs(APC_list[[15]][[2]])), which(colnames(APC_list[[15]]) == "um_u2_axial")]),
  
  wod_u3_x = c(APC_list[[16]][which.max(abs(APC_list[[16]][[2]])), which(colnames(APC_list[[16]]) == "um_u3_axial")],
              APC_list[[17]][which.max(abs(APC_list[[17]][[2]])), which(colnames(APC_list[[17]]) == "um_u3_axial")],
              APC_list[[18]][which.max(abs(APC_list[[18]][[2]])), which(colnames(APC_list[[18]]) == "um_u3_axial")],
              APC_list[[13]][which.max(abs(APC_list[[13]][[2]])), which(colnames(APC_list[[13]]) == "um_u3_axial")],
              APC_list[[14]][which.max(abs(APC_list[[14]][[2]])), which(colnames(APC_list[[14]]) == "um_u3_axial")],
              APC_list[[15]][which.max(abs(APC_list[[15]][[2]])), which(colnames(APC_list[[15]]) == "um_u3_axial")]),
  
  wod_u1_y = c(APC_list[[16]][which.max(abs(APC_list[[16]][[3]])), which(colnames(APC_list[[16]]) == "um_u1_abd_add")],
              APC_list[[17]][which.max(abs(APC_list[[17]][[3]])), which(colnames(APC_list[[17]]) == "um_u1_abd_add")],
              APC_list[[18]][which.max(abs(APC_list[[18]][[3]])), which(colnames(APC_list[[18]]) == "um_u1_abd_add")],
              APC_list[[13]][which.max(abs(APC_list[[13]][[3]])), which(colnames(APC_list[[13]]) == "um_u1_abd_add")],
              APC_list[[14]][which.max(abs(APC_list[[14]][[3]])), which(colnames(APC_list[[14]]) == "um_u1_abd_add")],
              APC_list[[15]][which.max(abs(APC_list[[15]][[3]])), which(colnames(APC_list[[15]]) == "um_u1_abd_add")]),
  
  wod_u2_y = c(APC_list[[16]][which.max(abs(APC_list[[16]][[3]])), which(colnames(APC_list[[16]]) == "um_u2_abd_add")],
              APC_list[[17]][which.max(abs(APC_list[[17]][[3]])), which(colnames(APC_list[[17]]) == "um_u2_abd_add")],
              APC_list[[18]][which.max(abs(APC_list[[18]][[3]])), which(colnames(APC_list[[18]]) == "um_u2_abd_add")],
              APC_list[[13]][which.max(abs(APC_list[[13]][[3]])), which(colnames(APC_list[[13]]) == "um_u2_abd_add")],
              APC_list[[14]][which.max(abs(APC_list[[14]][[3]])), which(colnames(APC_list[[14]]) == "um_u2_abd_add")],
              APC_list[[15]][which.max(abs(APC_list[[15]][[3]])), which(colnames(APC_list[[15]]) == "um_u2_abd_add")]),
  
  wod_u3_y = c(APC_list[[16]][which.max(abs(APC_list[[16]][[3]])), which(colnames(APC_list[[16]]) == "um_u3_abd_add")],
              APC_list[[17]][which.max(abs(APC_list[[17]][[3]])), which(colnames(APC_list[[17]]) == "um_u3_abd_add")],
              APC_list[[18]][which.max(abs(APC_list[[18]][[3]])), which(colnames(APC_list[[18]]) == "um_u3_abd_add")],
              APC_list[[13]][which.max(abs(APC_list[[13]][[3]])), which(colnames(APC_list[[13]]) == "um_u3_abd_add")],
              APC_list[[14]][which.max(abs(APC_list[[14]][[3]])), which(colnames(APC_list[[14]]) == "um_u3_abd_add")],
              APC_list[[15]][which.max(abs(APC_list[[15]][[3]])), which(colnames(APC_list[[15]]) == "um_u3_abd_add")]),
  
  wod_u1_z = c(APC_list[[16]][which.max(abs(APC_list[[16]][[4]])), which(colnames(APC_list[[16]]) == "um_u1_pro_re")],
              APC_list[[17]][which.max(abs(APC_list[[17]][[4]])), which(colnames(APC_list[[17]]) == "um_u1_pro_re")],
              APC_list[[18]][which.max(abs(APC_list[[18]][[4]])), which(colnames(APC_list[[18]]) == "um_u1_pro_re")],
              APC_list[[13]][which.max(abs(APC_list[[13]][[4]])), which(colnames(APC_list[[13]]) == "um_u1_pro_re")],
              APC_list[[14]][which.max(abs(APC_list[[14]][[4]])), which(colnames(APC_list[[14]]) == "um_u1_pro_re")],
              APC_list[[15]][which.max(abs(APC_list[[15]][[4]])), which(colnames(APC_list[[15]]) == "um_u1_pro_re")]),
  
  wd_u2_z = c(APC_list[[16]][which.max(abs(APC_list[[16]][[4]])), which(colnames(APC_list[[16]]) == "um_u2_pro_re")],
              APC_list[[17]][which.max(abs(APC_list[[17]][[4]])), which(colnames(APC_list[[17]]) == "um_u2_pro_re")],
              APC_list[[18]][which.max(abs(APC_list[[18]][[4]])), which(colnames(APC_list[[18]]) == "um_u2_pro_re")],
              APC_list[[13]][which.max(abs(APC_list[[13]][[4]])), which(colnames(APC_list[[13]]) == "um_u2_pro_re")],
              APC_list[[14]][which.max(abs(APC_list[[14]][[4]])), which(colnames(APC_list[[14]]) == "um_u2_pro_re")],
              APC_list[[15]][which.max(abs(APC_list[[15]][[4]])), which(colnames(APC_list[[15]]) == "um_u2_pro_re")]),
  
  wd_u3_z = c(APC_list[[16]][which.max(abs(APC_list[[16]][[4]])), which(colnames(APC_list[[16]]) == "um_u3_pro_re")],
              APC_list[[17]][which.max(abs(APC_list[[17]][[4]])), which(colnames(APC_list[[17]]) == "um_u3_pro_re")],
              APC_list[[18]][which.max(abs(APC_list[[18]][[4]])), which(colnames(APC_list[[18]]) == "um_u3_pro_re")],
              APC_list[[13]][which.max(abs(APC_list[[13]][[4]])), which(colnames(APC_list[[13]]) == "um_u3_pro_re")],
              APC_list[[14]][which.max(abs(APC_list[[14]][[4]])), which(colnames(APC_list[[14]]) == "um_u3_pro_re")],
              APC_list[[15]][which.max(abs(APC_list[[15]][[4]])), which(colnames(APC_list[[15]]) == "um_u3_pro_re")]))

APC_bar <- reshape2::melt(APC_data, id.var = "jnt")
APC_bar <- APC_bar %>%
  mutate(oROM = ifelse(str_detect(APC_bar[[2]], "max_"), "max",
                       ifelse(str_detect(APC_bar[[2]], "wd_"), "wd", "wod"))) %>%
  mutate(xyz = if_else(str_detect(APC_bar[[2]], "_x"), "axial_rotation", 
                       if_else(str_detect(APC_bar[[2]], "_y"), "abduct_adduct",
                               "pro_retract"))) %>%
  mutate(unit = if_else(str_detect(APC_bar[[2]], "_u1_"), "unit 1", 
                        if_else(str_detect(APC_bar[[2]], "_u2_"), "unit 2","unit 3")))

#II
II_clean_list <- II_list[-c(1:3)]
II_clean_data <- data.frame(
  jnt = c("C10", "C11", "C13", "C15", "DIR11", "DIR13"),
  max_u1_x = c(II_clean_list[[3]][which.max(abs(II_clean_list[[3]][[2]])), which(colnames(II_clean_list[[3]]) == "um_u1_axial")],
               II_clean_list[[4]][which.max(abs(II_clean_list[[4]][[2]])), which(colnames(II_clean_list[[4]]) == "um_u1_axial")],
               II_clean_list[[5]][which.max(abs(II_clean_list[[5]][[2]])), which(colnames(II_clean_list[[5]]) == "um_u1_axial")],
               II_clean_list[[6]][which.max(abs(II_clean_list[[6]][[2]])), which(colnames(II_clean_list[[6]]) == "um_u1_axial")],
               II_clean_list[[1]][which.max(abs(II_clean_list[[1]][[2]])), which(colnames(II_clean_list[[1]]) == "um_u6_axial")],
               II_clean_list[[2]][which.max(abs(II_clean_list[[2]][[2]])), which(colnames(II_clean_list[[2]]) == "um_u6_axial")]),
  
  max_u2_x = c(II_clean_list[[3]][which.max(abs(II_clean_list[[3]][[2]])), which(colnames(II_clean_list[[3]]) == "um_u2_axial")],
               II_clean_list[[4]][which.max(abs(II_clean_list[[4]][[2]])), which(colnames(II_clean_list[[4]]) == "um_u2_axial")],
               II_clean_list[[5]][which.max(abs(II_clean_list[[5]][[2]])), which(colnames(II_clean_list[[5]]) == "um_u2_axial")],
               II_clean_list[[6]][which.max(abs(II_clean_list[[6]][[2]])), which(colnames(II_clean_list[[6]]) == "um_u2_axial")],
               II_clean_list[[1]][which.max(abs(II_clean_list[[1]][[2]])), which(colnames(II_clean_list[[1]]) == "um_u7_axial")],
               II_clean_list[[2]][which.max(abs(II_clean_list[[2]][[2]])), which(colnames(II_clean_list[[2]]) == "um_u7_axial")]),
  
  max_u3_x = c(II_clean_list[[3]][which.max(abs(II_clean_list[[3]][[2]])), which(colnames(II_clean_list[[3]]) == "um_u3_axial")],
               II_clean_list[[4]][which.max(abs(II_clean_list[[4]][[2]])), which(colnames(II_clean_list[[4]]) == "um_u3_axial")],
               II_clean_list[[5]][which.max(abs(II_clean_list[[5]][[2]])), which(colnames(II_clean_list[[5]]) == "um_u3_axial")],
               II_clean_list[[6]][which.max(abs(II_clean_list[[6]][[2]])), which(colnames(II_clean_list[[6]]) == "um_u3_axial")],
               II_clean_list[[1]][which.max(abs(II_clean_list[[1]][[2]])), which(colnames(II_clean_list[[1]]) == "um_u8_axial")],
               II_clean_list[[2]][which.max(abs(II_clean_list[[2]][[2]])), which(colnames(II_clean_list[[2]]) == "um_u8_axial")]),
  
  max_u4_x = c(II_clean_list[[3]][which.max(abs(II_clean_list[[3]][[2]])), which(colnames(II_clean_list[[3]]) == "um_u4_axial")],
               II_clean_list[[4]][which.max(abs(II_clean_list[[4]][[2]])), which(colnames(II_clean_list[[4]]) == "um_u4_axial")],
               II_clean_list[[5]][which.max(abs(II_clean_list[[5]][[2]])), which(colnames(II_clean_list[[5]]) == "um_u4_axial")],
               II_clean_list[[6]][which.max(abs(II_clean_list[[6]][[2]])), which(colnames(II_clean_list[[6]]) == "um_u4_axial")],
               NA,
               NA),
  
  max_u5_x = c(II_clean_list[[3]][which.max(abs(II_clean_list[[3]][[2]])), which(colnames(II_clean_list[[3]]) == "um_u5_axial")],
               II_clean_list[[4]][which.max(abs(II_clean_list[[4]][[2]])), which(colnames(II_clean_list[[4]]) == "um_u5_axial")],
               II_clean_list[[5]][which.max(abs(II_clean_list[[5]][[2]])), which(colnames(II_clean_list[[5]]) == "um_u5_axial")],
               II_clean_list[[6]][which.max(abs(II_clean_list[[6]][[2]])), which(colnames(II_clean_list[[6]]) == "um_u5_axial")],
               NA,
               NA),
  
  max_u1_y = c(II_clean_list[[3]][which.max(abs(II_clean_list[[3]][[3]])), which(colnames(II_clean_list[[3]]) == "um_u1_abd_add")],
               II_clean_list[[4]][which.max(abs(II_clean_list[[4]][[3]])), which(colnames(II_clean_list[[4]]) == "um_u1_abd_add")],
               II_clean_list[[5]][which.max(abs(II_clean_list[[5]][[3]])), which(colnames(II_clean_list[[5]]) == "um_u1_abd_add")],
               II_clean_list[[6]][which.max(abs(II_clean_list[[6]][[3]])), which(colnames(II_clean_list[[6]]) == "um_u1_abd_add")],
               II_clean_list[[1]][which.max(abs(II_clean_list[[1]][[3]])), which(colnames(II_clean_list[[1]]) == "um_u6_abd_add")],
               II_clean_list[[2]][which.max(abs(II_clean_list[[2]][[3]])), which(colnames(II_clean_list[[2]]) == "um_u6_abd_add")]),
  
  max_u2_y = c(II_clean_list[[3]][which.max(abs(II_clean_list[[3]][[3]])), which(colnames(II_clean_list[[3]]) == "um_u2_abd_add")],
               II_clean_list[[4]][which.max(abs(II_clean_list[[4]][[3]])), which(colnames(II_clean_list[[4]]) == "um_u2_abd_add")],
               II_clean_list[[5]][which.max(abs(II_clean_list[[5]][[3]])), which(colnames(II_clean_list[[5]]) == "um_u2_abd_add")],
               II_clean_list[[6]][which.max(abs(II_clean_list[[6]][[3]])), which(colnames(II_clean_list[[6]]) == "um_u2_abd_add")],
               II_clean_list[[1]][which.max(abs(II_clean_list[[1]][[3]])), which(colnames(II_clean_list[[1]]) == "um_u7_abd_add")],
               II_clean_list[[2]][which.max(abs(II_clean_list[[2]][[3]])), which(colnames(II_clean_list[[2]]) == "um_u7_abd_add")]),
  
  max_u3_y = c(II_clean_list[[3]][which.max(abs(II_clean_list[[3]][[3]])), which(colnames(II_clean_list[[3]]) == "um_u3_abd_add")],
               II_clean_list[[4]][which.max(abs(II_clean_list[[4]][[3]])), which(colnames(II_clean_list[[4]]) == "um_u3_abd_add")],
               II_clean_list[[5]][which.max(abs(II_clean_list[[5]][[3]])), which(colnames(II_clean_list[[5]]) == "um_u3_abd_add")],
               II_clean_list[[6]][which.max(abs(II_clean_list[[6]][[3]])), which(colnames(II_clean_list[[6]]) == "um_u3_abd_add")],
               II_clean_list[[1]][which.max(abs(II_clean_list[[1]][[3]])), which(colnames(II_clean_list[[1]]) == "um_u8_abd_add")],
               II_clean_list[[2]][which.max(abs(II_clean_list[[2]][[3]])), which(colnames(II_clean_list[[2]]) == "um_u8_abd_add")]),
  
  max_u4_y = c(II_clean_list[[3]][which.max(abs(II_clean_list[[3]][[3]])), which(colnames(II_clean_list[[3]]) == "um_u4_abd_add")],
               II_clean_list[[4]][which.max(abs(II_clean_list[[4]][[3]])), which(colnames(II_clean_list[[4]]) == "um_u4_abd_add")],
               II_clean_list[[5]][which.max(abs(II_clean_list[[5]][[3]])), which(colnames(II_clean_list[[5]]) == "um_u4_abd_add")],
               II_clean_list[[6]][which.max(abs(II_clean_list[[6]][[3]])), which(colnames(II_clean_list[[6]]) == "um_u4_abd_add")],
               NA,
               NA),
  
  max_u5_y = c(II_clean_list[[3]][which.max(abs(II_clean_list[[3]][[3]])), which(colnames(II_clean_list[[3]]) == "um_u5_abd_add")],
               II_clean_list[[4]][which.max(abs(II_clean_list[[4]][[3]])), which(colnames(II_clean_list[[4]]) == "um_u5_abd_add")],
               II_clean_list[[5]][which.max(abs(II_clean_list[[5]][[3]])), which(colnames(II_clean_list[[5]]) == "um_u5_abd_add")],
               II_clean_list[[6]][which.max(abs(II_clean_list[[6]][[3]])), which(colnames(II_clean_list[[6]]) == "um_u5_abd_add")],
               NA,
               NA),
 
  max_u1_z = c(II_clean_list[[3]][which.max(abs(II_clean_list[[3]][[4]])), which(colnames(II_clean_list[[3]]) == "um_u1_pro_re")],
               II_clean_list[[4]][which.max(abs(II_clean_list[[4]][[4]])), which(colnames(II_clean_list[[4]]) == "um_u1_pro_re")],
               II_clean_list[[5]][which.max(abs(II_clean_list[[5]][[4]])), which(colnames(II_clean_list[[5]]) == "um_u1_pro_re")],
               II_clean_list[[6]][which.max(abs(II_clean_list[[6]][[4]])), which(colnames(II_clean_list[[6]]) == "um_u1_pro_re")],
               II_clean_list[[1]][which.max(abs(II_clean_list[[1]][[4]])), which(colnames(II_clean_list[[1]]) == "um_u6_pro_re")],
               II_clean_list[[2]][which.max(abs(II_clean_list[[2]][[4]])), which(colnames(II_clean_list[[2]]) == "um_u6_pro_re")]),
  
  max_u2_z = c(II_clean_list[[3]][which.max(abs(II_clean_list[[3]][[4]])), which(colnames(II_clean_list[[3]]) == "um_u2_pro_re")],
               II_clean_list[[4]][which.max(abs(II_clean_list[[4]][[4]])), which(colnames(II_clean_list[[4]]) == "um_u2_pro_re")],
               II_clean_list[[5]][which.max(abs(II_clean_list[[5]][[4]])), which(colnames(II_clean_list[[5]]) == "um_u2_pro_re")],
               II_clean_list[[6]][which.max(abs(II_clean_list[[6]][[4]])), which(colnames(II_clean_list[[6]]) == "um_u2_pro_re")],
               II_clean_list[[1]][which.max(abs(II_clean_list[[1]][[4]])), which(colnames(II_clean_list[[1]]) == "um_u7_pro_re")],
               II_clean_list[[2]][which.max(abs(II_clean_list[[2]][[4]])), which(colnames(II_clean_list[[2]]) == "um_u7_pro_re")]),
  
  max_u3_z = c(II_clean_list[[3]][which.max(abs(II_clean_list[[3]][[4]])), which(colnames(II_clean_list[[3]]) == "um_u3_pro_re")],
               II_clean_list[[4]][which.max(abs(II_clean_list[[4]][[4]])), which(colnames(II_clean_list[[4]]) == "um_u3_pro_re")],
               II_clean_list[[5]][which.max(abs(II_clean_list[[5]][[4]])), which(colnames(II_clean_list[[5]]) == "um_u3_pro_re")],
               II_clean_list[[6]][which.max(abs(II_clean_list[[6]][[4]])), which(colnames(II_clean_list[[6]]) == "um_u3_pro_re")],
               II_clean_list[[1]][which.max(abs(II_clean_list[[1]][[4]])), which(colnames(II_clean_list[[1]]) == "um_u8_pro_re")],
               II_clean_list[[2]][which.max(abs(II_clean_list[[2]][[4]])), which(colnames(II_clean_list[[2]]) == "um_u8_pro_re")]),
  
  max_u4_z = c(II_clean_list[[3]][which.max(abs(II_clean_list[[3]][[4]])), which(colnames(II_clean_list[[3]]) == "um_u4_pro_re")],
               II_clean_list[[4]][which.max(abs(II_clean_list[[4]][[4]])), which(colnames(II_clean_list[[4]]) == "um_u4_pro_re")],
               II_clean_list[[5]][which.max(abs(II_clean_list[[5]][[4]])), which(colnames(II_clean_list[[5]]) == "um_u4_pro_re")],
               II_clean_list[[6]][which.max(abs(II_clean_list[[6]][[4]])), which(colnames(II_clean_list[[6]]) == "um_u4_pro_re")],
               NA,
               NA),
  
  max_u5_z = c(II_clean_list[[3]][which.max(abs(II_clean_list[[3]][[4]])), which(colnames(II_clean_list[[3]]) == "um_u5_pro_re")],
               II_clean_list[[4]][which.max(abs(II_clean_list[[4]][[4]])), which(colnames(II_clean_list[[4]]) == "um_u5_pro_re")],
               II_clean_list[[5]][which.max(abs(II_clean_list[[5]][[4]])), which(colnames(II_clean_list[[5]]) == "um_u5_pro_re")],
               II_clean_list[[6]][which.max(abs(II_clean_list[[6]][[4]])), which(colnames(II_clean_list[[6]]) == "um_u5_pro_re")],
               NA,
               NA),
  
  wd_u1_x = c(II_clean_list[[9]][which.max(abs(II_clean_list[[9]][[2]])), which(colnames(II_clean_list[[9]]) == "um_u1_axial")],
               II_clean_list[[10]][which.max(abs(II_clean_list[[10]][[2]])), which(colnames(II_clean_list[[10]]) == "um_u1_axial")],
               II_clean_list[[11]][which.max(abs(II_clean_list[[11]][[2]])), which(colnames(II_clean_list[[11]]) == "um_u1_axial")],
               II_clean_list[[12]][which.max(abs(II_clean_list[[12]][[2]])), which(colnames(II_clean_list[[12]]) == "um_u1_axial")],
               II_clean_list[[7]][which.max(abs(II_clean_list[[7]][[2]])), which(colnames(II_clean_list[[7]]) == "um_u6_axial")],
               II_clean_list[[8]][which.max(abs(II_clean_list[[8]][[2]])), which(colnames(II_clean_list[[8]]) == "um_u6_axial")]),
  
  wd_u2_x = c(II_clean_list[[9]][which.max(abs(II_clean_list[[9]][[2]])), which(colnames(II_clean_list[[9]]) == "um_u2_axial")],
               II_clean_list[[10]][which.max(abs(II_clean_list[[10]][[2]])), which(colnames(II_clean_list[[10]]) == "um_u2_axial")],
               II_clean_list[[11]][which.max(abs(II_clean_list[[11]][[2]])), which(colnames(II_clean_list[[11]]) == "um_u2_axial")],
               II_clean_list[[12]][which.max(abs(II_clean_list[[12]][[2]])), which(colnames(II_clean_list[[12]]) == "um_u2_axial")],
               II_clean_list[[7]][which.max(abs(II_clean_list[[7]][[2]])), which(colnames(II_clean_list[[7]]) == "um_u7_axial")],
               II_clean_list[[8]][which.max(abs(II_clean_list[[8]][[2]])), which(colnames(II_clean_list[[8]]) == "um_u7_axial")]),
  
  wd_u3_x = c(II_clean_list[[9]][which.max(abs(II_clean_list[[9]][[2]])), which(colnames(II_clean_list[[9]]) == "um_u3_axial")],
               II_clean_list[[10]][which.max(abs(II_clean_list[[10]][[2]])), which(colnames(II_clean_list[[10]]) == "um_u3_axial")],
               II_clean_list[[11]][which.max(abs(II_clean_list[[11]][[2]])), which(colnames(II_clean_list[[11]]) == "um_u3_axial")],
               II_clean_list[[12]][which.max(abs(II_clean_list[[12]][[2]])), which(colnames(II_clean_list[[12]]) == "um_u3_axial")],
               II_clean_list[[7]][which.max(abs(II_clean_list[[7]][[2]])), which(colnames(II_clean_list[[7]]) == "um_u8_axial")],
               II_clean_list[[8]][which.max(abs(II_clean_list[[8]][[2]])), which(colnames(II_clean_list[[8]]) == "um_u8_axial")]),
  
  wd_u4_x = c(II_clean_list[[9]][which.max(abs(II_clean_list[[9]][[2]])), which(colnames(II_clean_list[[9]]) == "um_u4_axial")],
               II_clean_list[[10]][which.max(abs(II_clean_list[[10]][[2]])), which(colnames(II_clean_list[[10]]) == "um_u4_axial")],
               II_clean_list[[11]][which.max(abs(II_clean_list[[11]][[2]])), which(colnames(II_clean_list[[11]]) == "um_u4_axial")],
               II_clean_list[[12]][which.max(abs(II_clean_list[[12]][[2]])), which(colnames(II_clean_list[[12]]) == "um_u4_axial")],
              NA,
              NA),
  
  wd_u5_x = c(II_clean_list[[9]][which.max(abs(II_clean_list[[9]][[2]])), which(colnames(II_clean_list[[9]]) == "um_u5_axial")],
               II_clean_list[[10]][which.max(abs(II_clean_list[[10]][[2]])), which(colnames(II_clean_list[[10]]) == "um_u5_axial")],
               II_clean_list[[11]][which.max(abs(II_clean_list[[11]][[2]])), which(colnames(II_clean_list[[11]]) == "um_u5_axial")],
               II_clean_list[[12]][which.max(abs(II_clean_list[[12]][[2]])), which(colnames(II_clean_list[[12]]) == "um_u5_axial")],
              NA,
              NA),

  wd_u1_y = c(II_clean_list[[9]][which.max(abs(II_clean_list[[9]][[3]])), which(colnames(II_clean_list[[9]]) == "um_u1_abd_add")],
               II_clean_list[[10]][which.max(abs(II_clean_list[[10]][[3]])), which(colnames(II_clean_list[[10]]) == "um_u1_abd_add")],
               II_clean_list[[11]][which.max(abs(II_clean_list[[11]][[3]])), which(colnames(II_clean_list[[11]]) == "um_u1_abd_add")],
               II_clean_list[[12]][which.max(abs(II_clean_list[[12]][[3]])), which(colnames(II_clean_list[[12]]) == "um_u1_abd_add")],
               II_clean_list[[7]][which.max(abs(II_clean_list[[7]][[3]])), which(colnames(II_clean_list[[7]]) == "um_u6_abd_add")],
               II_clean_list[[8]][which.max(abs(II_clean_list[[8]][[3]])), which(colnames(II_clean_list[[8]]) == "um_u6_abd_add")]),
  
  wd_u2_y = c(II_clean_list[[9]][which.max(abs(II_clean_list[[9]][[3]])), which(colnames(II_clean_list[[9]]) == "um_u2_abd_add")],
               II_clean_list[[10]][which.max(abs(II_clean_list[[10]][[3]])), which(colnames(II_clean_list[[10]]) == "um_u2_abd_add")],
               II_clean_list[[11]][which.max(abs(II_clean_list[[11]][[3]])), which(colnames(II_clean_list[[11]]) == "um_u2_abd_add")],
               II_clean_list[[12]][which.max(abs(II_clean_list[[12]][[3]])), which(colnames(II_clean_list[[12]]) == "um_u2_abd_add")],
               II_clean_list[[7]][which.max(abs(II_clean_list[[7]][[3]])), which(colnames(II_clean_list[[7]]) == "um_u7_abd_add")],
               II_clean_list[[8]][which.max(abs(II_clean_list[[8]][[3]])), which(colnames(II_clean_list[[8]]) == "um_u7_abd_add")]),
  
  wd_u3_y = c(II_clean_list[[9]][which.max(abs(II_clean_list[[9]][[3]])), which(colnames(II_clean_list[[9]]) == "um_u3_abd_add")],
               II_clean_list[[10]][which.max(abs(II_clean_list[[10]][[3]])), which(colnames(II_clean_list[[10]]) == "um_u3_abd_add")],
               II_clean_list[[11]][which.max(abs(II_clean_list[[11]][[3]])), which(colnames(II_clean_list[[11]]) == "um_u3_abd_add")],
               II_clean_list[[12]][which.max(abs(II_clean_list[[12]][[3]])), which(colnames(II_clean_list[[12]]) == "um_u3_abd_add")],
               II_clean_list[[7]][which.max(abs(II_clean_list[[7]][[3]])), which(colnames(II_clean_list[[7]]) == "um_u8_abd_add")],
               II_clean_list[[8]][which.max(abs(II_clean_list[[8]][[3]])), which(colnames(II_clean_list[[8]]) == "um_u8_abd_add")]),
  
  wd_u4_y = c(II_clean_list[[9]][which.max(abs(II_clean_list[[9]][[3]])), which(colnames(II_clean_list[[9]]) == "um_u4_abd_add")],
               II_clean_list[[10]][which.max(abs(II_clean_list[[10]][[3]])), which(colnames(II_clean_list[[10]]) == "um_u4_abd_add")],
               II_clean_list[[11]][which.max(abs(II_clean_list[[11]][[3]])), which(colnames(II_clean_list[[11]]) == "um_u4_abd_add")],
               II_clean_list[[12]][which.max(abs(II_clean_list[[12]][[3]])), which(colnames(II_clean_list[[12]]) == "um_u4_abd_add")],
              NA,
              NA),
  
  wd_u5_y = c(II_clean_list[[9]][which.max(abs(II_clean_list[[9]][[3]])), which(colnames(II_clean_list[[9]]) == "um_u5_abd_add")],
               II_clean_list[[10]][which.max(abs(II_clean_list[[10]][[3]])), which(colnames(II_clean_list[[10]]) == "um_u5_abd_add")],
               II_clean_list[[11]][which.max(abs(II_clean_list[[11]][[3]])), which(colnames(II_clean_list[[11]]) == "um_u5_abd_add")],
               II_clean_list[[12]][which.max(abs(II_clean_list[[12]][[3]])), which(colnames(II_clean_list[[12]]) == "um_u5_abd_add")],
              NA,
              NA),
  
  wd_u1_z = c(II_clean_list[[9]][which.max(abs(II_clean_list[[9]][[4]])), which(colnames(II_clean_list[[9]]) == "um_u1_pro_re")],
               II_clean_list[[10]][which.max(abs(II_clean_list[[10]][[4]])), which(colnames(II_clean_list[[10]]) == "um_u1_pro_re")],
               II_clean_list[[11]][which.max(abs(II_clean_list[[11]][[4]])), which(colnames(II_clean_list[[11]]) == "um_u1_pro_re")],
               II_clean_list[[12]][which.max(abs(II_clean_list[[12]][[4]])), which(colnames(II_clean_list[[12]]) == "um_u1_pro_re")],
               II_clean_list[[7]][which.max(abs(II_clean_list[[7]][[4]])), which(colnames(II_clean_list[[7]]) == "um_u6_pro_re")],
               II_clean_list[[8]][which.max(abs(II_clean_list[[8]][[4]])), which(colnames(II_clean_list[[8]]) == "um_u6_pro_re")]),
  
  wd_u2_z = c(II_clean_list[[9]][which.max(abs(II_clean_list[[9]][[4]])), which(colnames(II_clean_list[[9]]) == "um_u2_pro_re")],
               II_clean_list[[10]][which.max(abs(II_clean_list[[10]][[4]])), which(colnames(II_clean_list[[10]]) == "um_u2_pro_re")],
               II_clean_list[[11]][which.max(abs(II_clean_list[[11]][[4]])), which(colnames(II_clean_list[[11]]) == "um_u2_pro_re")],
               II_clean_list[[12]][which.max(abs(II_clean_list[[12]][[4]])), which(colnames(II_clean_list[[12]]) == "um_u2_pro_re")],
               II_clean_list[[7]][which.max(abs(II_clean_list[[7]][[4]])), which(colnames(II_clean_list[[7]]) == "um_u7_pro_re")],
               II_clean_list[[8]][which.max(abs(II_clean_list[[8]][[4]])), which(colnames(II_clean_list[[8]]) == "um_u7_pro_re")]),
  
  wd_u3_z = c(II_clean_list[[9]][which.max(abs(II_clean_list[[9]][[4]])), which(colnames(II_clean_list[[9]]) == "um_u3_pro_re")],
               II_clean_list[[10]][which.max(abs(II_clean_list[[10]][[4]])), which(colnames(II_clean_list[[10]]) == "um_u3_pro_re")],
               II_clean_list[[11]][which.max(abs(II_clean_list[[11]][[4]])), which(colnames(II_clean_list[[11]]) == "um_u3_pro_re")],
               II_clean_list[[12]][which.max(abs(II_clean_list[[12]][[4]])), which(colnames(II_clean_list[[12]]) == "um_u3_pro_re")],
               II_clean_list[[7]][which.max(abs(II_clean_list[[7]][[4]])), which(colnames(II_clean_list[[7]]) == "um_u8_pro_re")],
               II_clean_list[[8]][which.max(abs(II_clean_list[[8]][[4]])), which(colnames(II_clean_list[[8]]) == "um_u8_pro_re")]),
  
  wd_u4_z = c(II_clean_list[[9]][which.max(abs(II_clean_list[[9]][[4]])), which(colnames(II_clean_list[[9]]) == "um_u4_pro_re")],
               II_clean_list[[10]][which.max(abs(II_clean_list[[10]][[4]])), which(colnames(II_clean_list[[10]]) == "um_u4_pro_re")],
               II_clean_list[[11]][which.max(abs(II_clean_list[[11]][[4]])), which(colnames(II_clean_list[[11]]) == "um_u4_pro_re")],
               II_clean_list[[12]][which.max(abs(II_clean_list[[12]][[4]])), which(colnames(II_clean_list[[12]]) == "um_u4_pro_re")],
              NA,
              NA),
  
  wd_u5_z = c(II_clean_list[[9]][which.max(abs(II_clean_list[[9]][[4]])), which(colnames(II_clean_list[[9]]) == "um_u5_pro_re")],
               II_clean_list[[10]][which.max(abs(II_clean_list[[10]][[4]])), which(colnames(II_clean_list[[10]]) == "um_u5_pro_re")],
               II_clean_list[[11]][which.max(abs(II_clean_list[[11]][[4]])), which(colnames(II_clean_list[[11]]) == "um_u5_pro_re")],
               II_clean_list[[12]][which.max(abs(II_clean_list[[12]][[4]])), which(colnames(II_clean_list[[12]]) == "um_u5_pro_re")],
              NA,
              NA),
  
  wod_u1_x = c(II_clean_list[[15]][which.max(abs(II_clean_list[[15]][[2]])), which(colnames(II_clean_list[[15]]) == "um_u1_axial")],
               II_clean_list[[16]][which.max(abs(II_clean_list[[16]][[2]])), which(colnames(II_clean_list[[16]]) == "um_u1_axial")],
               II_clean_list[[17]][which.max(abs(II_clean_list[[17]][[2]])), which(colnames(II_clean_list[[17]]) == "um_u1_axial")],
               II_clean_list[[18]][which.max(abs(II_clean_list[[18]][[2]])), which(colnames(II_clean_list[[18]]) == "um_u1_axial")],
               II_clean_list[[13]][which.max(abs(II_clean_list[[13]][[2]])), which(colnames(II_clean_list[[13]]) == "um_u6_axial")],
               II_clean_list[[14]][which.max(abs(II_clean_list[[14]][[2]])), which(colnames(II_clean_list[[14]]) == "um_u6_axial")]),
  
  wod_u2_x = c(II_clean_list[[15]][which.max(abs(II_clean_list[[15]][[2]])), which(colnames(II_clean_list[[15]]) == "um_u2_axial")],
               II_clean_list[[16]][which.max(abs(II_clean_list[[16]][[2]])), which(colnames(II_clean_list[[16]]) == "um_u2_axial")],
               II_clean_list[[17]][which.max(abs(II_clean_list[[17]][[2]])), which(colnames(II_clean_list[[17]]) == "um_u2_axial")],
               II_clean_list[[18]][which.max(abs(II_clean_list[[18]][[2]])), which(colnames(II_clean_list[[18]]) == "um_u2_axial")],
               II_clean_list[[13]][which.max(abs(II_clean_list[[13]][[2]])), which(colnames(II_clean_list[[13]]) == "um_u7_axial")],
               II_clean_list[[14]][which.max(abs(II_clean_list[[14]][[2]])), which(colnames(II_clean_list[[14]]) == "um_u7_axial")]),
  
  wod_u3_x = c(II_clean_list[[15]][which.max(abs(II_clean_list[[15]][[2]])), which(colnames(II_clean_list[[15]]) == "um_u3_axial")],
               II_clean_list[[16]][which.max(abs(II_clean_list[[16]][[2]])), which(colnames(II_clean_list[[16]]) == "um_u3_axial")],
               II_clean_list[[17]][which.max(abs(II_clean_list[[17]][[2]])), which(colnames(II_clean_list[[17]]) == "um_u3_axial")],
               II_clean_list[[18]][which.max(abs(II_clean_list[[18]][[2]])), which(colnames(II_clean_list[[18]]) == "um_u3_axial")],
               II_clean_list[[13]][which.max(abs(II_clean_list[[13]][[2]])), which(colnames(II_clean_list[[13]]) == "um_u8_axial")],
               II_clean_list[[14]][which.max(abs(II_clean_list[[14]][[2]])), which(colnames(II_clean_list[[14]]) == "um_u8_axial")]),
  
  wod_u4_x = c(II_clean_list[[15]][which.max(abs(II_clean_list[[15]][[2]])), which(colnames(II_clean_list[[15]]) == "um_u4_axial")],
               II_clean_list[[16]][which.max(abs(II_clean_list[[16]][[2]])), which(colnames(II_clean_list[[16]]) == "um_u4_axial")],
               II_clean_list[[17]][which.max(abs(II_clean_list[[17]][[2]])), which(colnames(II_clean_list[[17]]) == "um_u4_axial")],
               II_clean_list[[18]][which.max(abs(II_clean_list[[18]][[2]])), which(colnames(II_clean_list[[18]]) == "um_u4_axial")],
               NA,
               NA),
  
  wod_u5_x = c(II_clean_list[[15]][which.max(abs(II_clean_list[[15]][[2]])), which(colnames(II_clean_list[[15]]) == "um_u5_axial")],
               II_clean_list[[16]][which.max(abs(II_clean_list[[16]][[2]])), which(colnames(II_clean_list[[16]]) == "um_u5_axial")],
               II_clean_list[[17]][which.max(abs(II_clean_list[[17]][[2]])), which(colnames(II_clean_list[[17]]) == "um_u5_axial")],
               II_clean_list[[18]][which.max(abs(II_clean_list[[18]][[2]])), which(colnames(II_clean_list[[18]]) == "um_u5_axial")],
               NA,
               NA),
  
  wod_u1_y = c(II_clean_list[[15]][which.max(abs(II_clean_list[[15]][[3]])), which(colnames(II_clean_list[[15]]) == "um_u1_abd_add")],
               II_clean_list[[16]][which.max(abs(II_clean_list[[16]][[3]])), which(colnames(II_clean_list[[16]]) == "um_u1_abd_add")],
               II_clean_list[[17]][which.max(abs(II_clean_list[[17]][[3]])), which(colnames(II_clean_list[[17]]) == "um_u1_abd_add")],
               II_clean_list[[18]][which.max(abs(II_clean_list[[18]][[3]])), which(colnames(II_clean_list[[18]]) == "um_u1_abd_add")],
               II_clean_list[[13]][which.max(abs(II_clean_list[[13]][[3]])), which(colnames(II_clean_list[[13]]) == "um_u6_abd_add")],
               II_clean_list[[14]][which.max(abs(II_clean_list[[14]][[3]])), which(colnames(II_clean_list[[14]]) == "um_u6_abd_add")]),
  
  wod_u2_y = c(II_clean_list[[15]][which.max(abs(II_clean_list[[15]][[3]])), which(colnames(II_clean_list[[15]]) == "um_u2_abd_add")],
               II_clean_list[[16]][which.max(abs(II_clean_list[[16]][[3]])), which(colnames(II_clean_list[[16]]) == "um_u2_abd_add")],
               II_clean_list[[17]][which.max(abs(II_clean_list[[17]][[3]])), which(colnames(II_clean_list[[17]]) == "um_u2_abd_add")],
               II_clean_list[[18]][which.max(abs(II_clean_list[[18]][[3]])), which(colnames(II_clean_list[[18]]) == "um_u2_abd_add")],
               II_clean_list[[13]][which.max(abs(II_clean_list[[13]][[3]])), which(colnames(II_clean_list[[13]]) == "um_u7_abd_add")],
               II_clean_list[[14]][which.max(abs(II_clean_list[[14]][[3]])), which(colnames(II_clean_list[[14]]) == "um_u7_abd_add")]),
  
  wod_u3_y = c(II_clean_list[[15]][which.max(abs(II_clean_list[[15]][[3]])), which(colnames(II_clean_list[[15]]) == "um_u3_abd_add")],
               II_clean_list[[16]][which.max(abs(II_clean_list[[16]][[3]])), which(colnames(II_clean_list[[16]]) == "um_u3_abd_add")],
               II_clean_list[[17]][which.max(abs(II_clean_list[[17]][[3]])), which(colnames(II_clean_list[[17]]) == "um_u3_abd_add")],
               II_clean_list[[18]][which.max(abs(II_clean_list[[18]][[3]])), which(colnames(II_clean_list[[18]]) == "um_u3_abd_add")],
               II_clean_list[[13]][which.max(abs(II_clean_list[[13]][[3]])), which(colnames(II_clean_list[[13]]) == "um_u8_abd_add")],
               II_clean_list[[14]][which.max(abs(II_clean_list[[14]][[3]])), which(colnames(II_clean_list[[14]]) == "um_u8_abd_add")]),
  
  wod_u4_y = c(II_clean_list[[15]][which.max(abs(II_clean_list[[15]][[3]])), which(colnames(II_clean_list[[15]]) == "um_u4_abd_add")],
               II_clean_list[[16]][which.max(abs(II_clean_list[[16]][[3]])), which(colnames(II_clean_list[[16]]) == "um_u4_abd_add")],
               II_clean_list[[17]][which.max(abs(II_clean_list[[17]][[3]])), which(colnames(II_clean_list[[17]]) == "um_u4_abd_add")],
               II_clean_list[[18]][which.max(abs(II_clean_list[[18]][[3]])), which(colnames(II_clean_list[[18]]) == "um_u4_abd_add")],
               NA,
               NA),
  
  wod_u5_y = c(II_clean_list[[15]][which.max(abs(II_clean_list[[15]][[3]])), which(colnames(II_clean_list[[15]]) == "um_u5_abd_add")],
               II_clean_list[[16]][which.max(abs(II_clean_list[[16]][[3]])), which(colnames(II_clean_list[[16]]) == "um_u5_abd_add")],
               II_clean_list[[17]][which.max(abs(II_clean_list[[17]][[3]])), which(colnames(II_clean_list[[17]]) == "um_u5_abd_add")],
               II_clean_list[[18]][which.max(abs(II_clean_list[[18]][[3]])), which(colnames(II_clean_list[[18]]) == "um_u5_abd_add")],
               NA,
               NA),
  
  wod_u1_z = c(II_clean_list[[15]][which.max(abs(II_clean_list[[15]][[4]])), which(colnames(II_clean_list[[15]]) == "um_u1_pro_re")],
               II_clean_list[[16]][which.max(abs(II_clean_list[[16]][[4]])), which(colnames(II_clean_list[[16]]) == "um_u1_pro_re")],
               II_clean_list[[17]][which.max(abs(II_clean_list[[17]][[4]])), which(colnames(II_clean_list[[17]]) == "um_u1_pro_re")],
               II_clean_list[[18]][which.max(abs(II_clean_list[[18]][[4]])), which(colnames(II_clean_list[[18]]) == "um_u1_pro_re")],
               II_clean_list[[13]][which.max(abs(II_clean_list[[13]][[4]])), which(colnames(II_clean_list[[13]]) == "um_u6_pro_re")],
               II_clean_list[[14]][which.max(abs(II_clean_list[[14]][[4]])), which(colnames(II_clean_list[[14]]) == "um_u6_pro_re")]),
  
  wod_u2_z = c(II_clean_list[[15]][which.max(abs(II_clean_list[[15]][[4]])), which(colnames(II_clean_list[[15]]) == "um_u2_pro_re")],
               II_clean_list[[16]][which.max(abs(II_clean_list[[16]][[4]])), which(colnames(II_clean_list[[16]]) == "um_u2_pro_re")],
               II_clean_list[[17]][which.max(abs(II_clean_list[[17]][[4]])), which(colnames(II_clean_list[[17]]) == "um_u2_pro_re")],
               II_clean_list[[18]][which.max(abs(II_clean_list[[18]][[4]])), which(colnames(II_clean_list[[18]]) == "um_u2_pro_re")],
               II_clean_list[[13]][which.max(abs(II_clean_list[[13]][[4]])), which(colnames(II_clean_list[[13]]) == "um_u7_pro_re")],
               II_clean_list[[14]][which.max(abs(II_clean_list[[14]][[4]])), which(colnames(II_clean_list[[14]]) == "um_u7_pro_re")]),
  
  wod_u3_z = c(II_clean_list[[15]][which.max(abs(II_clean_list[[15]][[4]])), which(colnames(II_clean_list[[15]]) == "um_u3_pro_re")],
               II_clean_list[[16]][which.max(abs(II_clean_list[[16]][[4]])), which(colnames(II_clean_list[[16]]) == "um_u3_pro_re")],
               II_clean_list[[17]][which.max(abs(II_clean_list[[17]][[4]])), which(colnames(II_clean_list[[17]]) == "um_u3_pro_re")],
               II_clean_list[[18]][which.max(abs(II_clean_list[[18]][[4]])), which(colnames(II_clean_list[[18]]) == "um_u3_pro_re")],
               II_clean_list[[13]][which.max(abs(II_clean_list[[13]][[4]])), which(colnames(II_clean_list[[13]]) == "um_u8_pro_re")],
               II_clean_list[[14]][which.max(abs(II_clean_list[[14]][[4]])), which(colnames(II_clean_list[[14]]) == "um_u8_pro_re")]),
  
  wod_u4_z = c(II_clean_list[[15]][which.max(abs(II_clean_list[[15]][[4]])), which(colnames(II_clean_list[[15]]) == "um_u4_pro_re")],
               II_clean_list[[16]][which.max(abs(II_clean_list[[16]][[4]])), which(colnames(II_clean_list[[16]]) == "um_u4_pro_re")],
               II_clean_list[[17]][which.max(abs(II_clean_list[[17]][[4]])), which(colnames(II_clean_list[[17]]) == "um_u4_pro_re")],
               II_clean_list[[18]][which.max(abs(II_clean_list[[18]][[4]])), which(colnames(II_clean_list[[18]]) == "um_u4_pro_re")],
               NA,
               NA),
  
  wod_u5_z = c(II_clean_list[[15]][which.max(abs(II_clean_list[[15]][[4]])), which(colnames(II_clean_list[[15]]) == "um_u5_pro_re")],
               II_clean_list[[16]][which.max(abs(II_clean_list[[16]][[4]])), which(colnames(II_clean_list[[16]]) == "um_u5_pro_re")],
               II_clean_list[[17]][which.max(abs(II_clean_list[[17]][[4]])), which(colnames(II_clean_list[[17]]) == "um_u5_pro_re")],
               II_clean_list[[18]][which.max(abs(II_clean_list[[18]][[4]])), which(colnames(II_clean_list[[18]]) == "um_u5_pro_re")],
               NA,
               NA))

II_bar <- reshape2::melt(II_clean_data, id.var = "jnt")
II_bar <- II_bar %>%
  drop_na()
II_bar <- II_bar %>%
  mutate(oROM = ifelse(str_detect(II_bar[[2]], "max_"), "max",
                       ifelse(str_detect(II_bar[[2]], "wd_"), "wd", "wod"))) %>%
  mutate(xyz = if_else(str_detect(II_bar[[2]], "_x"), "axial_rotation", 
                       if_else(str_detect(II_bar[[2]], "_y"), "abduct_adduct",
                               "pro_retract"))) %>%
  mutate(unit = if_else(str_detect(II_bar[[2]], "_u1_"), "unit 1", 
                        if_else(str_detect(II_bar[[2]], "_u2_"), "unit 2",
                                if_else(str_detect(II_bar[[2]], "_u3_"), "unit 3",
                                        if_else(str_detect(II_bar[[2]], "_u4_"), "unit 4", 
                                                if_else(str_detect(II_bar[[2]], "_u5_"), "unit 5",
                                                        if_else(str_detect(II_bar[[2]], "_u6_"), "unit 6",
                                                                if_else(str_detect(II_bar[[2]], "_u7_"), "unit 7", "unit 8"))))))))

#SC
SC_data <- data.frame(
  jnt = c("VIR11", "VIR13", "VIR15"),
  max_u1_x = c(SC_list[[1]][which.max(abs(SC_list[[1]][[2]])), which(colnames(SC_list[[1]]) == "um_u1_axial")],
               SC_list[[2]][which.max(abs(SC_list[[2]][[2]])), which(colnames(SC_list[[2]]) == "um_u1_axial")],
               SC_list[[3]][which.max(abs(SC_list[[3]][[2]])), which(colnames(SC_list[[3]]) == "um_u1_axial")]),
  
  max_u2_x = c(SC_list[[1]][which.max(abs(SC_list[[1]][[2]])), which(colnames(SC_list[[1]]) == "um_u2_axial")],
               SC_list[[2]][which.max(abs(SC_list[[2]][[2]])), which(colnames(SC_list[[2]]) == "um_u2_axial")],
               SC_list[[3]][which.max(abs(SC_list[[3]][[2]])), which(colnames(SC_list[[3]]) == "um_u2_axial")]),
  
  max_u3_x = c(SC_list[[1]][which.max(abs(SC_list[[1]][[2]])), which(colnames(SC_list[[1]]) == "um_u3_axial")],
               SC_list[[2]][which.max(abs(SC_list[[2]][[2]])), which(colnames(SC_list[[2]]) == "um_u3_axial")],
               SC_list[[3]][which.max(abs(SC_list[[3]][[2]])), which(colnames(SC_list[[3]]) == "um_u3_axial")]),
  
  max_u1_y = c(SC_list[[1]][which.max(abs(SC_list[[1]][[3]])), which(colnames(SC_list[[1]]) == "um_u1_abd_add")],
               SC_list[[2]][which.max(abs(SC_list[[2]][[3]])), which(colnames(SC_list[[2]]) == "um_u1_abd_add")],
               SC_list[[3]][which.max(abs(SC_list[[3]][[3]])), which(colnames(SC_list[[3]]) == "um_u1_abd_add")]),
  
  max_u2_y = c(SC_list[[1]][which.max(abs(SC_list[[1]][[3]])), which(colnames(SC_list[[1]]) == "um_u2_abd_add")],
               SC_list[[2]][which.max(abs(SC_list[[2]][[3]])), which(colnames(SC_list[[2]]) == "um_u2_abd_add")],
               SC_list[[3]][which.max(abs(SC_list[[3]][[3]])), which(colnames(SC_list[[3]]) == "um_u2_abd_add")]),
  
  max_u3_y = c(SC_list[[1]][which.max(abs(SC_list[[1]][[3]])), which(colnames(SC_list[[1]]) == "um_u3_abd_add")],
               SC_list[[2]][which.max(abs(SC_list[[2]][[3]])), which(colnames(SC_list[[2]]) == "um_u3_abd_add")],
               SC_list[[3]][which.max(abs(SC_list[[3]][[3]])), which(colnames(SC_list[[3]]) == "um_u3_abd_add")]),
  
  max_u1_z = c(SC_list[[1]][which.max(abs(SC_list[[1]][[4]])), which(colnames(SC_list[[1]]) == "um_u1_pro_re")],
               SC_list[[2]][which.max(abs(SC_list[[2]][[4]])), which(colnames(SC_list[[2]]) == "um_u1_pro_re")],
               SC_list[[3]][which.max(abs(SC_list[[3]][[4]])), which(colnames(SC_list[[3]]) == "um_u1_pro_re")]),
  
  max_u2_z = c(SC_list[[1]][which.max(abs(SC_list[[1]][[4]])), which(colnames(SC_list[[1]]) == "um_u2_pro_re")],
               SC_list[[2]][which.max(abs(SC_list[[2]][[4]])), which(colnames(SC_list[[2]]) == "um_u2_pro_re")],
               SC_list[[3]][which.max(abs(SC_list[[3]][[4]])), which(colnames(SC_list[[3]]) == "um_u2_pro_re")]),
  
  max_u3_z = c(SC_list[[1]][which.max(abs(SC_list[[1]][[4]])), which(colnames(SC_list[[1]]) == "um_u3_pro_re")],
               SC_list[[2]][which.max(abs(SC_list[[2]][[4]])), which(colnames(SC_list[[2]]) == "um_u3_pro_re")],
               SC_list[[3]][which.max(abs(SC_list[[3]][[4]])), which(colnames(SC_list[[3]]) == "um_u3_pro_re")]),
  
  wd_u1_x = c(SC_list[[4]][which.max(abs(SC_list[[4]][[2]])), which(colnames(SC_list[[4]]) == "um_u1_axial")],
               SC_list[[5]][which.max(abs(SC_list[[5]][[2]])), which(colnames(SC_list[[5]]) == "um_u1_axial")],
               SC_list[[6]][which.max(abs(SC_list[[6]][[2]])), which(colnames(SC_list[[6]]) == "um_u1_axial")]),
  
  wd_u2_x = c(SC_list[[4]][which.max(abs(SC_list[[4]][[2]])), which(colnames(SC_list[[4]]) == "um_u2_axial")],
               SC_list[[5]][which.max(abs(SC_list[[5]][[2]])), which(colnames(SC_list[[5]]) == "um_u2_axial")],
               SC_list[[6]][which.max(abs(SC_list[[6]][[2]])), which(colnames(SC_list[[6]]) == "um_u2_axial")]),
  
  wd_u3_x = c(SC_list[[4]][which.max(abs(SC_list[[4]][[2]])), which(colnames(SC_list[[4]]) == "um_u3_axial")],
               SC_list[[5]][which.max(abs(SC_list[[5]][[2]])), which(colnames(SC_list[[5]]) == "um_u3_axial")],
               SC_list[[6]][which.max(abs(SC_list[[6]][[2]])), which(colnames(SC_list[[6]]) == "um_u3_axial")]),
  
  wd_u1_y = c(SC_list[[4]][which.max(abs(SC_list[[4]][[3]])), which(colnames(SC_list[[4]]) == "um_u1_abd_add")],
               SC_list[[5]][which.max(abs(SC_list[[5]][[3]])), which(colnames(SC_list[[5]]) == "um_u1_abd_add")],
               SC_list[[6]][which.max(abs(SC_list[[6]][[3]])), which(colnames(SC_list[[6]]) == "um_u1_abd_add")]),
  
  wd_u2_y = c(SC_list[[4]][which.max(abs(SC_list[[4]][[3]])), which(colnames(SC_list[[4]]) == "um_u2_abd_add")],
               SC_list[[5]][which.max(abs(SC_list[[5]][[3]])), which(colnames(SC_list[[5]]) == "um_u2_abd_add")],
               SC_list[[6]][which.max(abs(SC_list[[6]][[3]])), which(colnames(SC_list[[6]]) == "um_u2_abd_add")]),
  
  wd_u3_y = c(SC_list[[4]][which.max(abs(SC_list[[4]][[3]])), which(colnames(SC_list[[4]]) == "um_u3_abd_add")],
               SC_list[[5]][which.max(abs(SC_list[[5]][[3]])), which(colnames(SC_list[[5]]) == "um_u3_abd_add")],
               SC_list[[6]][which.max(abs(SC_list[[6]][[3]])), which(colnames(SC_list[[6]]) == "um_u3_abd_add")]),
  
  wd_u1_z = c(SC_list[[4]][which.max(abs(SC_list[[4]][[4]])), which(colnames(SC_list[[4]]) == "um_u1_pro_re")],
               SC_list[[5]][which.max(abs(SC_list[[5]][[4]])), which(colnames(SC_list[[5]]) == "um_u1_pro_re")],
               SC_list[[6]][which.max(abs(SC_list[[6]][[4]])), which(colnames(SC_list[[6]]) == "um_u1_pro_re")]),
  
  wd_u2_z = c(SC_list[[4]][which.max(abs(SC_list[[4]][[4]])), which(colnames(SC_list[[4]]) == "um_u2_pro_re")],
               SC_list[[5]][which.max(abs(SC_list[[5]][[4]])), which(colnames(SC_list[[5]]) == "um_u2_pro_re")],
               SC_list[[6]][which.max(abs(SC_list[[6]][[4]])), which(colnames(SC_list[[6]]) == "um_u2_pro_re")]),
  
  wd_u3_z = c(SC_list[[4]][which.max(abs(SC_list[[4]][[4]])), which(colnames(SC_list[[4]]) == "um_u3_pro_re")],
               SC_list[[5]][which.max(abs(SC_list[[5]][[4]])), which(colnames(SC_list[[5]]) == "um_u3_pro_re")],
               SC_list[[6]][which.max(abs(SC_list[[6]][[4]])), which(colnames(SC_list[[6]]) == "um_u3_pro_re")]),
  
  wod_u1_x = c(SC_list[[7]][which.max(abs(SC_list[[7]][[2]])), which(colnames(SC_list[[7]]) == "um_u1_axial")],
               SC_list[[8]][which.max(abs(SC_list[[8]][[2]])), which(colnames(SC_list[[8]]) == "um_u1_axial")],
               SC_list[[9]][which.max(abs(SC_list[[9]][[2]])), which(colnames(SC_list[[9]]) == "um_u1_axial")]),
  
  wod_u2_x = c(SC_list[[7]][which.max(abs(SC_list[[7]][[2]])), which(colnames(SC_list[[7]]) == "um_u2_axial")],
               SC_list[[8]][which.max(abs(SC_list[[8]][[2]])), which(colnames(SC_list[[8]]) == "um_u2_axial")],
               SC_list[[9]][which.max(abs(SC_list[[9]][[2]])), which(colnames(SC_list[[9]]) == "um_u2_axial")]),
  
  wod_u3_x = c(SC_list[[7]][which.max(abs(SC_list[[7]][[2]])), which(colnames(SC_list[[7]]) == "um_u3_axial")],
               SC_list[[8]][which.max(abs(SC_list[[8]][[2]])), which(colnames(SC_list[[8]]) == "um_u3_axial")],
               SC_list[[9]][which.max(abs(SC_list[[9]][[2]])), which(colnames(SC_list[[9]]) == "um_u3_axial")]),
  
  wod_u1_y = c(SC_list[[7]][which.max(abs(SC_list[[7]][[3]])), which(colnames(SC_list[[7]]) == "um_u1_abd_add")],
               SC_list[[8]][which.max(abs(SC_list[[8]][[3]])), which(colnames(SC_list[[8]]) == "um_u1_abd_add")],
               SC_list[[9]][which.max(abs(SC_list[[9]][[3]])), which(colnames(SC_list[[9]]) == "um_u1_abd_add")]),
  
  wod_u2_y = c(SC_list[[7]][which.max(abs(SC_list[[7]][[3]])), which(colnames(SC_list[[7]]) == "um_u2_abd_add")],
               SC_list[[8]][which.max(abs(SC_list[[8]][[3]])), which(colnames(SC_list[[8]]) == "um_u2_abd_add")],
               SC_list[[9]][which.max(abs(SC_list[[9]][[3]])), which(colnames(SC_list[[9]]) == "um_u2_abd_add")]),
  
  wod_u3_y = c(SC_list[[7]][which.max(abs(SC_list[[7]][[3]])), which(colnames(SC_list[[7]]) == "um_u3_abd_add")],
               SC_list[[8]][which.max(abs(SC_list[[8]][[3]])), which(colnames(SC_list[[8]]) == "um_u3_abd_add")],
               SC_list[[9]][which.max(abs(SC_list[[9]][[3]])), which(colnames(SC_list[[9]]) == "um_u3_abd_add")]),
  
  wod_u1_z = c(SC_list[[7]][which.max(abs(SC_list[[7]][[4]])), which(colnames(SC_list[[7]]) == "um_u1_pro_re")],
               SC_list[[8]][which.max(abs(SC_list[[8]][[4]])), which(colnames(SC_list[[8]]) == "um_u1_pro_re")],
               SC_list[[9]][which.max(abs(SC_list[[9]][[4]])), which(colnames(SC_list[[9]]) == "um_u1_pro_re")]),
  
  wod_u2_z = c(SC_list[[7]][which.max(abs(SC_list[[7]][[4]])), which(colnames(SC_list[[7]]) == "um_u2_pro_re")],
               SC_list[[8]][which.max(abs(SC_list[[8]][[4]])), which(colnames(SC_list[[8]]) == "um_u2_pro_re")],
               SC_list[[9]][which.max(abs(SC_list[[9]][[4]])), which(colnames(SC_list[[9]]) == "um_u2_pro_re")]),
  
  wod_u3_z = c(SC_list[[7]][which.max(abs(SC_list[[7]][[4]])), which(colnames(SC_list[[7]]) == "um_u3_pro_re")],
               SC_list[[8]][which.max(abs(SC_list[[8]][[4]])), which(colnames(SC_list[[8]]) == "um_u3_pro_re")],
               SC_list[[9]][which.max(abs(SC_list[[9]][[4]])), which(colnames(SC_list[[9]]) == "um_u3_pro_re")]))

SC_bar <- reshape2::melt(SC_data, id.var = "jnt")
SC_bar <- SC_bar %>%
  mutate(oROM = ifelse(str_detect(SC_bar[[2]], "max_"), "max",
                       ifelse(str_detect(SC_bar[[2]], "wd_"), "wd", "wod"))) %>%
  mutate(xyz = if_else(str_detect(SC_bar[[2]], "_x"), "axial_rotation", 
                       if_else(str_detect(SC_bar[[2]], "_y"), "abduct_adduct",
                               "pro_retract"))) %>%
  mutate(unit = if_else(str_detect(SC_bar[[2]], "_u1_"), "unit 1", 
                        if_else(str_detect(SC_bar[[2]], "_u2_"), "unit 2", "unit 3")))


#del_VIC
del_VIC_data <- data.frame(
  jnt = c("C13"),
  max_u1_x = c((VIC_list[[1]][which.max(abs(VIC_list[[1]][[2]])), which(colnames(VIC_list[[1]]) == "um_u1_axial")]) + 
                 (VIC_list[[6]][which.max(abs(VIC_list[[6]][[2]])), which(colnames(VIC_list[[6]]) == "um_u1_axial")])),

  max_u2_x = c((VIC_list[[1]][which.max(abs(VIC_list[[1]][[2]])), which(colnames(VIC_list[[1]]) == "um_u2_axial")]) + 
                 (VIC_list[[6]][which.max(abs(VIC_list[[6]][[2]])), which(colnames(VIC_list[[6]]) == "um_u2_axial")])),
  
  max_u3_x = c((VIC_list[[1]][which.max(abs(VIC_list[[1]][[2]])), which(colnames(VIC_list[[1]]) == "um_u3_axial")]) + 
                 (VIC_list[[6]][which.max(abs(VIC_list[[6]][[2]])), which(colnames(VIC_list[[6]]) == "um_u3_axial")])),

  max_u4_x = c((VIC_list[[1]][which.max(abs(VIC_list[[1]][[2]])), which(colnames(VIC_list[[1]]) == "um_u4_axial")]) + 
                 (VIC_list[[6]][which.max(abs(VIC_list[[6]][[2]])), which(colnames(VIC_list[[6]]) == "um_u4_axial")])),

  max_u5_x = c((VIC_list[[1]][which.max(abs(VIC_list[[1]][[2]])), which(colnames(VIC_list[[1]]) == "um_u5_axial")]) + 
                 (VIC_list[[6]][which.max(abs(VIC_list[[6]][[2]])), which(colnames(VIC_list[[6]]) == "um_u5_axial")])),

  max_u1_y = c((VIC_list[[1]][which.max(abs(VIC_list[[1]][[3]])), which(colnames(VIC_list[[1]]) == "um_u1_abd_add")]) + 
                 (VIC_list[[6]][which.max(abs(VIC_list[[6]][[3]])), which(colnames(VIC_list[[6]]) == "um_u1_abd_add")])),
  
  max_u2_y = c((VIC_list[[1]][which.max(abs(VIC_list[[1]][[3]])), which(colnames(VIC_list[[1]]) == "um_u2_abd_add")]) + 
                 (VIC_list[[6]][which.max(abs(VIC_list[[6]][[3]])), which(colnames(VIC_list[[6]]) == "um_u2_abd_add")])),
  
  max_u3_y = c((VIC_list[[1]][which.max(abs(VIC_list[[1]][[3]])), which(colnames(VIC_list[[1]]) == "um_u3_abd_add")]) + 
                 (VIC_list[[6]][which.max(abs(VIC_list[[6]][[3]])), which(colnames(VIC_list[[6]]) == "um_u3_abd_add")])),
  
  max_u4_y = c((VIC_list[[1]][which.max(abs(VIC_list[[1]][[3]])), which(colnames(VIC_list[[1]]) == "um_u4_abd_add")]) + 
                 (VIC_list[[6]][which.max(abs(VIC_list[[6]][[3]])), which(colnames(VIC_list[[6]]) == "um_u4_abd_add")])),
  
  max_u5_y = c((VIC_list[[1]][which.max(abs(VIC_list[[1]][[3]])), which(colnames(VIC_list[[1]]) == "um_u5_abd_add")]) + 
                 (VIC_list[[6]][which.max(abs(VIC_list[[6]][[3]])), which(colnames(VIC_list[[6]]) == "um_u5_abd_add")])),

  max_u1_z = c((VIC_list[[1]][which.max(abs(VIC_list[[1]][[4]])), which(colnames(VIC_list[[1]]) == "um_u1_pro_re")]) + 
                 (VIC_list[[6]][which.max(abs(VIC_list[[6]][[4]])), which(colnames(VIC_list[[6]]) == "um_u1_pro_re")])),
  
  max_u2_z = c((VIC_list[[1]][which.max(abs(VIC_list[[1]][[4]])), which(colnames(VIC_list[[1]]) == "um_u2_pro_re")]) + 
                 (VIC_list[[6]][which.max(abs(VIC_list[[6]][[4]])), which(colnames(VIC_list[[6]]) == "um_u2_pro_re")])),
  
  max_u3_z = c((VIC_list[[1]][which.max(abs(VIC_list[[1]][[4]])), which(colnames(VIC_list[[1]]) == "um_u3_pro_re")]) + 
                 (VIC_list[[6]][which.max(abs(VIC_list[[6]][[4]])), which(colnames(VIC_list[[6]]) == "um_u3_pro_re")])),
  
  max_u4_z = c((VIC_list[[1]][which.max(abs(VIC_list[[1]][[4]])), which(colnames(VIC_list[[1]]) == "um_u4_pro_re")]) + 
                 (VIC_list[[6]][which.max(abs(VIC_list[[6]][[4]])), which(colnames(VIC_list[[6]]) == "um_u4_pro_re")])),
  
  max_u5_z = c((VIC_list[[1]][which.max(abs(VIC_list[[1]][[4]])), which(colnames(VIC_list[[1]]) == "um_u5_pro_re")]) + 
                 (VIC_list[[6]][which.max(abs(VIC_list[[6]][[4]])), which(colnames(VIC_list[[6]]) == "um_u5_pro_re")])),

  wd_u1_x = c((VIC_list[[2]][which.max(abs(VIC_list[[2]][[2]])), which(colnames(VIC_list[[2]]) == "um_u1_axial")]) + 
                (VIC_list[[10]][which.max(abs(VIC_list[[10]][[2]])), which(colnames(VIC_list[[10]]) == "um_u1_axial")])),
  
  wd_u2_x = c((VIC_list[[2]][which.max(abs(VIC_list[[2]][[2]])), which(colnames(VIC_list[[2]]) == "um_u2_axial")]) + 
                (VIC_list[[10]][which.max(abs(VIC_list[[10]][[2]])), which(colnames(VIC_list[[10]]) == "um_u2_axial")])),
  
  wd_u3_x = c((VIC_list[[2]][which.max(abs(VIC_list[[2]][[2]])), which(colnames(VIC_list[[2]]) == "um_u3_axial")]) + 
                (VIC_list[[10]][which.max(abs(VIC_list[[10]][[2]])), which(colnames(VIC_list[[10]]) == "um_u3_axial")])),
  
  wd_u4_x = c((VIC_list[[2]][which.max(abs(VIC_list[[2]][[2]])), which(colnames(VIC_list[[2]]) == "um_u4_axial")]) + 
                (VIC_list[[10]][which.max(abs(VIC_list[[10]][[2]])), which(colnames(VIC_list[[10]]) == "um_u4_axial")])),
  
  wd_u5_x = c((VIC_list[[2]][which.max(abs(VIC_list[[2]][[2]])), which(colnames(VIC_list[[2]]) == "um_u5_axial")]) + 
                (VIC_list[[10]][which.max(abs(VIC_list[[10]][[2]])), which(colnames(VIC_list[[10]]) == "um_u5_axial")])),
  
  wd_u1_y = c((VIC_list[[2]][which.max(abs(VIC_list[[2]][[3]])), which(colnames(VIC_list[[2]]) == "um_u1_abd_add")]) + 
                (VIC_list[[10]][which.max(abs(VIC_list[[10]][[3]])), which(colnames(VIC_list[[10]]) == "um_u1_abd_add")])),
  
  wd_u2_y = c((VIC_list[[2]][which.max(abs(VIC_list[[2]][[3]])), which(colnames(VIC_list[[2]]) == "um_u2_abd_add")]) + 
                (VIC_list[[10]][which.max(abs(VIC_list[[10]][[3]])), which(colnames(VIC_list[[10]]) == "um_u2_abd_add")])),
  
  wd_u3_y = c((VIC_list[[2]][which.max(abs(VIC_list[[2]][[3]])), which(colnames(VIC_list[[2]]) == "um_u3_abd_add")]) + 
                (VIC_list[[10]][which.max(abs(VIC_list[[10]][[3]])), which(colnames(VIC_list[[10]]) == "um_u3_abd_add")])),
  
  wd_u4_y = c((VIC_list[[2]][which.max(abs(VIC_list[[2]][[3]])), which(colnames(VIC_list[[2]]) == "um_u4_abd_add")]) + 
                (VIC_list[[10]][which.max(abs(VIC_list[[10]][[3]])), which(colnames(VIC_list[[10]]) == "um_u4_abd_add")])),
  
  wd_u5_y = c((VIC_list[[2]][which.max(abs(VIC_list[[2]][[3]])), which(colnames(VIC_list[[2]]) == "um_u5_abd_add")]) + 
                (VIC_list[[10]][which.max(abs(VIC_list[[10]][[3]])), which(colnames(VIC_list[[10]]) == "um_u5_abd_add")])),
  
  wd_u1_z = c((VIC_list[[2]][which.max(abs(VIC_list[[2]][[4]])), which(colnames(VIC_list[[2]]) == "um_u1_pro_re")]) + 
                (VIC_list[[10]][which.max(abs(VIC_list[[10]][[4]])), which(colnames(VIC_list[[10]]) == "um_u1_pro_re")])),
  
  wd_u2_z = c((VIC_list[[2]][which.max(abs(VIC_list[[2]][[4]])), which(colnames(VIC_list[[2]]) == "um_u2_pro_re")]) + 
                (VIC_list[[10]][which.max(abs(VIC_list[[10]][[4]])), which(colnames(VIC_list[[10]]) == "um_u2_pro_re")])),
  
  wd_u3_z = c((VIC_list[[2]][which.max(abs(VIC_list[[2]][[4]])), which(colnames(VIC_list[[2]]) == "um_u3_pro_re")]) + 
                (VIC_list[[10]][which.max(abs(VIC_list[[10]][[4]])), which(colnames(VIC_list[[10]]) == "um_u3_pro_re")])),
  
  wd_u4_z = c((VIC_list[[2]][which.max(abs(VIC_list[[2]][[4]])), which(colnames(VIC_list[[2]]) == "um_u4_pro_re")]) + 
                (VIC_list[[10]][which.max(abs(VIC_list[[10]][[4]])), which(colnames(VIC_list[[10]]) == "um_u4_pro_re")])),
  
  wd_u5_z = c((VIC_list[[2]][which.max(abs(VIC_list[[2]][[4]])), which(colnames(VIC_list[[2]]) == "um_u5_pro_re")]) + 
                (VIC_list[[10]][which.max(abs(VIC_list[[10]][[4]])), which(colnames(VIC_list[[10]]) == "um_u5_pro_re")])),

  wod_u1_x = c((VIC_list[[3]][which.max(abs(VIC_list[[3]][[2]])), which(colnames(VIC_list[[3]]) == "um_u1_axial")]) + 
                 (VIC_list[[14]][which.max(abs(VIC_list[[14]][[2]])), which(colnames(VIC_list[[14]]) == "um_u1_axial")])),
  
  wod_u2_x = c((VIC_list[[3]][which.max(abs(VIC_list[[3]][[2]])), which(colnames(VIC_list[[3]]) == "um_u2_axial")]) + 
                 (VIC_list[[14]][which.max(abs(VIC_list[[14]][[2]])), which(colnames(VIC_list[[14]]) == "um_u2_axial")])),
  
  wod_u3_x = c((VIC_list[[3]][which.max(abs(VIC_list[[3]][[2]])), which(colnames(VIC_list[[3]]) == "um_u3_axial")]) + 
                 (VIC_list[[14]][which.max(abs(VIC_list[[14]][[2]])), which(colnames(VIC_list[[14]]) == "um_u3_axial")])),
  
  wod_u4_x = c((VIC_list[[3]][which.max(abs(VIC_list[[3]][[2]])), which(colnames(VIC_list[[3]]) == "um_u4_axial")]) + 
                 (VIC_list[[14]][which.max(abs(VIC_list[[14]][[2]])), which(colnames(VIC_list[[14]]) == "um_u4_axial")])),
  
  wod_u5_x = c((VIC_list[[3]][which.max(abs(VIC_list[[3]][[2]])), which(colnames(VIC_list[[3]]) == "um_u5_axial")]) + 
                 (VIC_list[[14]][which.max(abs(VIC_list[[14]][[2]])), which(colnames(VIC_list[[14]]) == "um_u5_axial")])),
  
  wod_u1_y = c((VIC_list[[3]][which.max(abs(VIC_list[[3]][[3]])), which(colnames(VIC_list[[3]]) == "um_u1_abd_add")]) + 
                 (VIC_list[[14]][which.max(abs(VIC_list[[14]][[3]])), which(colnames(VIC_list[[14]]) == "um_u1_abd_add")])),
  
  wod_u2_y = c((VIC_list[[3]][which.max(abs(VIC_list[[3]][[3]])), which(colnames(VIC_list[[3]]) == "um_u2_abd_add")]) + 
                 (VIC_list[[14]][which.max(abs(VIC_list[[14]][[3]])), which(colnames(VIC_list[[14]]) == "um_u2_abd_add")])),
  
  wod_u3_y = c((VIC_list[[3]][which.max(abs(VIC_list[[3]][[3]])), which(colnames(VIC_list[[3]]) == "um_u3_abd_add")]) + 
                 (VIC_list[[14]][which.max(abs(VIC_list[[14]][[3]])), which(colnames(VIC_list[[14]]) == "um_u3_abd_add")])),
  
  wod_u4_y = c((VIC_list[[3]][which.max(abs(VIC_list[[3]][[3]])), which(colnames(VIC_list[[3]]) == "um_u4_abd_add")]) + 
                 (VIC_list[[14]][which.max(abs(VIC_list[[14]][[3]])), which(colnames(VIC_list[[14]]) == "um_u4_abd_add")])),
  
  wod_u5_y = c((VIC_list[[3]][which.max(abs(VIC_list[[3]][[3]])), which(colnames(VIC_list[[3]]) == "um_u5_abd_add")]) + 
                 (VIC_list[[14]][which.max(abs(VIC_list[[14]][[3]])), which(colnames(VIC_list[[14]]) == "um_u5_abd_add")])),
  
  wod_u1_z = c((VIC_list[[3]][which.max(abs(VIC_list[[3]][[4]])), which(colnames(VIC_list[[3]]) == "um_u1_pro_re")]) + 
                 (VIC_list[[14]][which.max(abs(VIC_list[[14]][[4]])), which(colnames(VIC_list[[14]]) == "um_u1_pro_re")])),
  
  wod_u2_z = c((VIC_list[[3]][which.max(abs(VIC_list[[3]][[4]])), which(colnames(VIC_list[[3]]) == "um_u2_pro_re")]) + 
                 (VIC_list[[14]][which.max(abs(VIC_list[[14]][[4]])), which(colnames(VIC_list[[14]]) == "um_u2_pro_re")])),
  
  wod_u3_z = c((VIC_list[[3]][which.max(abs(VIC_list[[3]][[4]])), which(colnames(VIC_list[[3]]) == "um_u3_pro_re")]) + 
                 (VIC_list[[14]][which.max(abs(VIC_list[[14]][[4]])), which(colnames(VIC_list[[14]]) == "um_u3_pro_re")])),
  
  wod_u4_z = c((VIC_list[[3]][which.max(abs(VIC_list[[3]][[4]])), which(colnames(VIC_list[[3]]) == "um_u4_pro_re")]) + 
                 (VIC_list[[14]][which.max(abs(VIC_list[[14]][[4]])), which(colnames(VIC_list[[14]]) == "um_u4_pro_re")])),
  
  wod_u5_z = c((VIC_list[[3]][which.max(abs(VIC_list[[3]][[4]])), which(colnames(VIC_list[[3]]) == "um_u5_pro_re")]) + 
                 (VIC_list[[14]][which.max(abs(VIC_list[[14]][[4]])), which(colnames(VIC_list[[14]]) == "um_u5_pro_re")])))


del_VIC_bar <- reshape2::melt(del_VIC_data, id.var = "jnt")
del_VIC_bar <- del_VIC_bar %>%
  mutate(oROM = ifelse(str_detect(del_VIC_bar[[2]], "max_"), "max",
                       ifelse(str_detect(del_VIC_bar[[2]], "wd_"), "wd", "wod"))) %>%
  mutate(xyz = if_else(str_detect(del_VIC_bar[[2]], "_x"), "axial_rotation", 
                       if_else(str_detect(del_VIC_bar[[2]], "_y"), "abduct_adduct",
                               "pro_retract"))) %>%
  mutate(unit = if_else(str_detect(del_VIC_bar[[2]], "_u1_"), "unit 1", 
                        if_else(str_detect(del_VIC_bar[[2]], "_u2_"), "unit 2",
                                if_else(str_detect(del_VIC_bar[[2]], "_u3_"), "unit 3",
                                        if_else(str_detect(del_VIC_bar[[2]], "_u4_"), "unit 4", "unit 5"))))) 

#del_IE
del_IE_data <- data.frame(
  jnt = c("C13"),
  max_u1_x = c((IE_list[[6]][which.max(abs(IE_list[[6]][[2]])), which(colnames(IE_list[[6]]) == "um_u1_axial")]) +
                 (IE_list[[1]][which.max(abs(IE_list[[1]][[2]])), which(colnames(IE_list[[1]]) == "um_u1_axial")])),
  
  max_u2_x = c((IE_list[[6]][which.max(abs(IE_list[[6]][[2]])), which(colnames(IE_list[[6]]) == "um_u2_axial")]) +
                 (IE_list[[1]][which.max(abs(IE_list[[1]][[2]])), which(colnames(IE_list[[1]]) == "um_u2_axial")])),

  max_u3_x = c((IE_list[[6]][which.max(abs(IE_list[[6]][[2]])), which(colnames(IE_list[[6]]) == "um_u3_axial")]) +
                 (IE_list[[1]][which.max(abs(IE_list[[1]][[2]])), which(colnames(IE_list[[1]]) == "um_u3_axial")])),
  
  max_u4_x = c((IE_list[[6]][which.max(abs(IE_list[[6]][[2]])), which(colnames(IE_list[[6]]) == "um_u4_axial")]) + 
                 (IE_list[[1]][which.max(abs(IE_list[[1]][[2]])), which(colnames(IE_list[[1]]) == "um_u4_axial")])),
  
  max_u1_y = c((IE_list[[6]][which.max(abs(IE_list[[6]][[3]])), which(colnames(IE_list[[6]]) == "um_u1_abd_add")]) + 
                 (IE_list[[1]][which.max(abs(IE_list[[1]][[3]])), which(colnames(IE_list[[1]]) == "um_u1_abd_add")])),
  
  max_u2_y = c((IE_list[[6]][which.max(abs(IE_list[[6]][[3]])), which(colnames(IE_list[[6]]) == "um_u2_abd_add")]) + 
                 (IE_list[[1]][which.max(abs(IE_list[[1]][[3]])), which(colnames(IE_list[[1]]) == "um_u2_abd_add")])),
  
  max_u3_y = c((IE_list[[6]][which.max(abs(IE_list[[6]][[3]])), which(colnames(IE_list[[6]]) == "um_u3_abd_add")]) + 
                 (IE_list[[1]][which.max(abs(IE_list[[1]][[3]])), which(colnames(IE_list[[1]]) == "um_u3_abd_add")])),
  
  max_u4_y = c((IE_list[[6]][which.max(abs(IE_list[[6]][[3]])), which(colnames(IE_list[[6]]) == "um_u4_abd_add")]) + 
                 (IE_list[[1]][which.max(abs(IE_list[[1]][[3]])), which(colnames(IE_list[[1]]) == "um_u4_abd_add")])),
  
  max_u1_z = c((IE_list[[6]][which.max(abs(IE_list[[6]][[4]])), which(colnames(IE_list[[6]]) == "um_u1_pro_re")]) + 
                 (IE_list[[1]][which.max(abs(IE_list[[1]][[4]])), which(colnames(IE_list[[1]]) == "um_u1_pro_re")])),
  
  max_u2_z = c((IE_list[[6]][which.max(abs(IE_list[[6]][[4]])), which(colnames(IE_list[[6]]) == "um_u2_pro_re")]) + 
                 (IE_list[[1]][which.max(abs(IE_list[[1]][[4]])), which(colnames(IE_list[[1]]) == "um_u2_pro_re")])),
  
  max_u3_z = c((IE_list[[6]][which.max(abs(IE_list[[6]][[4]])), which(colnames(IE_list[[6]]) == "um_u3_pro_re")]) + 
                 (IE_list[[1]][which.max(abs(IE_list[[1]][[4]])), which(colnames(IE_list[[1]]) == "um_u3_pro_re")])),
  
  max_u4_z = c((IE_list[[6]][which.max(abs(IE_list[[6]][[4]])), which(colnames(IE_list[[6]]) == "um_u4_pro_re")]) + 
                 (IE_list[[1]][which.max(abs(IE_list[[1]][[4]])), which(colnames(IE_list[[1]]) == "um_u4_pro_re")])),
  
  wd_u1_x = c((IE_list[[10]][which.max(abs(IE_list[[10]][[2]])), which(colnames(IE_list[[10]]) == "um_u1_axial")]) + 
                (IE_list[[2]][which.max(abs(IE_list[[2]][[2]])), which(colnames(IE_list[[2]]) == "um_u1_axial")])),
  
  wd_u2_x = c((IE_list[[10]][which.max(abs(IE_list[[10]][[2]])), which(colnames(IE_list[[10]]) == "um_u2_axial")]) + 
                (IE_list[[2]][which.max(abs(IE_list[[2]][[2]])), which(colnames(IE_list[[2]]) == "um_u2_axial")])),
  
  wd_u3_x = c((IE_list[[10]][which.max(abs(IE_list[[10]][[2]])), which(colnames(IE_list[[10]]) == "um_u3_axial")]) + 
                (IE_list[[2]][which.max(abs(IE_list[[2]][[2]])), which(colnames(IE_list[[2]]) == "um_u3_axial")])),
  
  wd_u4_x = c((IE_list[[10]][which.max(abs(IE_list[[10]][[2]])), which(colnames(IE_list[[10]]) == "um_u4_axial")]) + 
                (IE_list[[2]][which.max(abs(IE_list[[2]][[2]])), which(colnames(IE_list[[2]]) == "um_u4_axial")])),
  
  wd_u1_y = c((IE_list[[10]][which.max(abs(IE_list[[10]][[3]])), which(colnames(IE_list[[10]]) == "um_u1_abd_add")]) + 
                (IE_list[[2]][which.max(abs(IE_list[[2]][[3]])), which(colnames(IE_list[[2]]) == "um_u1_abd_add")])),
  
  wd_u2_y = c((IE_list[[10]][which.max(abs(IE_list[[10]][[3]])), which(colnames(IE_list[[10]]) == "um_u2_abd_add")]) + 
                (IE_list[[2]][which.max(abs(IE_list[[2]][[3]])), which(colnames(IE_list[[2]]) == "um_u2_abd_add")])),
  
  wd_u3_y = c((IE_list[[10]][which.max(abs(IE_list[[10]][[3]])), which(colnames(IE_list[[10]]) == "um_u3_abd_add")]) + 
                (IE_list[[2]][which.max(abs(IE_list[[2]][[3]])), which(colnames(IE_list[[2]]) == "um_u3_abd_add")])),
  
  wd_u4_y = c((IE_list[[10]][which.max(abs(IE_list[[10]][[3]])), which(colnames(IE_list[[10]]) == "um_u4_abd_add")]) + 
                (IE_list[[2]][which.max(abs(IE_list[[2]][[3]])), which(colnames(IE_list[[2]]) == "um_u4_abd_add")])),
  
  wd_u1_z = c((IE_list[[10]][which.max(abs(IE_list[[10]][[4]])), which(colnames(IE_list[[10]]) == "um_u1_pro_re")]) + 
                (IE_list[[2]][which.max(abs(IE_list[[2]][[4]])), which(colnames(IE_list[[2]]) == "um_u1_pro_re")])),
  
  wd_u2_z = c((IE_list[[10]][which.max(abs(IE_list[[10]][[4]])), which(colnames(IE_list[[10]]) == "um_u2_pro_re")]) + 
                (IE_list[[2]][which.max(abs(IE_list[[2]][[4]])), which(colnames(IE_list[[2]]) == "um_u2_pro_re")])),
  
  wd_u3_z = c((IE_list[[10]][which.max(abs(IE_list[[10]][[4]])), which(colnames(IE_list[[10]]) == "um_u3_pro_re")]) + 
                (IE_list[[2]][which.max(abs(IE_list[[2]][[4]])), which(colnames(IE_list[[2]]) == "um_u3_pro_re")])),
  
  wd_u4_z = c((IE_list[[10]][which.max(abs(IE_list[[10]][[4]])), which(colnames(IE_list[[10]]) == "um_u4_pro_re")]) + 
                (IE_list[[2]][which.max(abs(IE_list[[2]][[4]])), which(colnames(IE_list[[2]]) == "um_u4_pro_re")])),
  
  wod_u1_x = c((IE_list[[14]][which.max(abs(IE_list[[14]][[2]])), which(colnames(IE_list[[14]]) == "um_u1_axial")]) + 
                 (IE_list[[3]][which.max(abs(IE_list[[3]][[2]])), which(colnames(IE_list[[3]]) == "um_u1_axial")])),
  
  wod_u2_x = c((IE_list[[14]][which.max(abs(IE_list[[14]][[2]])), which(colnames(IE_list[[14]]) == "um_u2_axial")]) + 
                 (IE_list[[3]][which.max(abs(IE_list[[3]][[2]])), which(colnames(IE_list[[3]]) == "um_u2_axial")])),
  
  wod_u3_x = c((IE_list[[14]][which.max(abs(IE_list[[14]][[2]])), which(colnames(IE_list[[14]]) == "um_u3_axial")]) + 
                 (IE_list[[3]][which.max(abs(IE_list[[3]][[2]])), which(colnames(IE_list[[3]]) == "um_u3_axial")])),
  
  wod_u4_x = c((IE_list[[14]][which.max(abs(IE_list[[14]][[2]])), which(colnames(IE_list[[14]]) == "um_u4_axial")]) + 
                 (IE_list[[3]][which.max(abs(IE_list[[3]][[2]])), which(colnames(IE_list[[3]]) == "um_u4_axial")])),
  
  wod_u1_y = c((IE_list[[14]][which.max(abs(IE_list[[14]][[3]])), which(colnames(IE_list[[14]]) == "um_u1_abd_add")]) + 
                 (IE_list[[3]][which.max(abs(IE_list[[3]][[3]])), which(colnames(IE_list[[3]]) == "um_u1_abd_add")])),
  
  wod_u2_y = c((IE_list[[14]][which.max(abs(IE_list[[14]][[3]])), which(colnames(IE_list[[14]]) == "um_u2_abd_add")]) + 
                 (IE_list[[3]][which.max(abs(IE_list[[3]][[3]])), which(colnames(IE_list[[3]]) == "um_u2_abd_add")])),
  
  wod_u3_y = c((IE_list[[14]][which.max(abs(IE_list[[14]][[3]])), which(colnames(IE_list[[14]]) == "um_u3_abd_add")]) + 
                 (IE_list[[3]][which.max(abs(IE_list[[3]][[3]])), which(colnames(IE_list[[3]]) == "um_u3_abd_add")])),
  
  wod_u4_y = c((IE_list[[14]][which.max(abs(IE_list[[14]][[3]])), which(colnames(IE_list[[14]]) == "um_u4_abd_add")]) + 
                 (IE_list[[3]][which.max(abs(IE_list[[3]][[3]])), which(colnames(IE_list[[3]]) == "um_u4_abd_add")])),
  
  wod_u1_z = c((IE_list[[14]][which.max(abs(IE_list[[14]][[4]])), which(colnames(IE_list[[14]]) == "um_u1_pro_re")]) + 
                 (IE_list[[3]][which.max(abs(IE_list[[3]][[4]])), which(colnames(IE_list[[3]]) == "um_u1_pro_re")])),
  
  wod_u2_z = c((IE_list[[14]][which.max(abs(IE_list[[14]][[4]])), which(colnames(IE_list[[14]]) == "um_u2_pro_re")]) + 
                 (IE_list[[3]][which.max(abs(IE_list[[3]][[4]])), which(colnames(IE_list[[3]]) == "um_u2_pro_re")])),
  
  wod_u3_z = c((IE_list[[14]][which.max(abs(IE_list[[14]][[4]])), which(colnames(IE_list[[14]]) == "um_u3_pro_re")]) + 
                 (IE_list[[3]][which.max(abs(IE_list[[3]][[4]])), which(colnames(IE_list[[3]]) == "um_u3_pro_re")])),
  
  wod_u4_z = c((IE_list[[14]][which.max(abs(IE_list[[14]][[4]])), which(colnames(IE_list[[14]]) == "um_u4_pro_re")]) + 
                 (IE_list[[3]][which.max(abs(IE_list[[3]][[4]])), which(colnames(IE_list[[3]]) == "um_u4_pro_re")])))

del_IE_bar <- reshape2::melt(del_IE_data, id.var = "jnt")

del_IE_bar <- del_IE_bar %>%
  mutate(oROM = if_else(str_detect(del_IE_bar[[2]], "max_"), "max", "real")) %>%
  mutate(xyz = if_else(str_detect(del_IE_bar[[2]], "_x"), "axial_rotation", 
                       if_else(str_detect(del_IE_bar[[2]], "_y"), "abduct_adduct",
                               "pro_retract"))) %>%
  mutate(unit = if_else(str_detect(del_IE_bar[[2]], "_u1_"), "unit 1", 
                        if_else(str_detect(del_IE_bar[[2]], "_u2_"), "unit 2",
                                if_else(str_detect(del_IE_bar[[2]], "_u3_"), "unit 3", "unit 4"))))

#del_II
del_II_data <- data.frame(
  jnt = c("C13"),
  max_u1_x = c((II_list[[1]][which.max(abs(II_list[[1]][[2]])), which(colnames(II_list[[1]]) == "um_u1_axial")]) + 
                 (II_list[[8]][which.max(abs(II_list[[8]][[2]])), which(colnames(II_list[[8]]) == "um_u1_axial")])),
  
  max_u2_x = c((II_list[[1]][which.max(abs(II_list[[1]][[2]])), which(colnames(II_list[[1]]) == "um_u2_axial")]) + 
                 (II_list[[8]][which.max(abs(II_list[[8]][[2]])), which(colnames(II_list[[8]]) == "um_u2_axial")])),
  
  max_u3_x = c((II_list[[1]][which.max(abs(II_list[[1]][[2]])), which(colnames(II_list[[1]]) == "um_u3_axial")]) + 
                 (II_list[[8]][which.max(abs(II_list[[8]][[2]])), which(colnames(II_list[[8]]) == "um_u3_axial")])),
  
  max_u4_x = c((II_list[[1]][which.max(abs(II_list[[1]][[2]])), which(colnames(II_list[[1]]) == "um_u4_axial")]) + 
                 (II_list[[8]][which.max(abs(II_list[[8]][[2]])), which(colnames(II_list[[8]]) == "um_u4_axial")])),
  
  max_u5_x = c((II_list[[1]][which.max(abs(II_list[[1]][[2]])), which(colnames(II_list[[1]]) == "um_u5_axial")]) + 
                 (II_list[[8]][which.max(abs(II_list[[8]][[2]])), which(colnames(II_list[[8]]) == "um_u5_axial")])),
  
  max_u1_y = c((II_list[[1]][which.max(abs(II_list[[1]][[3]])), which(colnames(II_list[[1]]) == "um_u1_abd_add")]) + 
                 (II_list[[8]][which.max(abs(II_list[[8]][[3]])), which(colnames(II_list[[8]]) == "um_u1_abd_add")])),
  
  max_u2_y = c((II_list[[1]][which.max(abs(II_list[[1]][[3]])), which(colnames(II_list[[1]]) == "um_u2_abd_add")]) + 
                 (II_list[[8]][which.max(abs(II_list[[8]][[3]])), which(colnames(II_list[[8]]) == "um_u2_abd_add")])),
  
  max_u3_y = c((II_list[[1]][which.max(abs(II_list[[1]][[3]])), which(colnames(II_list[[1]]) == "um_u3_abd_add")]) + 
                 (II_list[[8]][which.max(abs(II_list[[8]][[3]])), which(colnames(II_list[[8]]) == "um_u3_abd_add")])),
  
  max_u4_y = c((II_list[[1]][which.max(abs(II_list[[1]][[3]])), which(colnames(II_list[[1]]) == "um_u4_abd_add")]) + 
                 (II_list[[8]][which.max(abs(II_list[[8]][[3]])), which(colnames(II_list[[8]]) == "um_u4_abd_add")])),
  
  max_u5_y = c((II_list[[1]][which.max(abs(II_list[[1]][[3]])), which(colnames(II_list[[1]]) == "um_u5_abd_add")]) + 
                 (II_list[[8]][which.max(abs(II_list[[8]][[3]])), which(colnames(II_list[[8]]) == "um_u5_abd_add")])),
  
  max_u1_z = c((II_list[[1]][which.max(abs(II_list[[1]][[4]])), which(colnames(II_list[[1]]) == "um_u1_pro_re")]) + 
                 (II_list[[8]][which.max(abs(II_list[[8]][[4]])), which(colnames(II_list[[8]]) == "um_u1_pro_re")])),
  
  max_u2_z = c((II_list[[1]][which.max(abs(II_list[[1]][[4]])), which(colnames(II_list[[1]]) == "um_u2_pro_re")]) + 
                 (II_list[[8]][which.max(abs(II_list[[8]][[4]])), which(colnames(II_list[[8]]) == "um_u2_pro_re")])),
  
  max_u3_z = c((II_list[[1]][which.max(abs(II_list[[1]][[4]])), which(colnames(II_list[[1]]) == "um_u3_pro_re")]) + 
                 (II_list[[8]][which.max(abs(II_list[[8]][[4]])), which(colnames(II_list[[8]]) == "um_u3_pro_re")])),
  
  max_u4_z = c((II_list[[1]][which.max(abs(II_list[[1]][[4]])), which(colnames(II_list[[1]]) == "um_u4_pro_re")]) + 
                 (II_list[[8]][which.max(abs(II_list[[8]][[4]])), which(colnames(II_list[[8]]) == "um_u4_pro_re")])),
  
  max_u5_z = c((II_list[[1]][which.max(abs(II_list[[1]][[4]])), which(colnames(II_list[[1]]) == "um_u5_pro_re")]) + 
                 (II_list[[8]][which.max(abs(II_list[[8]][[4]])), which(colnames(II_list[[8]]) == "um_u5_pro_re")])),
  
  wd_u1_x = c((II_list[[2]][which.max(abs(II_list[[2]][[2]])), which(colnames(II_list[[2]]) == "um_u1_axial")]) + 
                (II_list[[14]][which.max(abs(II_list[[14]][[2]])), which(colnames(II_list[[14]]) == "um_u1_axial")])),
  
  wd_u2_x = c((II_list[[2]][which.max(abs(II_list[[2]][[2]])), which(colnames(II_list[[2]]) == "um_u2_axial")]) + 
                (II_list[[14]][which.max(abs(II_list[[14]][[2]])), which(colnames(II_list[[14]]) == "um_u2_axial")])),
  
  wd_u3_x = c((II_list[[2]][which.max(abs(II_list[[2]][[2]])), which(colnames(II_list[[2]]) == "um_u3_axial")]) + 
                (II_list[[14]][which.max(abs(II_list[[14]][[2]])), which(colnames(II_list[[14]]) == "um_u3_axial")])),
  
  wd_u4_x = c((II_list[[2]][which.max(abs(II_list[[2]][[2]])), which(colnames(II_list[[2]]) == "um_u4_axial")]) + 
                (II_list[[14]][which.max(abs(II_list[[14]][[2]])), which(colnames(II_list[[14]]) == "um_u4_axial")])),
  
  wd_u5_x = c((II_list[[2]][which.max(abs(II_list[[2]][[2]])), which(colnames(II_list[[2]]) == "um_u5_axial")]) + 
                (II_list[[14]][which.max(abs(II_list[[14]][[2]])), which(colnames(II_list[[14]]) == "um_u5_axial")])),
  
  wd_u1_y = c((II_list[[2]][which.max(abs(II_list[[2]][[3]])), which(colnames(II_list[[2]]) == "um_u1_abd_add")]) + 
                (II_list[[14]][which.max(abs(II_list[[14]][[3]])), which(colnames(II_list[[14]]) == "um_u1_abd_add")])),
  
  wd_u2_y = c((II_list[[2]][which.max(abs(II_list[[2]][[3]])), which(colnames(II_list[[2]]) == "um_u2_abd_add")]) + 
                (II_list[[14]][which.max(abs(II_list[[14]][[3]])), which(colnames(II_list[[14]]) == "um_u2_abd_add")])),
  
  wd_u3_y = c((II_list[[2]][which.max(abs(II_list[[2]][[3]])), which(colnames(II_list[[2]]) == "um_u3_abd_add")]) + 
                (II_list[[14]][which.max(abs(II_list[[14]][[3]])), which(colnames(II_list[[14]]) == "um_u3_abd_add")])),
  
  wd_u4_y = c((II_list[[2]][which.max(abs(II_list[[2]][[3]])), which(colnames(II_list[[2]]) == "um_u4_abd_add")]) + 
                (II_list[[14]][which.max(abs(II_list[[14]][[3]])), which(colnames(II_list[[14]]) == "um_u4_abd_add")])),
  
  wd_u5_y = c((II_list[[2]][which.max(abs(II_list[[2]][[3]])), which(colnames(II_list[[2]]) == "um_u5_abd_add")]) + 
                (II_list[[14]][which.max(abs(II_list[[14]][[3]])), which(colnames(II_list[[14]]) == "um_u5_abd_add")])),
  
  wd_u1_z = c((II_list[[2]][which.max(abs(II_list[[2]][[4]])), which(colnames(II_list[[2]]) == "um_u1_pro_re")]) + 
                (II_list[[14]][which.max(abs(II_list[[14]][[4]])), which(colnames(II_list[[14]]) == "um_u1_pro_re")])),
  
  wd_u2_z = c((II_list[[2]][which.max(abs(II_list[[2]][[4]])), which(colnames(II_list[[2]]) == "um_u2_pro_re")]) + 
                (II_list[[14]][which.max(abs(II_list[[14]][[4]])), which(colnames(II_list[[14]]) == "um_u2_pro_re")])),
  
  wd_u3_z = c((II_list[[2]][which.max(abs(II_list[[2]][[4]])), which(colnames(II_list[[2]]) == "um_u3_pro_re")]) + 
                (II_list[[14]][which.max(abs(II_list[[14]][[4]])), which(colnames(II_list[[14]]) == "um_u3_pro_re")])),
  
  wd_u4_z = c((II_list[[2]][which.max(abs(II_list[[2]][[4]])), which(colnames(II_list[[2]]) == "um_u4_pro_re")]) + 
                (II_list[[14]][which.max(abs(II_list[[14]][[4]])), which(colnames(II_list[[14]]) == "um_u4_pro_re")])),
  
  wd_u5_z = c((II_list[[2]][which.max(abs(II_list[[2]][[4]])), which(colnames(II_list[[2]]) == "um_u5_pro_re")]) + 
                (II_list[[14]][which.max(abs(II_list[[14]][[4]])), which(colnames(II_list[[14]]) == "um_u5_pro_re")])),
  
  wod_u1_x = c((II_list[[3]][which.max(abs(II_list[[3]][[2]])), which(colnames(II_list[[3]]) == "um_u1_axial")]) + 
                 (II_list[[20]][which.max(abs(II_list[[20]][[2]])), which(colnames(II_list[[20]]) == "um_u1_axial")])),
  
  wod_u2_x = c((II_list[[3]][which.max(abs(II_list[[3]][[2]])), which(colnames(II_list[[3]]) == "um_u2_axial")]) + 
                 (II_list[[20]][which.max(abs(II_list[[20]][[2]])), which(colnames(II_list[[20]]) == "um_u2_axial")])),
  
  wod_u3_x = c((II_list[[3]][which.max(abs(II_list[[3]][[2]])), which(colnames(II_list[[3]]) == "um_u3_axial")]) + 
                 (II_list[[20]][which.max(abs(II_list[[20]][[2]])), which(colnames(II_list[[20]]) == "um_u3_axial")])),
  
  wod_u4_x = c((II_list[[3]][which.max(abs(II_list[[3]][[2]])), which(colnames(II_list[[3]]) == "um_u4_axial")]) + 
                 (II_list[[20]][which.max(abs(II_list[[20]][[2]])), which(colnames(II_list[[20]]) == "um_u4_axial")])),
  
  wod_u5_x = c((II_list[[3]][which.max(abs(II_list[[3]][[2]])), which(colnames(II_list[[3]]) == "um_u5_axial")]) + 
                 (II_list[[20]][which.max(abs(II_list[[20]][[2]])), which(colnames(II_list[[20]]) == "um_u5_axial")])),
  
  wod_u1_y = c((II_list[[3]][which.max(abs(II_list[[3]][[3]])), which(colnames(II_list[[3]]) == "um_u1_abd_add")]) + 
                 (II_list[[20]][which.max(abs(II_list[[20]][[3]])), which(colnames(II_list[[20]]) == "um_u1_abd_add")])),
  
  wod_u2_y = c((II_list[[3]][which.max(abs(II_list[[3]][[3]])), which(colnames(II_list[[3]]) == "um_u2_abd_add")]) + 
                 (II_list[[20]][which.max(abs(II_list[[20]][[3]])), which(colnames(II_list[[20]]) == "um_u2_abd_add")])),
  
  wod_u3_y = c((II_list[[3]][which.max(abs(II_list[[3]][[3]])), which(colnames(II_list[[3]]) == "um_u3_abd_add")]) + 
                 (II_list[[20]][which.max(abs(II_list[[20]][[3]])), which(colnames(II_list[[20]]) == "um_u3_abd_add")])),
  
  wod_u4_y = c((II_list[[3]][which.max(abs(II_list[[3]][[3]])), which(colnames(II_list[[3]]) == "um_u4_abd_add")]) + 
                 (II_list[[20]][which.max(abs(II_list[[20]][[3]])), which(colnames(II_list[[20]]) == "um_u4_abd_add")])),
  
  wod_u5_y = c((II_list[[3]][which.max(abs(II_list[[3]][[3]])), which(colnames(II_list[[3]]) == "um_u5_abd_add")]) + 
                 (II_list[[20]][which.max(abs(II_list[[20]][[3]])), which(colnames(II_list[[20]]) == "um_u5_abd_add")])),
  
  wod_u1_z = c((II_list[[3]][which.max(abs(II_list[[3]][[4]])), which(colnames(II_list[[3]]) == "um_u1_pro_re")]) + 
                 (II_list[[20]][which.max(abs(II_list[[20]][[4]])), which(colnames(II_list[[20]]) == "um_u1_pro_re")])),
  
  wod_u2_z = c((II_list[[3]][which.max(abs(II_list[[3]][[4]])), which(colnames(II_list[[3]]) == "um_u2_pro_re")]) + 
                 (II_list[[20]][which.max(abs(II_list[[20]][[4]])), which(colnames(II_list[[20]]) == "um_u2_pro_re")])),
  
  wod_u3_z = c((II_list[[3]][which.max(abs(II_list[[3]][[4]])), which(colnames(II_list[[3]]) == "um_u3_pro_re")]) + 
                 (II_list[[20]][which.max(abs(II_list[[20]][[4]])), which(colnames(II_list[[20]]) == "um_u3_pro_re")])),
  
  wod_u4_z = c((II_list[[3]][which.max(abs(II_list[[3]][[4]])), which(colnames(II_list[[3]]) == "um_u4_pro_re")]) + 
                 (II_list[[20]][which.max(abs(II_list[[20]][[4]])), which(colnames(II_list[[20]]) == "um_u4_pro_re")])),
  
  wod_u5_z = c((II_list[[3]][which.max(abs(II_list[[3]][[4]])), which(colnames(II_list[[3]]) == "um_u5_pro_re")]) + 
                 (II_list[[20]][which.max(abs(II_list[[20]][[4]])), which(colnames(II_list[[20]]) == "um_u5_pro_re")])))


del_II_bar <- reshape2::melt(del_II_data, id.var = "jnt")
del_II_bar <- del_II_bar %>%
  mutate(oROM = ifelse(str_detect(del_II_bar[[2]], "max_"), "max",
                       ifelse(str_detect(del_II_bar[[2]], "wd_"), "wd", "wod"))) %>%
  mutate(xyz = if_else(str_detect(del_II_bar[[2]], "_x"), "axial_rotation", 
                       if_else(str_detect(del_II_bar[[2]], "_y"), "abduct_adduct",
                               "pro_retract"))) %>%
  mutate(unit = if_else(str_detect(del_II_bar[[2]], "_u1_"), "unit 1", 
                        if_else(str_detect(del_II_bar[[2]], "_u2_"), "unit 2",
                                if_else(str_detect(del_II_bar[[2]], "_u3_"), "unit 3",
                                        if_else(str_detect(del_II_bar[[2]], "_u4_"), "unit 4", "unit 5"))))) 

# create muscle bar list
mus_bar_list <- list(VIC_bar, LC_bar, IE_bar, APC_bar, II_bar, 
                     SC_bar, del_VIC_bar, del_IE_bar, del_II_bar)
names(mus_bar_list) <- c("VIC_bar", "LC_bar", "IE_bar", "APC_bar", "II_bar", 
                         "SC_bar", "del_VIC_bar", "del_IE_bar", "del_II_bar")

# make bar plots
for(i in 1:length(mus_bar_list)){
  max_x <- mus_bar_list[[i]] %>% 
    filter(mus_bar_list[[i]][4] == "max" 
           & mus_bar_list[[i]][5] == "axial_rotation")
  
  wod_x <- mus_bar_list[[i]] %>% 
    filter(mus_bar_list[[i]][4] == "wod" 
           & mus_bar_list[[i]][5] == "axial_rotation")
  
  wd_x <- mus_bar_list[[i]] %>% 
    filter(mus_bar_list[[i]][4] == "wd" 
           & mus_bar_list[[i]][5] == "axial_rotation")
  
  plot_x <- ggplot() +
    geom_bar(data = max_x, 
             aes(x = jnt, y = value, fill = unit), 
             stat = "identity", position = "dodge", alpha = .3) +
    geom_bar(data = wod_x, 
             aes(x = jnt, y = value, fill = unit), 
             stat = "identity", position = "dodge", alpha = .6) +
    geom_bar(data = wd_x, 
             aes(x = jnt, y = value, fill = unit), 
             stat = "identity", position = "dodge", alpha = .8) +
    scale_fill_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689"))  +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    xlab("Costal joints") +
    ylab("Moment arms (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text.y = element_text(size = 10),
          axis.text.x = element_text(size = 10),
          axis.title = element_text(size = 12))
  
  max_y <- mus_bar_list[[i]] %>% 
    filter(mus_bar_list[[i]][4] == "max" 
           & mus_bar_list[[i]][5] == "abduct_adduct")
  wod_y <- mus_bar_list[[i]] %>% 
    filter(mus_bar_list[[i]][4] == "wod" 
           & mus_bar_list[[i]][5] == "abduct_adduct")
  wd_y <- mus_bar_list[[i]] %>% 
    filter(mus_bar_list[[i]][4] == "wd" 
           & mus_bar_list[[i]][5] == "abduct_adduct")
  
  plot_y <- ggplot() +
    geom_bar(data = max_y, 
             aes(x = jnt, y = value, fill = unit), 
             stat = "identity", position = "dodge", alpha = .3) +
    geom_bar(data = wod_y, 
             aes(x = jnt, y = value, fill = unit), 
             stat = "identity", position = "dodge", alpha = .6) +
    geom_bar(data = wd_y, 
             aes(x = jnt, y = value, fill = unit), 
             stat = "identity", position = "dodge", alpha = .8) +
    scale_fill_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    xlab("Costal joints") +
    ylab("Moment arms (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text.y = element_text(size = 10),
          axis.text.x = element_text(size = 10),
          axis.title = element_text(size = 12))
  
  max_z <- mus_bar_list[[i]] %>% 
    filter(mus_bar_list[[i]][4] == "max" 
           & mus_bar_list[[i]][5] == "pro_retract")
  wod_z <- mus_bar_list[[i]] %>% 
    filter(mus_bar_list[[i]][4] == "wod" 
           & mus_bar_list[[i]][5] == "pro_retract")
  wd_z <- mus_bar_list[[i]] %>% 
    filter(mus_bar_list[[i]][4] == "wd" 
           & mus_bar_list[[i]][5] == "pro_retract")
  
  plot_z <- ggplot() +
    geom_bar(data = max_y, 
             aes(x = jnt, y = value, fill = unit), 
             stat = "identity", position = "dodge", alpha = .3) +
    geom_bar(data = wod_y, 
             aes(x = jnt, y = value, fill = unit), 
             stat = "identity", position = "dodge", alpha = .6) +
    geom_bar(data = wd_y, 
             aes(x = jnt, y = value, fill = unit), 
             stat = "identity", position = "dodge", alpha = .8) +
    scale_fill_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8"))  +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    xlab("Costal joints") +
    ylab("Moment arms (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text.y = element_text(size = 10),
          axis.text.x = element_text(size = 10),
          axis.title = element_text(size = 12))
  
  p <- ggarrange(plot_x,
                 plot_y,
                 plot_z,
                 ncol = 1, nrow =3,
                 labels = c("A",
                            "B",
                            "C"),
                 common.legend = TRUE, legend = "bottom")
  
  ggsave(plot = p, dpi = 600, bg = "white", 
         filename = paste0("croc_", names(mus_bar_list[i]), ".png"), 
         device = "png", width = 22, heigh = 28, units = "cm")
}


# create scatter plots for individual muscle
#compute for del_VIC del_IE and del_II
#del_VIC
del_VIC_max <- data.frame(
  VIC_list$MVIC_front_max_lpr13$time,
  (VIC_list$MVIC_max_lpr13) - (VIC_list$MVIC_front_max_lpr13)
) 
del_VIC_max <- subset(del_VIC_max, select = -2)
colnames(del_VIC_max) <- colnames(VIC_list$MVIC_max_lpr13)

del_VIC_wd <- data.frame(
  VIC_list$MVIC_front_wd_lpr13$time,
  (VIC_list$MVIC_wd_lpr13) - (VIC_list$MVIC_front_wd_lpr13)
) 
del_VIC_wd <- subset(del_VIC_wd, select = -2)
colnames(del_VIC_wd) <- colnames(VIC_list$MVIC_wd_lpr13)

del_VIC_wod <- data.frame(
  VIC_list$MVIC_front_wod_lpr13$time,
  (VIC_list$MVIC_wod_lpr13) - (VIC_list$MVIC_front_wod_lpr13)
) 
del_VIC_wod <- subset(del_VIC_wod, select = -2)
colnames(del_VIC_wod) <- colnames(VIC_list$MVIC_wod_lpr13)
del_VIC_point <- list(del_VIC_max, del_VIC_wod, del_VIC_wd)
names(del_VIC_point) <- c("del_VIC_max", "del_VIC_wod", "del_VIC_wd")

#del_IE
del_IE_max <- data.frame(
  IE_list$MIE_back_max_lpr13$time,
  (IE_list$MIE_max_lpr13) + (IE_list$MIE_back_max_lpr13)
) 
del_IE_max <- subset(del_IE_max, select = -2)
colnames(del_IE_max) <- colnames(IE_list$MIE_max_lpr13)

del_IE_wd <- data.frame(
  IE_list$MIE_back_wd_lpr13$time,
  (IE_list$MIE_wd_lpr13) + (IE_list$MIE_back_wd_lpr13)
) 
del_IE_wd <- subset(del_IE_wd, select = -2)
colnames(del_IE_wd) <- colnames(IE_list$MIE_wd_lpr13)

del_IE_wod <- data.frame(
  IE_list$MIE_back_wod_lpr13$time,
  (IE_list$MIE_wod_lpr13) + (IE_list$MIE_back_wod_lpr13)
) 
del_IE_wod <- subset(del_IE_wod, select = -2)
colnames(del_IE_wod) <- colnames(IE_list$MIE_wod_lpr13)
del_IE_point <- list(del_IE_max, del_IE_wod, del_IE_wd)
names(del_IE_point) <- c("del_IE_max", "del_IE_wod", "del_IE_wd")

#del_II
del_II_max <- data.frame(
  II_list$MII_front_max_lpr13$time,
  (II_list$MII_max_lpr13) + (II_list$MII_front_max_lpr13)
) 
del_II_max <- subset(del_II_max, select = -2)
colnames(del_II_max) <- colnames(II_list$MII_max_lpr13)

del_II_wd <- data.frame(
  II_list$MII_front_wd_lpr13$time,
  (II_list$MII_wd_lpr13) + (II_list$MII_front_wd_lpr13)
) 
del_II_wd <- subset(del_II_wd, select = -2)
colnames(del_II_wd) <- colnames(II_list$MII_wd_lpr13)

del_II_wod <- data.frame(
  II_list$MII_front_wod_lpr13$time,
  (II_list$MII_wod_lpr13) + (II_list$MII_front_wod_lpr13)
) 
del_II_wod <- subset(del_II_wod, select = -2)
colnames(del_II_wod) <- colnames(II_list$MII_wod_lpr13)
del_II_point <- list(del_II_max, del_II_wod, del_II_wd)
names(del_II_point) <- c("del_II_max", "del_II_wod", "del_II_wd")

#put point data in a list
mus_point_list <- list(VIC_clean_list, LC_list, IE_clean_list, APC_list, II_clean_list, 
                       SC_list, del_VIC_point, del_IE_point, del_II_point)
names(mus_point_list) <- c("VIC_clean_list", "LC_list", "IE_clean_list", "APC_list", "II_clean_list", 
                           "SC_list", "del_VIC_point", "del_IE_point", "del_II_point")


#plot by muscles, polish is required to make them DRY
#VIC
VIC_very_clean_list <- VIC_clean_list[-c(13:18)]
for(j in seq(from = 1, to = (length(VIC_very_clean_list)/3), by = 1)){
  max_um_temp <- data.frame(VIC_very_clean_list[[j]][c(1, 2:4)],
                            VIC_very_clean_list[[j]][c(8:10)],
                            VIC_very_clean_list[[j]][c(14:16)],
                            VIC_very_clean_list[[j]][c(20:22)],
                            VIC_very_clean_list[[j]][c(26:28)])
  colnames(max_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore",
                             "u5 axial", "u5 abad", "u5 prore")
  max_um_temp$time <- (max_um_temp$time/4)
  
  max_ca_temp <- data.frame(VIC_very_clean_list[[j]][c(1, 5:7)], 
                            VIC_very_clean_list[[j]][c(11:13)],
                            VIC_very_clean_list[[j]][c(17:19)],
                            VIC_very_clean_list[[j]][c(23:25)],
                            VIC_very_clean_list[[j]][c(29:31)])
  colnames(max_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore",
                             "u5 axial", "u5 abad", "u5 prore")
  max_ca_temp$time <- (max_ca_temp$time/4)
  
  wd_um_temp <- data.frame(VIC_very_clean_list[[(j + 4)]][c(1, 2:4)],
                            VIC_very_clean_list[[(j + 4)]][c(8:10)],
                            VIC_very_clean_list[[(j + 4)]][c(14:16)],
                            VIC_very_clean_list[[(j + 4)]][c(20:22)],
                            VIC_very_clean_list[[(j + 4)]][c(26:28)])
  colnames(wd_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore",
                             "u5 axial", "u5 abad", "u5 prore")
  wd_um_temp$time <- (wd_um_temp$time/4)
  
  wd_ca_temp <- data.frame(VIC_very_clean_list[[(j + 4)]][c(1, 5:7)], 
                            VIC_very_clean_list[[(j + 4)]][c(11:13)],
                            VIC_very_clean_list[[(j + 4)]][c(17:19)],
                            VIC_very_clean_list[[(j + 4)]][c(23:25)],
                            VIC_very_clean_list[[(j + 4)]][c(29:31)])
  colnames(wd_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore",
                             "u5 axial", "u5 abad", "u5 prore")
  wd_ca_temp$time <- (wd_ca_temp$time/4)
  
  wod_um_temp <- data.frame(VIC_very_clean_list[[(j + 8)]][c(1, 2:4)],
                            VIC_very_clean_list[[(j + 8)]][c(8:10)],
                            VIC_very_clean_list[[(j + 8)]][c(14:16)],
                            VIC_very_clean_list[[(j + 8)]][c(20:22)],
                            VIC_very_clean_list[[(j + 8)]][c(26:28)])
  colnames(wod_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore",
                             "u5 axial", "u5 abad", "u5 prore")
  wod_um_temp$time <- (wod_um_temp$time/4)
  
  wod_ca_temp <- data.frame(VIC_very_clean_list[[(j + 8)]][c(1, 5:7)], 
                            VIC_very_clean_list[[(j + 8)]][c(11:13)],
                            VIC_very_clean_list[[(j + 8)]][c(17:19)],
                            VIC_very_clean_list[[(j + 8)]][c(23:25)],
                            VIC_very_clean_list[[(j + 8)]][c(29:31)])
  colnames(wod_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore",
                             "u5 axial", "u5 abad", "u5 prore")
  wod_ca_temp$time <- (wod_ca_temp$time/4)
  
  
  max_xyz <- reshape2::melt(data.frame(VIC_clean_data[j, c(1:16)]), id.var = "jnt")
  max_xyz <- max_xyz %>% mutate(axis = if_else(str_detect(max_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(max_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(max_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(max_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(max_xyz[[2]], "_u2_"), "unit 2",
                                 ifelse(str_detect(max_xyz[[2]], "_u3_"), "unit 3",
                                        ifelse(str_detect(max_xyz[[2]], "_u4_"), "unit 4", "unit 5")))))
  
  wd_xyz <- reshape2::melt(data.frame(VIC_clean_data[j, c(1, 17:31)]), id.var = "jnt")
  wd_xyz <- wd_xyz %>% mutate(axis = if_else(str_detect(wd_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(wd_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wd_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(wd_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(wd_xyz[[2]], "_u2_"), "unit 2",
                                 ifelse(str_detect(wd_xyz[[2]], "_u3_"), "unit 3",
                                        ifelse(str_detect(wd_xyz[[2]], "_u4_"), "unit 4", "unit 5")))))
  
  wod_xyz <- reshape2::melt(data.frame(VIC_clean_data[j, c(1, 32:46)]), id.var = "jnt")
  wod_xyz <- wod_xyz %>% mutate(axis = if_else(str_detect(wod_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(wod_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wod_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(wod_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(wod_xyz[[2]], "_u2_"), "unit 2",
                                 ifelse(str_detect(wod_xyz[[2]], "_u3_"), "unit 3",
                                        ifelse(str_detect(wod_xyz[[2]], "_u4_"), "unit 4", "unit 5")))))
  
  x_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  x_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  x_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linetype = "dotdash",linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linetype = "dotdash",linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linetype = "dotdash",linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  
  xyz_bar <- ggplot() +
    geom_bar(data = max_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .3) +
    geom_bar(data = wod_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .6) +
    geom_bar(data = wd_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .8) +
    scale_fill_manual(name = "Muscle action", values = c("#2F139E", "#893101", "#041E42")) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    xlab("Muscle actions") +
    ylab("Moment arms (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text.y = element_text(size = 5),
          axis.text.x = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  p <- ggarrange(x_max, x_wd, x_wod, xyz_bar,
                 y_max, y_wd, y_wod, xyz_bar,
                 z_max, z_wd, z_wod, xyz_bar,
                 ncol = 4, nrow = 3,
                 labels = c("A", "B", "C", "D", 
                            "E", "F", "G", "H", 
                            "I", "K", "L", "M"),
                 common.legend = TRUE, legend = "bottom")
  
  ggsave(plot = p, dpi = 600, bg = "white", 
         filename = paste0("VIC_",  Rib_names[j], ".png"), 
         device = "png", width = 22, heigh = 28, units = "cm")}


#LC
for(j in seq(from = 1, to = (length(LC_list)/3), by = 1)){
  max_um_temp <- data.frame(LC_list[[j]][c(1, 2:4)])
  colnames(max_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore")
  max_um_temp$time <- (max_um_temp$time/4)

  max_ca_temp <- data.frame(LC_list[[j]][c(1, 5:7)])
  colnames(max_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore")
  max_ca_temp$time <- (max_ca_temp$time/4)

  wd_um_temp <- data.frame(LC_list[[(j + 4)]][c(1, 2:4)])
  colnames(wd_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore")
  wd_um_temp$time <- (wd_um_temp$time/4)
  
  wd_ca_temp <- data.frame(LC_list[[(j + 4)]][c(1, 5:7)])
  colnames(wd_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore")
  wd_ca_temp$time <- (wd_ca_temp$time/4)

  wod_um_temp <- data.frame(LC_list[[(j + 8)]][c(1, 2:4)])
  colnames(wod_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore")
  wod_um_temp$time <- (wod_um_temp$time/4)
  
  wod_ca_temp <- data.frame(LC_list[[(j + 8)]][c(1, 5:7)])
  colnames(wod_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore")
  wod_ca_temp$time <- (wod_ca_temp$time/4)
  
  max_xyz <- reshape2::melt(data.frame(LC_data[j, c(1:4)]), id.var = "jnt")
  max_xyz <- max_xyz %>% mutate(axis = if_else(str_detect(max_xyz[[2]], "max_"), "max",
                                               if_else(str_detect(max_xyz[[2]], "wd_"), "wd", "wod"))) %>%
    mutate(xyz = if_else(str_detect(max_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(max_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = "unit 1")


  wd_xyz <- reshape2::melt(data.frame(LC_data[j, c(1, 5:7)]), id.var = "jnt")
  wd_xyz <- wd_xyz %>% mutate(axis = if_else(str_detect(wd_xyz[[2]], "max_"), "max",
                                               if_else(str_detect(wd_xyz[[2]], "wd_"), "wd", "wod"))) %>%
    mutate(xyz = if_else(str_detect(wd_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wd_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = "unit 1")


  wod_xyz <- reshape2::melt(data.frame(LC_data[j, c(1, 8:10)]), id.var = "jnt")
  wod_xyz <- wod_xyz %>% mutate(axis = if_else(str_detect(wod_xyz[[2]], "max_"), "max",
                                               if_else(str_detect(wod_xyz[[2]], "wd_"), "wd", "wod"))) %>%
    mutate(xyz = if_else(str_detect(wod_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wod_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = "unit 1")


  x_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689"))  +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))

  x_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689"))  +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))

  x_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689"))  +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC"))  +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC"))  +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC"))  +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))

  z_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8"))  +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8"))  +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8"))  +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))

  xyz_bar <- ggplot() +
    geom_bar(data = max_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .3) +
    geom_bar(data = wod_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .6) +
    geom_bar(data = wd_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .8) +
    scale_fill_manual(name = "Muscle action", values = c("#2F139E", "#893101", "#041E42")) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    xlab("Muscle actions") +
    ylab("Moment arms (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text.y = element_text(size = 5),
          axis.text.x = element_text(size = 5),
          axis.title = element_text(size = 9))

  p <- ggarrange(x_max, x_wd, x_wod, xyz_bar,
                 y_max, y_wd, y_wod, xyz_bar,
                 z_max, z_wd, z_wod, xyz_bar,
                 ncol = 4, nrow = 3,
                 labels = c("A", "B", "C", "D", 
                            "E", "F", "G", "H", 
                            "I", "K", "L", "M"),
                 common.legend = TRUE, legend = "bottom")
  
  ggsave(plot = p, dpi = 600, bg = "white", 
         filename = paste0("LC_",  Rib_names[j], ".png"), 
         device = "png", width = 22, heigh = 28, units = "cm")}

#IE
IE_very_clean_list <- IE_clean_list[-c(13:21)]
for(j in seq(from = 1, to = (length(IE_very_clean_list)/3), by = 1)){
  max_um_temp <- data.frame(IE_very_clean_list[[j]][c(1, 2:4)],
                            IE_very_clean_list[[j]][c(8:10)],
                            IE_very_clean_list[[j]][c(14:16)],
                            IE_very_clean_list[[j]][c(20:22)])
  colnames(max_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore")
  max_um_temp$time <- (max_um_temp$time/4)
  
  max_ca_temp <- data.frame(IE_very_clean_list[[j]][c(1, 5:7)], 
                            IE_very_clean_list[[j]][c(11:13)],
                            IE_very_clean_list[[j]][c(17:19)],
                            IE_very_clean_list[[j]][c(23:25)])
  colnames(max_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore")
  max_ca_temp$time <- (max_ca_temp$time/4)
  
  wd_um_temp <- data.frame(IE_very_clean_list[[(j + 4)]][c(1, 2:4)],
                           IE_very_clean_list[[(j + 4)]][c(8:10)],
                           IE_very_clean_list[[(j + 4)]][c(14:16)],
                           IE_very_clean_list[[(j + 4)]][c(20:22)])
  colnames(wd_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                            "u2 axial", "u2 abad", "u2 prore",
                            "u3 axial", "u3 abad", "u3 prore",
                            "u4 axial", "u4 abad", "u4 prore")
  wd_um_temp$time <- (wd_um_temp$time/4)
  
  wd_ca_temp <- data.frame(IE_very_clean_list[[(j + 4)]][c(1, 5:7)], 
                           IE_very_clean_list[[(j + 4)]][c(11:13)],
                           IE_very_clean_list[[(j + 4)]][c(17:19)],
                           IE_very_clean_list[[(j + 4)]][c(23:25)])
  colnames(wd_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                            "u2 axial", "u2 abad", "u2 prore",
                            "u3 axial", "u3 abad", "u3 prore",
                            "u4 axial", "u4 abad", "u4 prore")
  wd_ca_temp$time <- (wd_ca_temp$time/4)
  
  wod_um_temp <- data.frame(IE_very_clean_list[[(j + 8)]][c(1, 2:4)],
                            IE_very_clean_list[[(j + 8)]][c(8:10)],
                            IE_very_clean_list[[(j + 8)]][c(14:16)],
                            IE_very_clean_list[[(j + 8)]][c(20:22)])
  colnames(wod_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore")
  wod_um_temp$time <- (wod_um_temp$time/4)
  
  wod_ca_temp <- data.frame(IE_very_clean_list[[(j + 8)]][c(1, 5:7)], 
                            IE_very_clean_list[[(j + 8)]][c(11:13)],
                            IE_very_clean_list[[(j + 8)]][c(17:19)],
                            IE_very_clean_list[[(j + 8)]][c(23:25)])
  colnames(wod_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore")
  wod_ca_temp$time <- (wod_ca_temp$time/4)
  
  
  max_xyz <- reshape2::melt(data.frame(IE_clean_data[j, c(1:13)]), id.var = "jnt")
  max_xyz <- max_xyz %>% mutate(axis = if_else(str_detect(max_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(max_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(max_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(max_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(max_xyz[[2]], "_u2_"), "unit 2",
                                 ifelse(str_detect(max_xyz[[2]], "_u3_"), "unit 3", "unit 4"))))
  
  wd_xyz <- reshape2::melt(data.frame(IE_clean_data[j, c(1, 14:25)]), id.var = "jnt")
  wd_xyz <- wd_xyz %>% mutate(axis = if_else(str_detect(wd_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(wd_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wd_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(wd_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(wd_xyz[[2]], "_u2_"), "unit 2",
                                 ifelse(str_detect(wd_xyz[[2]], "_u3_"), "unit 3","unit 4"))))
  
  wod_xyz <- reshape2::melt(data.frame(IE_clean_data[j, c(1, 26:37)]), id.var = "jnt")
  wod_xyz <- wod_xyz %>% mutate(axis = if_else(str_detect(wod_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(wod_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wod_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(wod_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(wod_xyz[[2]], "_u2_"), "unit 2",
                                 ifelse(str_detect(wod_xyz[[2]], "_u3_"), "unit 3", "unit 4"))))
  
  x_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  x_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  x_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  
  xyz_bar <- ggplot() +
    geom_bar(data = max_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .3) +
    geom_bar(data = wod_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .6) +
    geom_bar(data = wd_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .8) +
    scale_fill_manual(name = "Muscle action", values = c("#2F139E", "#893101", "#041E42")) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    xlab("Muscle actions") +
    ylab("Moment arms (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text.y = element_text(size = 5),
          axis.text.x = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  p <- ggarrange(x_max, x_wd, x_wod, xyz_bar,
                 y_max, y_wd, y_wod, xyz_bar,
                 z_max, z_wd, z_wod, xyz_bar,
                 ncol = 4, nrow = 3,
                 labels = c("A", "B", "C", "D", 
                            "E", "F", "G", "H", 
                            "I", "K", "L", "M"),
                 common.legend = TRUE, legend = "bottom")
  
  ggsave(plot = p, dpi = 600, bg = "white", 
         filename = paste0("IE_",  Rib_names[j], ".png"), 
         device = "png", width = 22, heigh = 28, units = "cm")}

#APC vr
APC_vr_list <- APC_list[c(4:6, 10:12, 16:18)]
for(j in seq(from = 1, to = (length(APC_vr_list)/3), by = 1)){
  max_um_temp <- data.frame(APC_vr_list[[j]][c(1, 2:4)],
                            APC_vr_list[[j]][c(8:10)],
                            APC_vr_list[[j]][c(14:16)])
  colnames(max_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore")
  max_um_temp$time <- (max_um_temp$time/4)
  
  max_ca_temp <- data.frame(APC_vr_list[[j]][c(1, 5:7)], 
                            APC_vr_list[[j]][c(11:13)],
                            APC_vr_list[[j]][c(17:19)])
  colnames(max_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore")
  max_ca_temp$time <- (max_ca_temp$time/4)
  
  wd_um_temp <- data.frame(APC_vr_list[[(j + 3)]][c(1, 2:4)],
                           APC_vr_list[[(j + 3)]][c(8:10)],
                           APC_vr_list[[(j + 3)]][c(14:16)])
  colnames(wd_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                            "u2 axial", "u2 abad", "u2 prore",
                            "u3 axial", "u3 abad", "u3 prore")
  wd_um_temp$time <- (wd_um_temp$time/4)
  
  wd_ca_temp <- data.frame(APC_vr_list[[(j + 3)]][c(1, 5:7)], 
                           APC_vr_list[[(j + 3)]][c(11:13)],
                           APC_vr_list[[(j + 3)]][c(17:19)])
  colnames(wd_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                            "u2 axial", "u2 abad", "u2 prore",
                            "u3 axial", "u3 abad", "u3 prore")
  wd_ca_temp$time <- (wd_ca_temp$time/4)
  
  wod_um_temp <- data.frame(APC_vr_list[[(j + 6)]][c(1, 2:4)],
                            APC_vr_list[[(j + 6)]][c(8:10)],
                            APC_vr_list[[(j + 6)]][c(14:16)])
  colnames(wod_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore")
  wod_um_temp$time <- (wod_um_temp$time/4)
  
  wod_ca_temp <- data.frame(APC_vr_list[[(j + 6)]][c(1, 5:7)], 
                            APC_vr_list[[(j + 6)]][c(11:13)],
                            APC_vr_list[[(j + 6)]][c(17:19)])
  colnames(wod_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore")
  wod_ca_temp$time <- (wod_ca_temp$time/4)
  
  
  max_xyz <- reshape2::melt(data.frame(APC_data[j, c(1:10)]), id.var = "jnt")
  max_xyz <- max_xyz %>% mutate(axis = if_else(str_detect(max_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(max_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(max_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(max_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(max_xyz[[2]], "_u2_"), "unit 2", "unit 3")))
  
  wd_xyz <- reshape2::melt(data.frame(APC_data[j, c(1, 11:19)]), id.var = "jnt")
  wd_xyz <- wd_xyz %>% mutate(axis = if_else(str_detect(wd_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(wd_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wd_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(wd_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(wd_xyz[[2]], "_u2_"), "unit 2", "unit 3")))
  
  wod_xyz <- reshape2::melt(data.frame(APC_data[j, c(1, 20:28)]), id.var = "jnt")
  wod_xyz <- wod_xyz %>% mutate(axis = if_else(str_detect(wod_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(wod_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wod_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(wod_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(wod_xyz[[2]], "_u2_"), "unit 2", "unit 3")))
  
  x_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  x_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  x_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  
  xyz_bar <- ggplot() +
    geom_bar(data = max_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .3) +
    geom_bar(data = wod_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .6) +
    geom_bar(data = wd_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .8) +
    scale_fill_manual(name = "Muscle action", values = c("#2F139E", "#893101", "#041E42")) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    xlab("Muscle actions") +
    ylab("Moment arms (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text.y = element_text(size = 5),
          axis.text.x = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  p <- ggarrange(x_max, x_wd, x_wod, xyz_bar,
                 y_max, y_wd, y_wod, xyz_bar,
                 z_max, z_wd, z_wod, xyz_bar,
                 ncol = 4, nrow = 3,
                 labels = c("A", "B", "C", "D", 
                            "E", "F", "G", "H", 
                            "I", "K", "L", "M"),
                 common.legend = TRUE, legend = "bottom")
  
  ggsave(plot = p, dpi = 600, bg = "white", 
         filename = paste0("APC_vr_",  Rib_names[(j+1)], ".png"), 
         device = "png", width = 22, heigh = 28, units = "cm")}


#APC ir
APC_ir_list <- APC_list[-c(4:6, 10:12, 16:18)]
for(j in seq(from = 1, to = (length(APC_ir_list)/3), by = 1)){
  max_um_temp <- data.frame(APC_ir_list[[j]][c(1, 2:4)],
                            APC_ir_list[[j]][c(8:10)],
                            APC_ir_list[[j]][c(14:16)])
  colnames(max_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore")
  max_um_temp$time <- (max_um_temp$time/4)
  
  max_ca_temp <- data.frame(APC_ir_list[[j]][c(1, 5:7)], 
                            APC_ir_list[[j]][c(11:13)],
                            APC_ir_list[[j]][c(17:19)])
  colnames(max_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore")
  max_ca_temp$time <- (max_ca_temp$time/4)
  
  wd_um_temp <- data.frame(APC_ir_list[[(j + 3)]][c(1, 2:4)],
                           APC_ir_list[[(j + 3)]][c(8:10)],
                           APC_ir_list[[(j + 3)]][c(14:16)])
  colnames(wd_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                            "u2 axial", "u2 abad", "u2 prore",
                            "u3 axial", "u3 abad", "u3 prore")
  wd_um_temp$time <- (wd_um_temp$time/4)
  
  wd_ca_temp <- data.frame(APC_ir_list[[(j + 3)]][c(1, 5:7)], 
                           APC_ir_list[[(j + 3)]][c(11:13)],
                           APC_ir_list[[(j + 3)]][c(17:19)])
  colnames(wd_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                            "u2 axial", "u2 abad", "u2 prore",
                            "u3 axial", "u3 abad", "u3 prore")
  wd_ca_temp$time <- (wd_ca_temp$time/4)
  
  wod_um_temp <- data.frame(APC_ir_list[[(j + 6)]][c(1, 2:4)],
                            APC_ir_list[[(j + 6)]][c(8:10)],
                            APC_ir_list[[(j + 6)]][c(14:16)])
  colnames(wod_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore")
  wod_um_temp$time <- (wod_um_temp$time/4)
  
  wod_ca_temp <- data.frame(APC_ir_list[[(j + 6)]][c(1, 5:7)], 
                            APC_ir_list[[(j + 6)]][c(11:13)],
                            APC_ir_list[[(j + 6)]][c(17:19)])
  colnames(wod_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore")
  wod_ca_temp$time <- (wod_ca_temp$time/4)
  
  
  max_xyz <- reshape2::melt(data.frame(APC_data[(j+3), c(1:10)]), id.var = "jnt")
  max_xyz <- max_xyz %>% mutate(axis = if_else(str_detect(max_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(max_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(max_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(max_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(max_xyz[[2]], "_u2_"), "unit 2", "unit 3")))
  
  wd_xyz <- reshape2::melt(data.frame(APC_data[(j+3), c(1, 11:19)]), id.var = "jnt")
  wd_xyz <- wd_xyz %>% mutate(axis = if_else(str_detect(wd_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(wd_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wd_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(wd_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(wd_xyz[[2]], "_u2_"), "unit 2", "unit 3")))
  
  wod_xyz <- reshape2::melt(data.frame(APC_data[(j+3), c(1, 20:28)]), id.var = "jnt")
  wod_xyz <- wod_xyz %>% mutate(axis = if_else(str_detect(wod_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(wod_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wod_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(wod_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(wod_xyz[[2]], "_u2_"), "unit 2", "unit 3")))
  
  x_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  x_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  x_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  
  xyz_bar <- ggplot() +
    geom_bar(data = max_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .3) +
    geom_bar(data = wod_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .6) +
    geom_bar(data = wd_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .8) +
    scale_fill_manual(name = "Muscle action", values = c("#2F139E", "#893101", "#041E42")) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    xlab("Muscle actions") +
    ylab("Moment arms (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text.y = element_text(size = 5),
          axis.text.x = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  p <- ggarrange(x_max, x_wd, x_wod, xyz_bar,
                 y_max, y_wd, y_wod, xyz_bar,
                 z_max, z_wd, z_wod, xyz_bar,
                 ncol = 4, nrow = 3,
                 labels = c("A", "B", "C", "D", 
                            "E", "F", "G", "H", 
                            "I", "K", "L", "M"),
                 common.legend = TRUE, legend = "bottom")
  
  ggsave(plot = p, dpi = 600, bg = "white", 
         filename = paste0("APC_ir_",  Rib_names[(j+4)], ".png"), 
         device = "png", width = 22, heigh = 28, units = "cm")}

#II vr
II_vr_list <- II_clean_list[c(3:6, 9:12, 15:18)]
for(j in seq(from = 1, to = (length(II_vr_list)/3), by = 1)){
  max_um_temp <- data.frame(II_vr_list[[j]][c(1, 2:4)],
                            II_vr_list[[j]][c(8:10)],
                            II_vr_list[[j]][c(14:16)],
                            II_vr_list[[j]][c(20:22)],
                            II_vr_list[[j]][c(26:28)])
  colnames(max_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore",
                             "u5 axial", "u5 abad", "u5 prore")
  max_um_temp$time <- (max_um_temp$time/4)
  
  max_ca_temp <- data.frame(II_vr_list[[j]][c(1, 5:7)], 
                            II_vr_list[[j]][c(11:13)],
                            II_vr_list[[j]][c(17:19)],
                            II_vr_list[[j]][c(23:25)],
                            II_vr_list[[j]][c(29:31)])
  colnames(max_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore",
                             "u5 axial", "u5 abad", "u5 prore")
  max_ca_temp$time <- (max_ca_temp$time/4)
  
  wd_um_temp <- data.frame(II_vr_list[[(j + 4)]][c(1, 2:4)],
                           II_vr_list[[(j + 4)]][c(8:10)],
                           II_vr_list[[(j + 4)]][c(14:16)],
                           II_vr_list[[(j + 4)]][c(20:22)],
                           II_vr_list[[(j + 4)]][c(26:28)])
  colnames(wd_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                            "u2 axial", "u2 abad", "u2 prore",
                            "u3 axial", "u3 abad", "u3 prore",
                            "u4 axial", "u4 abad", "u4 prore",
                            "u5 axial", "u5 abad", "u5 prore")
  wd_um_temp$time <- (wd_um_temp$time/4)
  
  wd_ca_temp <- data.frame(II_vr_list[[(j + 4)]][c(1, 5:7)], 
                           II_vr_list[[(j + 4)]][c(11:13)],
                           II_vr_list[[(j + 4)]][c(17:19)],
                           II_vr_list[[(j + 4)]][c(23:25)],
                           II_vr_list[[(j + 4)]][c(29:31)])
  colnames(wd_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                            "u2 axial", "u2 abad", "u2 prore",
                            "u3 axial", "u3 abad", "u3 prore",
                            "u4 axial", "u4 abad", "u4 prore",
                            "u5 axial", "u5 abad", "u5 prore")
  wd_ca_temp$time <- (wd_ca_temp$time/4)
  
  wod_um_temp <- data.frame(II_vr_list[[(j + 8)]][c(1, 2:4)],
                            II_vr_list[[(j + 8)]][c(8:10)],
                            II_vr_list[[(j + 8)]][c(14:16)],
                            II_vr_list[[(j + 8)]][c(20:22)],
                            II_vr_list[[(j + 8)]][c(26:28)])
  colnames(wod_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore",
                             "u5 axial", "u5 abad", "u5 prore")
  wod_um_temp$time <- (wod_um_temp$time/4)
  
  wod_ca_temp <- data.frame(II_vr_list[[(j + 8)]][c(1, 5:7)], 
                            II_vr_list[[(j + 8)]][c(11:13)],
                            II_vr_list[[(j + 8)]][c(17:19)],
                            II_vr_list[[(j + 8)]][c(23:25)],
                            II_vr_list[[(j + 8)]][c(29:31)])
  colnames(wod_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore",
                             "u5 axial", "u5 abad", "u5 prore")
  wod_ca_temp$time <- (wod_ca_temp$time/4)
  
  
  max_xyz <- reshape2::melt(data.frame(II_clean_data[j, c(1:16)]), id.var = "jnt")
  max_xyz <- max_xyz %>% mutate(axis = if_else(str_detect(max_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(max_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(max_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(max_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(max_xyz[[2]], "_u2_"), "unit 2",
                                 ifelse(str_detect(max_xyz[[2]], "_u3_"), "unit 3",
                                        ifelse(str_detect(max_xyz[[2]], "_u4_"), "unit 4", "unit 5")))))
  
  wd_xyz <- reshape2::melt(data.frame(II_clean_data[j, c(1, 17:31)]), id.var = "jnt")
  wd_xyz <- wd_xyz %>% mutate(axis = if_else(str_detect(wd_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(wd_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wd_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(wd_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(wd_xyz[[2]], "_u2_"), "unit 2",
                                 ifelse(str_detect(wd_xyz[[2]], "_u3_"), "unit 3",
                                        ifelse(str_detect(wd_xyz[[2]], "_u4_"), "unit 4", "unit 5")))))
  
  wod_xyz <- reshape2::melt(data.frame(II_clean_data[j, c(1, 32:46)]), id.var = "jnt")
  wod_xyz <- wod_xyz %>% mutate(axis = if_else(str_detect(wod_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(wod_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wod_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(wod_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(wod_xyz[[2]], "_u2_"), "unit 2",
                                 ifelse(str_detect(wod_xyz[[2]], "_u3_"), "unit 3",
                                        ifelse(str_detect(wod_xyz[[2]], "_u4_"), "unit 4", "unit 5")))))
  
  x_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  x_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  x_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linetype = "dotdash",linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linetype = "dotdash",linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linetype = "dotdash",linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  
  xyz_bar <- ggplot() +
    geom_bar(data = max_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .3) +
    geom_bar(data = wod_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .6) +
    geom_bar(data = wd_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .8) +
    scale_fill_manual(name = "Muscle action", values = c("#2F139E", "#893101", "#041E42")) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    xlab("Muscle actions") +
    ylab("Moment arms (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text.y = element_text(size = 5),
          axis.text.x = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  p <- ggarrange(x_max, x_wd, x_wod, xyz_bar,
                 y_max, y_wd, y_wod, xyz_bar,
                 z_max, z_wd, z_wod, xyz_bar,
                 ncol = 4, nrow = 3,
                 labels = c("A", "B", "C", "D", 
                            "E", "F", "G", "H", 
                            "I", "K", "L", "M"),
                 common.legend = TRUE, legend = "bottom")
  
  ggsave(plot = p, dpi = 600, bg = "white", 
         filename = paste0("II_vr_",  Rib_names[j], ".png"), 
         device = "png", width = 22, heigh = 28, units = "cm")}

#II ir
II_ir_list <- II_clean_list[-c(3:6, 9:12, 15:18)]
II_ir_data <- II_clean_data %>%
  select_if(~ !any(is.na(.)))
for(j in seq(from = 1, to = (length(II_ir_list)/3), by = 1)){
  max_um_temp <- data.frame(II_ir_list[[j]][c(1, 2:4)],
                            II_ir_list[[j]][c(8:10)],
                            II_ir_list[[j]][c(14:16)])
  colnames(max_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore")
  max_um_temp$time <- (max_um_temp$time/4)
  
  max_ca_temp <- data.frame(II_ir_list[[j]][c(1, 5:7)], 
                            II_ir_list[[j]][c(11:13)],
                            II_ir_list[[j]][c(17:19)])
  colnames(max_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore")
  max_ca_temp$time <- (max_ca_temp$time/4)
  
  wd_um_temp <- data.frame(II_ir_list[[(j + 2)]][c(1, 2:4)],
                           II_ir_list[[(j + 2)]][c(8:10)],
                           II_ir_list[[(j + 2)]][c(14:16)])
  colnames(wd_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                            "u2 axial", "u2 abad", "u2 prore",
                            "u3 axial", "u3 abad", "u3 prore")
  wd_um_temp$time <- (wd_um_temp$time/4)
  
  wd_ca_temp <- data.frame(II_ir_list[[(j + 2)]][c(1, 5:7)], 
                           II_ir_list[[(j + 2)]][c(11:13)],
                           II_ir_list[[(j + 2)]][c(17:19)])
  colnames(wd_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                            "u2 axial", "u2 abad", "u2 prore",
                            "u3 axial", "u3 abad", "u3 prore")
  wd_ca_temp$time <- (wd_ca_temp$time/4)
  
  wod_um_temp <- data.frame(II_ir_list[[(j + 4)]][c(1, 2:4)],
                            II_ir_list[[(j + 4)]][c(8:10)],
                            II_ir_list[[(j + 4)]][c(14:16)])
  colnames(wod_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore")
  wod_um_temp$time <- (wod_um_temp$time/4)
  
  wod_ca_temp <- data.frame(II_ir_list[[(j + 4)]][c(1, 5:7)], 
                            II_ir_list[[(j + 4)]][c(11:13)],
                            II_ir_list[[(j + 4)]][c(17:19)])
  colnames(wod_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore")
  wod_ca_temp$time <- (wod_ca_temp$time/4)
  
  
  max_xyz <- reshape2::melt(data.frame(II_ir_data[(j+4), c(1:10)]), id.var = "jnt")
  max_xyz <- max_xyz %>% mutate(axis = if_else(str_detect(max_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(max_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(max_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(max_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(max_xyz[[2]], "_u2_"), "unit 2", "unit 3")))
  
  wd_xyz <- reshape2::melt(data.frame(II_ir_data[(j+4), c(1, 11:19)]), id.var = "jnt")
  wd_xyz <- wd_xyz %>% mutate(axis = if_else(str_detect(wd_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(wd_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wd_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(wd_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(wd_xyz[[2]], "_u2_"), "unit 2", "unit 3")))
  
  wod_xyz <- reshape2::melt(data.frame(II_ir_data[(j+4), c(1, 20:28)]), id.var = "jnt")
  wod_xyz <- wod_xyz %>% mutate(axis = if_else(str_detect(wod_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(wod_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wod_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(wod_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(wod_xyz[[2]], "_u2_"), "unit 2", "unit 3")))
  
  x_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  x_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  x_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  
  xyz_bar <- ggplot() +
    geom_bar(data = max_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .3) +
    geom_bar(data = wod_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .6) +
    geom_bar(data = wd_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .8) +
    scale_fill_manual(name = "Muscle action", values = c("#2F139E", "#893101", "#041E42")) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    xlab("Muscle actions") +
    ylab("Moment arms (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text.y = element_text(size = 5),
          axis.text.x = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  p <- ggarrange(x_max, x_wd, x_wod, xyz_bar,
                 y_max, y_wd, y_wod, xyz_bar,
                 z_max, z_wd, z_wod, xyz_bar,
                 ncol = 4, nrow = 3,
                 labels = c("A", "B", "C", "D", 
                            "E", "F", "G", "H", 
                            "I", "K", "L", "M"),
                 common.legend = TRUE, legend = "bottom")
  
  ggsave(plot = p, dpi = 600, bg = "white", 
         filename = paste0("II_ir_",  Rib_names[(j+4)], ".png"), 
         device = "png", width = 22, heigh = 28, units = "cm")}


#SC
for(j in seq(from = 1, to = (length(SC_list)/3), by = 1)){
  max_um_temp <- data.frame(SC_list[[j]][c(1, 2:4)],
                            SC_list[[j]][c(8:10)],
                            SC_list[[j]][c(14:16)])
  colnames(max_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore")
  max_um_temp$time <- (max_um_temp$time/4)
  
  max_ca_temp <- data.frame(SC_list[[j]][c(1, 5:7)], 
                            SC_list[[j]][c(11:13)],
                            SC_list[[j]][c(17:19)])
  colnames(max_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore")
  max_ca_temp$time <- (max_ca_temp$time/4)
  
  wd_um_temp <- data.frame(SC_list[[(j + 3)]][c(1, 2:4)],
                           SC_list[[(j + 3)]][c(8:10)],
                           SC_list[[(j + 3)]][c(14:16)])
  colnames(wd_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                            "u2 axial", "u2 abad", "u2 prore",
                            "u3 axial", "u3 abad", "u3 prore")
  wd_um_temp$time <- (wd_um_temp$time/4)
  
  wd_ca_temp <- data.frame(SC_list[[(j + 3)]][c(1, 5:7)], 
                           SC_list[[(j + 3)]][c(11:13)],
                           SC_list[[(j + 3)]][c(17:19)])
  colnames(wd_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                            "u2 axial", "u2 abad", "u2 prore",
                            "u3 axial", "u3 abad", "u3 prore")
  wd_ca_temp$time <- (wd_ca_temp$time/4)
  
  wod_um_temp <- data.frame(SC_list[[(j + 6)]][c(1, 2:4)],
                            SC_list[[(j + 6)]][c(8:10)],
                            SC_list[[(j + 6)]][c(14:16)])
  colnames(wod_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore")
  wod_um_temp$time <- (wod_um_temp$time/4)
  
  wod_ca_temp <- data.frame(SC_list[[(j + 6)]][c(1, 5:7)], 
                            SC_list[[(j + 6)]][c(11:13)],
                            SC_list[[(j + 6)]][c(17:19)])
  colnames(wod_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore")
  wod_ca_temp$time <- (wod_ca_temp$time/4)
  
  
  max_xyz <- reshape2::melt(data.frame(SC_data[j, c(1:10)]), id.var = "jnt")
  max_xyz <- max_xyz %>% mutate(axis = if_else(str_detect(max_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(max_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(max_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(max_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(max_xyz[[2]], "_u2_"), "unit 2", "unit 3")))
  
  wd_xyz <- reshape2::melt(data.frame(SC_data[j, c(1, 11:19)]), id.var = "jnt")
  wd_xyz <- wd_xyz %>% mutate(axis = if_else(str_detect(wd_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(wd_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wd_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(wd_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(wd_xyz[[2]], "_u2_"), "unit 2", "unit 3")))
  
  wod_xyz <- reshape2::melt(data.frame(SC_data[j, c(1, 20:28)]), id.var = "jnt")
  wod_xyz <- wod_xyz %>% mutate(axis = if_else(str_detect(wod_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(wod_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wod_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(wod_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(wod_xyz[[2]], "_u2_"), "unit 2", "unit 3")))
  
  x_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  x_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  x_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  
  xyz_bar <- ggplot() +
    geom_bar(data = max_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .3) +
    geom_bar(data = wod_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .6) +
    geom_bar(data = wd_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .8) +
    scale_fill_manual(name = "Muscle action", values = c("#2F139E", "#893101", "#041E42")) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    xlab("Muscle actions") +
    ylab("Moment arms (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text.y = element_text(size = 5),
          axis.text.x = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  p <- ggarrange(x_max, x_wd, x_wod, xyz_bar,
                 y_max, y_wd, y_wod, xyz_bar,
                 z_max, z_wd, z_wod, xyz_bar,
                 ncol = 4, nrow = 3,
                 labels = c("A", "B", "C", "D", 
                            "E", "F", "G", "H", 
                            "I", "K", "L", "M"),
                 common.legend = TRUE, legend = "bottom")
  
  ggsave(plot = p, dpi = 600, bg = "white", 
         filename = paste0("SC_",  Rib_names[(j+7)], ".png"), 
         device = "png", width = 22, heigh = 28, units = "cm")}

#del_VIC
for(j in seq(from = 1, to = (length(del_VIC_point)*0.5), by = 1)){
  max_um_temp <- data.frame(del_VIC_point[[j]][c(1, 2:4)],
                            del_VIC_point[[j]][c(8:10)],
                            del_VIC_point[[j]][c(14:16)],
                            del_VIC_point[[j]][c(20:22)],
                            del_VIC_point[[j]][c(26:28)])
  colnames(max_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore",
                             "u5 axial", "u5 abad", "u5 prore")
  max_um_temp$time <- (max_um_temp$time/4)
  
  max_ca_temp <- data.frame(del_VIC_point[[j]][c(1, 5:7)], 
                            del_VIC_point[[j]][c(11:13)],
                            del_VIC_point[[j]][c(17:19)],
                            del_VIC_point[[j]][c(23:25)],
                            del_VIC_point[[j]][c(29:31)])
  colnames(max_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore",
                             "u5 axial", "u5 abad", "u5 prore")
  max_ca_temp$time <- (max_ca_temp$time/4)
  
  wd_um_temp <- data.frame(del_VIC_point[[(j+2)]][c(1, 2:4)],
                            del_VIC_point[[(j+2)]][c(8:10)],
                            del_VIC_point[[(j+2)]][c(14:16)],
                            del_VIC_point[[(j+2)]][c(20:22)],
                            del_VIC_point[[(j+2)]][c(26:28)])
  colnames(wd_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore",
                             "u5 axial", "u5 abad", "u5 prore")
  wd_um_temp$time <- (wd_um_temp$time/4)
  
  wd_ca_temp <- data.frame(del_VIC_point[[(j+2)]][c(1, 5:7)], 
                            del_VIC_point[[(j+2)]][c(11:13)],
                            del_VIC_point[[(j+2)]][c(17:19)],
                            del_VIC_point[[(j+2)]][c(23:25)],
                            del_VIC_point[[(j+2)]][c(29:31)])
  colnames(wd_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore",
                             "u5 axial", "u5 abad", "u5 prore")
  wd_ca_temp$time <- (wd_ca_temp$time/4)
  
  wod_um_temp <- data.frame(del_VIC_point[[(j+1)]][c(1, 2:4)],
                            del_VIC_point[[(j+1)]][c(8:10)],
                            del_VIC_point[[(j+1)]][c(14:16)],
                            del_VIC_point[[(j+1)]][c(20:22)],
                            del_VIC_point[[(j+1)]][c(26:28)])
  colnames(wod_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore",
                             "u5 axial", "u5 abad", "u5 prore")
  wod_um_temp$time <- (wod_um_temp$time/4)
  wod_ca_temp <- data.frame(del_VIC_point[[(j+1)]][c(1, 5:7)], 
                            del_VIC_point[[(j+1)]][c(11:13)],
                            del_VIC_point[[(j+1)]][c(17:19)],
                            del_VIC_point[[(j+1)]][c(23:25)],
                            del_VIC_point[[(j+1)]][c(29:31)])
  colnames(wod_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore",
                             "u5 axial", "u5 abad", "u5 prore")
  wod_ca_temp$time <- (wod_ca_temp$time/4)


  max_xyz <- reshape2::melt(data.frame(del_VIC_data[j, c(1:16)]), id.var = "jnt")
  max_xyz <- max_xyz %>% mutate(axis = if_else(str_detect(max_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(max_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(max_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(max_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(max_xyz[[2]], "_u2_"), "unit 2",
                                 ifelse(str_detect(max_xyz[[2]], "_u3_"), "unit 3",
                                        ifelse(str_detect(max_xyz[[2]], "_u4_"), "unit 4", "unit 5")))))
  
  
  wd_xyz <- reshape2::melt(data.frame(del_VIC_data[j, c(1, 17:31)]), id.var = "jnt")
  wd_xyz <- wd_xyz %>% mutate(axis = if_else(str_detect(wd_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(wd_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wd_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(wd_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(wd_xyz[[2]], "_u2_"), "unit 2",
                                 ifelse(str_detect(wd_xyz[[2]], "_u3_"), "unit 3",
                                        ifelse(str_detect(wd_xyz[[2]], "_u4_"), "unit 4", "unit 5")))))
  
  wod_xyz <- reshape2::melt(data.frame(del_VIC_data[j, c(1, 32:46)]), id.var = "jnt")
  wod_xyz <- wod_xyz %>% mutate(axis = if_else(str_detect(wod_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(wod_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wod_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(wod_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(wod_xyz[[2]], "_u2_"), "unit 2",
                                 ifelse(str_detect(wod_xyz[[2]], "_u3_"), "unit 3",
                                        ifelse(str_detect(wod_xyz[[2]], "_u4_"), "unit 4", "unit 5")))))
  x_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  x_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  x_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linetype = "dotdash",linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linetype = "dotdash",linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linetype = "dotdash",linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  
  xyz_bar <- ggplot() +
    geom_bar(data = max_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .3) +
    geom_bar(data = wod_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .6) +
    geom_bar(data = wd_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .8) +
    scale_fill_manual(name = "Muscle action", values = c("#2F139E", "#893101", "#041E42")) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    xlab("Muscle actions") +
    ylab("Moment arms (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text.y = element_text(size = 5),
          axis.text.x = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  p <- ggarrange(x_max, x_wd, x_wod, xyz_bar,
                 y_max, y_wd, y_wod, xyz_bar,
                 z_max, z_wd, z_wod, xyz_bar,
                 ncol = 4, nrow = 3,
                 labels = c("A", "B", "C", "D", 
                            "E", "F", "G", "H", 
                            "I", "K", "L", "M"),
                 common.legend = TRUE, legend = "bottom")
  
  ggsave(plot = p, dpi = 600, bg = "white", 
         filename = paste0("del_VIC_",  Rib_names[(j+2)], ".png"), 
         device = "png", width = 22, heigh = 28, units = "cm")}
  

#del_IE
for(j in seq(from = 1, to = (length(del_IE_point)*0.5), by = 1)){
  max_um_temp <- data.frame(del_IE_point[[j]][c(1, 2:4)],
                            del_IE_point[[j]][c(8:10)],
                            del_IE_point[[j]][c(14:16)],
                            del_IE_point[[j]][c(20:22)])
  colnames(max_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore")
  max_um_temp$time <- (max_um_temp$time/4)
  
  max_ca_temp <- data.frame(del_IE_point[[j]][c(1, 5:7)], 
                            del_IE_point[[j]][c(11:13)],
                            del_IE_point[[j]][c(17:19)],
                            del_IE_point[[j]][c(23:25)])
  colnames(max_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore")
  max_ca_temp$time <- (max_ca_temp$time/4)
  
  wd_um_temp <- data.frame(del_IE_point[[(j+2)]][c(1, 2:4)],
                           del_IE_point[[(j+2)]][c(8:10)],
                           del_IE_point[[(j+2)]][c(14:16)],
                           del_IE_point[[(j+2)]][c(20:22)])
  colnames(wd_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                            "u2 axial", "u2 abad", "u2 prore",
                            "u3 axial", "u3 abad", "u3 prore",
                            "u4 axial", "u4 abad", "u4 prore")
  wd_um_temp$time <- (wd_um_temp$time/4)
  
  wd_ca_temp <- data.frame(del_IE_point[[(j+2)]][c(1, 5:7)], 
                           del_IE_point[[(j+2)]][c(11:13)],
                           del_IE_point[[(j+2)]][c(17:19)],
                           del_IE_point[[(j+2)]][c(23:25)])
  colnames(wd_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                            "u2 axial", "u2 abad", "u2 prore",
                            "u3 axial", "u3 abad", "u3 prore",
                            "u4 axial", "u4 abad", "u4 prore")
  wd_ca_temp$time <- (wd_ca_temp$time/4)
  
  wod_um_temp <- data.frame(del_IE_point[[(j+1)]][c(1, 2:4)],
                            del_IE_point[[(j+1)]][c(8:10)],
                            del_IE_point[[(j+1)]][c(14:16)],
                            del_IE_point[[(j+1)]][c(20:22)])
  colnames(wod_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore")
  wod_um_temp$time <- (wod_um_temp$time/4)
  wod_ca_temp <- data.frame(del_IE_point[[(j+1)]][c(1, 5:7)], 
                            del_IE_point[[(j+1)]][c(11:13)],
                            del_IE_point[[(j+1)]][c(17:19)],
                            del_IE_point[[(j+1)]][c(23:25)])
  colnames(wod_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore")
  wod_ca_temp$time <- (wod_ca_temp$time/4)
  
  
  max_xyz <- reshape2::melt(data.frame(del_IE_data[j, c(1:13)]), id.var = "jnt")
  max_xyz <- max_xyz %>% mutate(axis = if_else(str_detect(max_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(max_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(max_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(max_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(max_xyz[[2]], "_u2_"), "unit 2",
                                 ifelse(str_detect(max_xyz[[2]], "_u3_"), "unit 3", "unit 4"))))
  
  
  wd_xyz <- reshape2::melt(data.frame(del_IE_data[j, c(1, 14:25)]), id.var = "jnt")
  wd_xyz <- wd_xyz %>% mutate(axis = if_else(str_detect(wd_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(wd_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wd_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(wd_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(wd_xyz[[2]], "_u2_"), "unit 2",
                                 ifelse(str_detect(wd_xyz[[2]], "_u3_"), "unit 3", "unit 4"))))
  
  wod_xyz <- reshape2::melt(data.frame(del_IE_data[j, c(1, 26:37)]), id.var = "jnt")
  wod_xyz <- wod_xyz %>% mutate(axis = if_else(str_detect(wod_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(wod_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wod_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(wod_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(wod_xyz[[2]], "_u2_"), "unit 2",
                                 ifelse(str_detect(wod_xyz[[2]], "_u3_"), "unit 3", "unit 4"))))
  x_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  x_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  x_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  
  xyz_bar <- ggplot() +
    geom_bar(data = max_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .3) +
    geom_bar(data = wod_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .6) +
    geom_bar(data = wd_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .8) +
    scale_fill_manual(name = "Muscle action", values = c("#2F139E", "#893101", "#041E42")) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    xlab("Muscle actions") +
    ylab("Moment arms (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text.y = element_text(size = 5),
          axis.text.x = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  p <- ggarrange(x_max, x_wd, x_wod, xyz_bar,
                 y_max, y_wd, y_wod, xyz_bar,
                 z_max, z_wd, z_wod, xyz_bar,
                 ncol = 4, nrow = 3,
                 labels = c("A", "B", "C", "D", 
                            "E", "F", "G", "H", 
                            "I", "K", "L", "M"),
                 common.legend = TRUE, legend = "bottom")
  
  ggsave(plot = p, dpi = 600, bg = "white", 
         filename = paste0("del_IE_",  Rib_names[(j+2)], ".png"), 
         device = "png", width = 22, heigh = 28, units = "cm")}
#del_II
for(j in seq(from = 1, to = (length(del_II_point)*0.5), by = 1)){
  max_um_temp <- data.frame(del_II_point[[j]][c(1, 2:4)],
                            del_II_point[[j]][c(8:10)],
                            del_II_point[[j]][c(14:16)],
                            del_II_point[[j]][c(20:22)],
                            del_II_point[[j]][c(26:28)])
  colnames(max_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore",
                             "u5 axial", "u5 abad", "u5 prore")
  max_um_temp$time <- (max_um_temp$time/4)
  
  max_ca_temp <- data.frame(del_II_point[[j]][c(1, 5:7)], 
                            del_II_point[[j]][c(11:13)],
                            del_II_point[[j]][c(17:19)],
                            del_II_point[[j]][c(23:25)],
                            del_II_point[[j]][c(29:31)])
  colnames(max_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore",
                             "u5 axial", "u5 abad", "u5 prore")
  max_ca_temp$time <- (max_ca_temp$time/4)
  
  wd_um_temp <- data.frame(del_II_point[[(j+2)]][c(1, 2:4)],
                           del_II_point[[(j+2)]][c(8:10)],
                           del_II_point[[(j+2)]][c(14:16)],
                           del_II_point[[(j+2)]][c(20:22)],
                           del_II_point[[(j+2)]][c(26:28)])
  colnames(wd_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                            "u2 axial", "u2 abad", "u2 prore",
                            "u3 axial", "u3 abad", "u3 prore",
                            "u4 axial", "u4 abad", "u4 prore",
                            "u5 axial", "u5 abad", "u5 prore")
  wd_um_temp$time <- (wd_um_temp$time/4)
  
  wd_ca_temp <- data.frame(del_II_point[[(j+2)]][c(1, 5:7)], 
                           del_II_point[[(j+2)]][c(11:13)],
                           del_II_point[[(j+2)]][c(17:19)],
                           del_II_point[[(j+2)]][c(23:25)],
                           del_II_point[[(j+2)]][c(29:31)])
  colnames(wd_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                            "u2 axial", "u2 abad", "u2 prore",
                            "u3 axial", "u3 abad", "u3 prore",
                            "u4 axial", "u4 abad", "u4 prore",
                            "u5 axial", "u5 abad", "u5 prore")
  wd_ca_temp$time <- (wd_ca_temp$time/4)
  
  wod_um_temp <- data.frame(del_II_point[[(j+1)]][c(1, 2:4)],
                            del_II_point[[(j+1)]][c(8:10)],
                            del_II_point[[(j+1)]][c(14:16)],
                            del_II_point[[(j+1)]][c(20:22)],
                            del_II_point[[(j+1)]][c(26:28)])
  colnames(wod_um_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore",
                             "u5 axial", "u5 abad", "u5 prore")
  wod_um_temp$time <- (wod_um_temp$time/4)
  wod_ca_temp <- data.frame(del_II_point[[(j+1)]][c(1, 5:7)], 
                            del_II_point[[(j+1)]][c(11:13)],
                            del_II_point[[(j+1)]][c(17:19)],
                            del_II_point[[(j+1)]][c(23:25)],
                            del_II_point[[(j+1)]][c(29:31)])
  colnames(wod_ca_temp) <- c("time", "u1 axial", "u1 abad", "u1 prore",
                             "u2 axial", "u2 abad", "u2 prore",
                             "u3 axial", "u3 abad", "u3 prore",
                             "u4 axial", "u4 abad", "u4 prore",
                             "u5 axial", "u5 abad", "u5 prore")
  wod_ca_temp$time <- (wod_ca_temp$time/4)
  
  
  max_xyz <- reshape2::melt(data.frame(del_II_data[j, c(1:16)]), id.var = "jnt")
  max_xyz <- max_xyz %>% mutate(axis = if_else(str_detect(max_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(max_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(max_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(max_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(max_xyz[[2]], "_u2_"), "unit 2",
                                 ifelse(str_detect(max_xyz[[2]], "_u3_"), "unit 3",
                                        ifelse(str_detect(max_xyz[[2]], "_u4_"), "unit 4", "unit 5")))))
  
  
  wd_xyz <- reshape2::melt(data.frame(del_II_data[j, c(1, 17:31)]), id.var = "jnt")
  wd_xyz <- wd_xyz %>% mutate(axis = if_else(str_detect(wd_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(wd_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wd_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(wd_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(wd_xyz[[2]], "_u2_"), "unit 2",
                                 ifelse(str_detect(wd_xyz[[2]], "_u3_"), "unit 3",
                                        ifelse(str_detect(wd_xyz[[2]], "_u4_"), "unit 4", "unit 5")))))
  
  wod_xyz <- reshape2::melt(data.frame(del_II_data[j, c(1, 32:46)]), id.var = "jnt")
  wod_xyz <- wod_xyz %>% mutate(axis = if_else(str_detect(wod_xyz[[2]], "max_"), "max", "real")) %>%
    mutate(xyz = if_else(str_detect(wod_xyz[[2]], "_x"), "axial_rotation", 
                         if_else(str_detect(wod_xyz[[2]], "_y"), "abduct_adduct",
                                 "pro_retract"))) %>%
    mutate(unit = if_else(str_detect(wod_xyz[[2]], "_u1_"), "unit 1", 
                          ifelse(str_detect(wod_xyz[[2]], "_u2_"), "unit 2",
                                 ifelse(str_detect(wod_xyz[[2]], "_u3_"), "unit 3",
                                        ifelse(str_detect(wod_xyz[[2]], "_u4_"), "unit 4", "unit 5")))))
  x_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  x_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  x_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 axial`), colour =  "#893101",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 axial`), colour =  "#FCAE1E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 axial`), colour =  "#FF4C00",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u4 axial`), colour =  "#F5C77E",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u5 axial`), colour =  "#FFF689",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#893101", "#FCAE1E", "#FF4C00", "#F5C77E", "#FFF689")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linetype = "dotdash",linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linetype = "dotdash",linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  y_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 abad`), colour =  "#340664",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 abad`), colour =  "#2F139E",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 abad`), colour =  "#B100CD",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u4 abad`), colour =  "#896F95",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u5 abad`), colour =  "#E5CFFC",
              linetype = "dotdash",linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#340664", "#2F139E", "#B100CD", "#896F95", "#E5CFFC")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_max <- ggplot() +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = max_um_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = max_ca_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wd <- ggplot() +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_um_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wd_ca_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  z_wod <- ggplot() +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_um_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linewidth = 1.5, alpha = 1) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u1 prore`), colour =  "#041E42",
              linetype = "dotdash", linewidth = 1.5, alpha = .4) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u2 prore`), colour =  "#0E4C92",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u3 prore`), colour =  "#4682B4",
              linetype = "dotdash", linewidth = 1.5, alpha = .6) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u4 prore`), colour =  "#73C2FB",
              linetype = "dotdash", linewidth = 1.5, alpha = .8) +
    geom_line(data = wod_ca_temp, 
              aes(x = time, y = `u5 prore`), colour =  "#95C8D8",
              linetype = "dotdash", linewidth = 1.5, alpha = 1) +
    scale_colour_manual(name = "Muscle units", values = c("#041E42", "#0E4C92", "#4682B4", "#73C2FB", "#95C8D8")) +
    geom_vline(xintercept = 0.5, linetype = "solid", color = "#AE9882", linewidth = 5, alpha = .3) + 
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    scale_x_continuous(labels = scales::percent_format(accuracy = 1),expand = c(0, 0), limits = c(NA, NA)) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    xlab("Percentage of ventilatory cycle") +
    ylab("Moment arm (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  
  xyz_bar <- ggplot() +
    geom_bar(data = max_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .3) +
    geom_bar(data = wod_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .6) +
    geom_bar(data = wd_xyz, 
             aes(x = factor(xyz, levels = unique(xyz)), y = value, fill = xyz), 
             stat = "identity", position = position_dodge2(preserve = "single"), alpha = .8) +
    scale_fill_manual(name = "Muscle action", values = c("#2F139E", "#893101", "#041E42")) +
    scale_y_continuous(expand = c(0.2, 0), limits = c(NA, NA)) +
    geom_hline(yintercept = 0, linetype = "solid", color = "black", linewidth = 1) + 
    xlab("Muscle actions") +
    ylab("Moment arms (m)") +
    theme_classic() +
    theme(axis.line = element_line(colour = "black", linewidth = 0.5, linetype = "solid"), 
          axis.text.y = element_text(size = 5),
          axis.text.x = element_text(size = 5),
          axis.title = element_text(size = 9))
  
  p <- ggarrange(x_max, x_wd, x_wod, xyz_bar,
                 y_max, y_wd, y_wod, xyz_bar,
                 z_max, z_wd, z_wod, xyz_bar,
                 ncol = 4, nrow = 3,
                 labels = c("A", "B", "C", "D", 
                            "E", "F", "G", "H", 
                            "I", "K", "L", "M"),
                 common.legend = TRUE, legend = "bottom")
  
  ggsave(plot = p, dpi = 600, bg = "white", 
         filename = paste0("del_II_",  Rib_names[(j+2)], ".png"), 
         device = "png", width = 22, heigh = 28, units = "cm")}



# compare signs of moment arms and the signs of oROM to infer muscle functions
# only use realistic version for now
oROM_real <- oROM[c(3,4,6,8,13,15,17,18,20,22,24), c(6:8)]
t_oROM_real <- transpose(oROM_real)
colnames(t_oROM_real) <- oROM[c(3,4,6,8,13,15,17,18,20,22,24) ,1]


#predict for VIC
#get values from max expiration
f0_VIC <-rbindlist(VIC_clean_list[c(5:8)])
f0_VIC <- filter(f0_VIC, time == "0")
f0_VIC <- select(f0_VIC, matches("um"))
f0_VIC <- transpose(f0_VIC)
f0_VIC <- cbind(f0_VIC, t_oROM_real[, rep(c(1:4))])

colnames(f0_VIC) <- c("C10", "C11", "C13", "C15", 
                     "oROM10", "oROM11", "oROM13", "oROM15")
f0_VIC <- f0_VIC %>%
  mutate(Muscle = c("VIC_u1_axis", "VIC_u1_ab_ad", "VIC_u1_pro_re",
                    "VIC_u2_axis", "VIC_u2_ab_ad", "VIC_u2_pro_re",
                    "VIC_u3_axis", "VIC_u3_ab_ad", "VIC_u3_pro_re",
                    "VIC_u4_axis", "VIC_u4_ab_ad", "VIC_u4_pro_re",
                    "VIC_u5_axis", "VIC_u5_ab_ad", "VIC_u5_pro_re"),
         C10_vfun = ifelse(sign(f0_VIC$C10) == sign(f0_VIC$oROM10), "Ins", "Exp"),
         C11_vfun = ifelse(sign(f0_VIC$C11) == sign(f0_VIC$oROM11), "Ins", "Exp"),
         C13_vfun = ifelse(sign(f0_VIC$C13) == sign(f0_VIC$oROM13), "Ins", "Exp"),
         C15_vfun = ifelse(sign(f0_VIC$C15) == sign(f0_VIC$oROM15), "Ins", "Exp")
  )

#get values from max inspiration
f2_VIC <-rbindlist(VIC_clean_list[c(5:8)])
f2_VIC <- filter(f2_VIC, time == "2")
f2_VIC <- select(f2_VIC, matches("um"))
f2_VIC <- transpose(f2_VIC)
f2_VIC <- cbind(f2_VIC, t_oROM_real[, rep(c(1:4))])

colnames(f2_VIC) <- c("C10", "C11", "C13", "C15", 
                      "oROM10", "oROM11", "oROM13", "oROM15")
f2_VIC <- f2_VIC %>%
  mutate(Muscle = c("VIC_u1_axis", "VIC_u1_ab_ad", "VIC_u1_pro_re",
                    "VIC_u2_axis", "VIC_u2_ab_ad", "VIC_u2_pro_re",
                    "VIC_u3_axis", "VIC_u3_ab_ad", "VIC_u3_pro_re",
                    "VIC_u4_axis", "VIC_u4_ab_ad", "VIC_u4_pro_re",
                    "VIC_u5_axis", "VIC_u5_ab_ad", "VIC_u5_pro_re"),
         C10_vfun = ifelse(sign(f2_VIC$C10) == sign(f2_VIC$oROM10), "Ins", "Exp"),
         C11_vfun = ifelse(sign(f2_VIC$C11) == sign(f2_VIC$oROM11), "Ins", "Exp"),
         C13_vfun = ifelse(sign(f2_VIC$C13) == sign(f2_VIC$oROM13), "Ins", "Exp"),
         C15_vfun = ifelse(sign(f2_VIC$C15) == sign(f2_VIC$oROM15), "Ins", "Exp")
  )

#create a consensus between the two
VIC_fuc <- data.frame(
  muscle = rep("VIC", nrow(f2_VIC)),
  
  `muscle unit` = ifelse(str_detect(f2_VIC$Muscle, "u1"), "unit 1", 
                         ifelse(str_detect(f2_VIC$Muscle, "u2"), "unit 2",
                                ifelse(str_detect(f2_VIC$Muscle, "u3"), "unit 3",
                                       ifelse(str_detect(f2_VIC$Muscle, "u4"), "unit 4", "unit 5")))),
  
  `muscle action` = ifelse(str_detect(f2_VIC$Muscle, "axis"), "axial rotation", 
                           ifelse(str_detect(f2_VIC$Muscle, "ab_ad"), "abduction/adduction", 
                                  "protraction/retraction")),
  
  C10_vfun = ifelse(!(f2_VIC$C10_vfun == f0_VIC$C10_vfun), "Mix",
                    ifelse(f2_VIC$C10_vfun == "Ins", "Ins", "Exp")),
  
  C11_vfun = ifelse(!(f2_VIC$C11_vfun == f0_VIC$C11_vfun), "Mix",
                    ifelse(f2_VIC$C11_vfun == "Ins", "Ins", "Exp")),
  
  C13_vfun = ifelse(!(f2_VIC$C13_vfun == f0_VIC$C13_vfun), "Mix",
                    ifelse(f2_VIC$C13_vfun == "Ins", "Ins", "Exp")),
  
  C15_vfun = ifelse(!(f2_VIC$C15_vfun == f0_VIC$C15_vfun), "Mix",
                    ifelse(f2_VIC$C15_vfun == "Ins", "Ins", "Exp")))

#predict for LC
#get values from max expiration
f0_LC <-rbindlist(LC_list[c(5:8)])
f0_LC <- filter(f0_LC, time == "0")
f0_LC <- select(f0_LC, matches("um"))
f0_LC <- transpose(f0_LC)
f0_LC <- cbind(f0_LC, t_oROM_real[, rep(c(1:4))])

colnames(f0_LC) <- c("C10", "C11", "C13", "C15", 
                     "oROM10", "oROM11", "oROM13", "oROM15")
f0_LC <- f0_LC %>%
  mutate(Muscle = c("LC_u1_axis", "LC_u1_ab_ad", "LC_u1_pro_re"),
         C10_vfun = ifelse(sign(f0_LC$C10) == sign(f0_LC$oROM10), "Ins", "Exp"),
         C11_vfun = ifelse(sign(f0_LC$C11) == sign(f0_LC$oROM11), "Ins", "Exp"),
         C13_vfun = ifelse(sign(f0_LC$C13) == sign(f0_LC$oROM13), "Ins", "Exp"),
         C15_vfun = ifelse(sign(f0_LC$C15) == sign(f0_LC$oROM15), "Ins", "Exp")
  )

#get values from max inspiration
f2_LC <-rbindlist(LC_list[c(5:8)])
f2_LC <- filter(f2_LC, time == "2")
f2_LC <- select(f2_LC, matches("um"))
f2_LC <- transpose(f2_LC)
f2_LC <- cbind(f2_LC, t_oROM_real[, rep(c(1:4))])

colnames(f2_LC) <- c("C10", "C11", "C13", "C15", 
                     "oROM10", "oROM11", "oROM13", "oROM15")
f2_LC <- f2_LC %>%
  mutate(Muscle = c("LC_u1_axis", "LC_u1_ab_ad", "LC_u1_pro_re"),
         C10_vfun = ifelse(sign(f2_LC$C10) == sign(f2_LC$oROM10), "Ins", "Exp"),
         C11_vfun = ifelse(sign(f2_LC$C11) == sign(f2_LC$oROM11), "Ins", "Exp"),
         C13_vfun = ifelse(sign(f2_LC$C13) == sign(f2_LC$oROM13), "Ins", "Exp"),
         C15_vfun = ifelse(sign(f2_LC$C15) == sign(f2_LC$oROM15), "Ins", "Exp")
  )

#create a consensus between the two
LC_fuc <- data.frame(
  muscle = rep("LC", nrow(f2_LC)),
  
  `muscle unit` = ifelse(str_detect(f2_LC$Muscle, "u1"), "unit 1", "unit 2"),
  
  `muscle action` = ifelse(str_detect(f2_LC$Muscle, "axis"), "axial rotation", 
                           ifelse(str_detect(f2_LC$Muscle, "ab_ad"), "abduction/adduction", 
                                  "protraction/retraction")),
  
  C10_vfun = ifelse(!(f2_LC$C10_vfun == f0_LC$C10_vfun), "Mix",
                    ifelse(f2_LC$C10_vfun == "Ins", "Ins", "Exp")),
  
  C11_vfun = ifelse(!(f2_LC$C11_vfun == f0_LC$C11_vfun), "Mix",
                    ifelse(f2_LC$C11_vfun == "Ins", "Ins", "Exp")),
  
  C13_vfun = ifelse(!(f2_LC$C13_vfun == f0_LC$C13_vfun), "Mix",
                    ifelse(f2_LC$C13_vfun == "Ins", "Ins", "Exp")),
  
  C15_vfun = ifelse(!(f2_LC$C15_vfun == f0_LC$C15_vfun), "Mix",
                    ifelse(f2_LC$C15_vfun == "Ins", "Ins", "Exp")))

#predict for IE
#get values from max expiration
f0_IE <-rbindlist(IE_clean_list[c(5:8)])
f0_IE <- filter(f0_IE, time == "0")
f0_IE <- select(f0_IE, matches("um"))
f0_IE <- transpose(f0_IE)
f0_IE <- cbind(f0_IE, t_oROM_real[, rep(c(1:4))])

colnames(f0_IE) <- c("C10", "C11", "C13", "C15", 
                      "oROM10", "oROM11", "oROM13", "oROM15")
f0_IE <- f0_IE %>%
  mutate(Muscle = c("IE_u1_axis", "IE_u1_ab_ad", "IE_u1_pro_re",
                    "IE_u2_axis", "IE_u2_ab_ad", "IE_u2_pro_re",
                    "IE_u3_axis", "IE_u3_ab_ad", "IE_u3_pro_re",
                    "IE_u4_axis", "IE_u4_ab_ad", "IE_u4_pro_re"),
         C10_vfun = ifelse(sign(f0_IE$C10) == sign(f0_IE$oROM10), "Ins", "Exp"),
         C11_vfun = ifelse(sign(f0_IE$C11) == sign(f0_IE$oROM11), "Ins", "Exp"),
         C13_vfun = ifelse(sign(f0_IE$C13) == sign(f0_IE$oROM13), "Ins", "Exp"),
         C15_vfun = ifelse(sign(f0_IE$C15) == sign(f0_IE$oROM15), "Ins", "Exp")
  )

#get values from max inspiration
f2_IE <-rbindlist(IE_clean_list[c(5:8)])
f2_IE <- filter(f2_IE, time == "2")
f2_IE <- select(f2_IE, matches("um"))
f2_IE <- transpose(f2_IE)
f2_IE <- cbind(f2_IE, t_oROM_real[, rep(c(1:4))])

colnames(f2_IE) <- c("C10", "C11", "C13", "C15", 
                      "oROM10", "oROM11", "oROM13", "oROM15")
f2_IE <- f2_IE %>%
  mutate(Muscle = c("IE_u1_axis", "IE_u1_ab_ad", "IE_u1_pro_re",
                    "IE_u2_axis", "IE_u2_ab_ad", "IE_u2_pro_re",
                    "IE_u3_axis", "IE_u3_ab_ad", "IE_u3_pro_re",
                    "IE_u4_axis", "IE_u4_ab_ad", "IE_u4_pro_re"),
         C10_vfun = ifelse(sign(f2_IE$C10) == sign(f2_IE$oROM10), "Ins", "Exp"),
         C11_vfun = ifelse(sign(f2_IE$C11) == sign(f2_IE$oROM11), "Ins", "Exp"),
         C13_vfun = ifelse(sign(f2_IE$C13) == sign(f2_IE$oROM13), "Ins", "Exp"),
         C15_vfun = ifelse(sign(f2_IE$C15) == sign(f2_IE$oROM15), "Ins", "Exp")
  )

#create a consensus between the two
IE_fuc <- data.frame(
  muscle = rep("IE", nrow(f2_IE)),
  
  `muscle unit` = ifelse(str_detect(f2_IE$Muscle, "u1"), "unit 1", 
                         ifelse(str_detect(f2_IE$Muscle, "u2"), "unit 2",
                                ifelse(str_detect(f2_IE$Muscle, "u3"), "unit 3", "unit 4"))),
  
  `muscle action` = ifelse(str_detect(f2_IE$Muscle, "axis"), "axial rotation", 
                           ifelse(str_detect(f2_IE$Muscle, "ab_ad"), "abduction/adduction", 
                                  "protraction/retraction")),
  
  C10_vfun = ifelse(!(f2_IE$C10_vfun == f0_IE$C10_vfun), "Mix",
                    ifelse(f2_IE$C10_vfun == "Ins", "Ins", "Exp")),
  
  C11_vfun = ifelse(!(f2_IE$C11_vfun == f0_IE$C11_vfun), "Mix",
                    ifelse(f2_IE$C11_vfun == "Ins", "Ins", "Exp")),
  
  C13_vfun = ifelse(!(f2_IE$C13_vfun == f0_IE$C13_vfun), "Mix",
                    ifelse(f2_IE$C13_vfun == "Ins", "Ins", "Exp")),
  
  C15_vfun = ifelse(!(f2_IE$C15_vfun == f0_IE$C15_vfun), "Mix",
                    ifelse(f2_IE$C15_vfun == "Ins", "Ins", "Exp")))


#predict for APC_vr
#get values from max expiration
f0_APC_vr <-rbindlist(APC_vr_list[c(4:6)])
f0_APC_vr <- filter(f0_APC_vr, time == "0")
f0_APC_vr <- select(f0_APC_vr, matches("um"))
f0_APC_vr <- transpose(f0_APC_vr)
f0_APC_vr <- cbind(f0_APC_vr, t_oROM_real[, rep(c(2:4))])

colnames(f0_APC_vr) <- c("C11", "C13", "C15", 
                     "oROM11", "oROM13", "oROM15")
f0_APC_vr <- f0_APC_vr %>%
  mutate(Muscle = c("APC_vr_u1_axis", "APC_vr_u1_ab_ad", "APC_vr_u1_pro_re",
                    "APC_vr_u2_axis", "APC_vr_u2_ab_ad", "APC_vr_u2_pro_re",
                    "APC_vr_u3_axis", "APC_vr_u3_ab_ad", "APC_vr_u3_pro_re"),
         C11_vfun = ifelse(sign(f0_APC_vr$C11) == sign(f0_APC_vr$oROM11), "Ins", "Exp"),
         C13_vfun = ifelse(sign(f0_APC_vr$C13) == sign(f0_APC_vr$oROM13), "Ins", "Exp"),
         C15_vfun = ifelse(sign(f0_APC_vr$C15) == sign(f0_APC_vr$oROM15), "Ins", "Exp")
  )

#get values from max inspiration
f2_APC_vr <-rbindlist(APC_vr_list[c(4:6)])
f2_APC_vr <- filter(f2_APC_vr, time == "2")
f2_APC_vr <- select(f2_APC_vr, matches("um"))
f2_APC_vr <- transpose(f2_APC_vr)
f2_APC_vr <- cbind(f2_APC_vr, t_oROM_real[, rep(c(2:4))])

colnames(f2_APC_vr) <- c("C11", "C13", "C15", 
                     "oROM11", "oROM13", "oROM15")
f2_APC_vr <- f2_APC_vr %>%
  mutate(Muscle = c("APC_vr_u1_axis", "APC_vr_u1_ab_ad", "APC_vr_u1_pro_re",
                    "APC_vr_u2_axis", "APC_vr_u2_ab_ad", "APC_vr_u2_pro_re",
                    "APC_vr_u3_axis", "APC_vr_u3_ab_ad", "APC_vr_u3_pro_re"),
         C11_vfun = ifelse(sign(f2_APC_vr$C11) == sign(f2_APC_vr$oROM11), "Ins", "Exp"),
         C13_vfun = ifelse(sign(f2_APC_vr$C13) == sign(f2_APC_vr$oROM13), "Ins", "Exp"),
         C15_vfun = ifelse(sign(f2_APC_vr$C15) == sign(f2_APC_vr$oROM15), "Ins", "Exp")
  )

#create a consensus between the two
APC_vr_fuc <- data.frame(
  muscle = rep("APC_vr", nrow(f2_APC_vr)),
  
  `muscle unit` = ifelse(str_detect(f2_APC_vr$Muscle, "u1"), "unit 1", 
                         ifelse(str_detect(f2_APC_vr$Muscle, "u2"), "unit 2", "unit 3")),
  
  `muscle action` = ifelse(str_detect(f2_APC_vr$Muscle, "axis"), "axial rotation", 
                           ifelse(str_detect(f2_APC_vr$Muscle, "ab_ad"), "abduction/adduction", 
                                  "protraction/retraction")),
  
  C11_vfun = ifelse(!(f2_APC_vr$C11_vfun == f0_APC_vr$C11_vfun), "Mix",
                    ifelse(f2_APC_vr$C11_vfun == "Ins", "Ins", "Exp")),
  
  C13_vfun = ifelse(!(f2_APC_vr$C13_vfun == f0_APC_vr$C13_vfun), "Mix",
                    ifelse(f2_APC_vr$C13_vfun == "Ins", "Ins", "Exp")),
  
  C15_vfun = ifelse(!(f2_APC_vr$C15_vfun == f0_APC_vr$C15_vfun), "Mix",
                    ifelse(f2_APC_vr$C15_vfun == "Ins", "Ins", "Exp")))


#predict for APC_ir
#get values from max expiration
f0_APC_ir <-rbindlist(APC_ir_list[c(4:6)])
f0_APC_ir <- filter(f0_APC_ir, time == "0")
f0_APC_ir <- select(f0_APC_ir, matches("um"))
f0_APC_ir <- transpose(f0_APC_ir)
f0_APC_ir <- cbind(f0_APC_ir, t_oROM_real[, rep(c(5, 6, 8))])

colnames(f0_APC_ir) <- c("DIR11", "DIR13", "DIR16", 
                         "oROM11", "oROM13", "oROM16")
f0_APC_ir <- f0_APC_ir %>%
  mutate(Muscle = c("APC_ir_u1_axis", "APC_ir_u1_ab_ad", "APC_ir_u1_pro_re",
                    "APC_ir_u2_axis", "APC_ir_u2_ab_ad", "APC_ir_u2_pro_re",
                    "APC_ir_u3_axis", "APC_ir_u3_ab_ad", "APC_ir_u3_pro_re"),
         DIR11_vfun = ifelse(sign(f0_APC_ir$DIR11) == sign(f0_APC_ir$oROM11), "Ins", "Exp"),
         DIR13_vfun = ifelse(sign(f0_APC_ir$DIR13) == sign(f0_APC_ir$oROM13), "Ins", "Exp"),
         DIR16_vfun = ifelse(sign(f0_APC_ir$DIR16) == sign(f0_APC_ir$oROM16), "Ins", "Exp")
  )

#get values from max inspiration
f2_APC_ir <-rbindlist(APC_ir_list[c(4:6)])
f2_APC_ir <- filter(f2_APC_ir, time == "2")
f2_APC_ir <- select(f2_APC_ir, matches("um"))
f2_APC_ir <- transpose(f2_APC_ir)
f2_APC_ir <- cbind(f2_APC_ir, t_oROM_real[, rep(c(5, 6, 8))])

colnames(f2_APC_ir) <- c("DIR11", "DIR13", "DIR16", 
                         "oROM11", "oROM13", "oROM16")
f2_APC_ir <- f2_APC_ir %>%
  mutate(Muscle = c("APC_ir_u1_axis", "APC_ir_u1_ab_ad", "APC_ir_u1_pro_re",
                    "APC_ir_u2_axis", "APC_ir_u2_ab_ad", "APC_ir_u2_pro_re",
                    "APC_ir_u3_axis", "APC_ir_u3_ab_ad", "APC_ir_u3_pro_re"),
         DIR11_vfun = ifelse(sign(f2_APC_ir$DIR11) == sign(f2_APC_ir$oROM11), "Ins", "Exp"),
         DIR13_vfun = ifelse(sign(f2_APC_ir$DIR13) == sign(f2_APC_ir$oROM13), "Ins", "Exp"),
         DIR16_vfun = ifelse(sign(f2_APC_ir$DIR16) == sign(f2_APC_ir$oROM16), "Ins", "Exp")
  )

#create a consensus between the two
APC_ir_fuc <- data.frame(
  muscle = rep("APC_ir", nrow(f2_APC_ir)),
  
  `muscle unit` = ifelse(str_detect(f2_APC_ir$Muscle, "u1"), "unit 1", 
                         ifelse(str_detect(f2_APC_ir$Muscle, "u2"), "unit 2", "unit 3")),
  
  `muscle action` = ifelse(str_detect(f2_APC_ir$Muscle, "axis"), "axial rotation", 
                           ifelse(str_detect(f2_APC_ir$Muscle, "ab_ad"), "abduction/adduction", 
                                  "protraction/retraction")),
  
  DIR11_vfun = ifelse(!(f2_APC_ir$DIR11_vfun == f0_APC_ir$DIR11_vfun), "Mix",
                    ifelse(f2_APC_ir$DIR11_vfun == "Ins", "Ins", "Exp")),
  
  DIR13_vfun = ifelse(!(f2_APC_ir$DIR13_vfun == f0_APC_ir$DIR13_vfun), "Mix",
                    ifelse(f2_APC_ir$DIR13_vfun == "Ins", "Ins", "Exp")),
  
  DIR16_vfun = ifelse(!(f2_APC_ir$DIR16_vfun == f0_APC_ir$DIR16_vfun), "Mix",
                    ifelse(f2_APC_ir$DIR16_vfun == "Ins", "Ins", "Exp")))


#predict for II_vr
#get values from max expiration
f0_II_vr <-rbindlist(II_vr_list[c(5:8)])
f0_II_vr <- filter(f0_II_vr, time == "0")
f0_II_vr <- select(f0_II_vr, matches("um"))
f0_II_vr <- transpose(f0_II_vr)
f0_II_vr <- cbind(f0_II_vr, t_oROM_real[, rep(c(1:4))])

colnames(f0_II_vr) <- c("C10", "C11", "C13", "C15", 
                      "oROM10", "oROM11", "oROM13", "oROM15")
f0_II_vr <- f0_II_vr %>%
  mutate(Muscle = c("II_vr_u1_axis", "II_vr_u1_ab_ad", "II_vr_u1_pro_re",
                    "II_vr_u2_axis", "II_vr_u2_ab_ad", "II_vr_u2_pro_re",
                    "II_vr_u3_axis", "II_vr_u3_ab_ad", "II_vr_u3_pro_re",
                    "II_vr_u4_axis", "II_vr_u4_ab_ad", "II_vr_u4_pro_re",
                    "II_vr_u5_axis", "II_vr_u5_ab_ad", "II_vr_u5_pro_re"),
         C10_vfun = ifelse(sign(f0_II_vr$C10) == sign(f0_II_vr$oROM10), "Ins", "Exp"),
         C11_vfun = ifelse(sign(f0_II_vr$C11) == sign(f0_II_vr$oROM11), "Ins", "Exp"),
         C13_vfun = ifelse(sign(f0_II_vr$C13) == sign(f0_II_vr$oROM13), "Ins", "Exp"),
         C15_vfun = ifelse(sign(f0_II_vr$C15) == sign(f0_II_vr$oROM15), "Ins", "Exp")
  )

#get values from max inspiration
f2_II_vr <-rbindlist(II_vr_list[c(5:8)])
f2_II_vr <- filter(f2_II_vr, time == "2")
f2_II_vr <- select(f2_II_vr, matches("um"))
f2_II_vr <- transpose(f2_II_vr)
f2_II_vr <- cbind(f2_II_vr, t_oROM_real[, rep(c(1:4))])

colnames(f2_II_vr) <- c("C10", "C11", "C13", "C15", 
                      "oROM10", "oROM11", "oROM13", "oROM15")
f2_II_vr <- f2_II_vr %>%
  mutate(Muscle = c("II_vr_u1_axis", "II_vr_u1_ab_ad", "II_vr_u1_pro_re",
                    "II_vr_u2_axis", "II_vr_u2_ab_ad", "II_vr_u2_pro_re",
                    "II_vr_u3_axis", "II_vr_u3_ab_ad", "II_vr_u3_pro_re",
                    "II_vr_u4_axis", "II_vr_u4_ab_ad", "II_vr_u4_pro_re",
                    "II_vr_u5_axis", "II_vr_u5_ab_ad", "II_vr_u5_pro_re"),
         C10_vfun = ifelse(sign(f2_II_vr$C10) == sign(f2_II_vr$oROM10), "Ins", "Exp"),
         C11_vfun = ifelse(sign(f2_II_vr$C11) == sign(f2_II_vr$oROM11), "Ins", "Exp"),
         C13_vfun = ifelse(sign(f2_II_vr$C13) == sign(f2_II_vr$oROM13), "Ins", "Exp"),
         C15_vfun = ifelse(sign(f2_II_vr$C15) == sign(f2_II_vr$oROM15), "Ins", "Exp")
  )

#create a consensus between the two
II_vr_fuc <- data.frame(
  muscle = rep("II_vr", nrow(f2_II_vr)),
  
  `muscle unit` = ifelse(str_detect(f2_II_vr$Muscle, "u1"), "unit 1", 
                         ifelse(str_detect(f2_II_vr$Muscle, "u2"), "unit 2",
                                ifelse(str_detect(f2_II_vr$Muscle, "u3"), "unit 3",
                                       ifelse(str_detect(f2_II_vr$Muscle, "u4"), "unit 4", "unit 5")))),
  
  `muscle action` = ifelse(str_detect(f2_II_vr$Muscle, "axis"), "axial rotation", 
                           ifelse(str_detect(f2_II_vr$Muscle, "ab_ad"), "abduction/adduction", 
                                  "protraction/retraction")),
  
  C10_vfun = ifelse(!(f2_II_vr$C10_vfun == f0_II_vr$C10_vfun), "Mix",
                    ifelse(f2_II_vr$C10_vfun == "Ins", "Ins", "Exp")),
  
  C11_vfun = ifelse(!(f2_II_vr$C11_vfun == f0_II_vr$C11_vfun), "Mix",
                    ifelse(f2_II_vr$C11_vfun == "Ins", "Ins", "Exp")),
  
  C13_vfun = ifelse(!(f2_II_vr$C13_vfun == f0_II_vr$C13_vfun), "Mix",
                    ifelse(f2_II_vr$C13_vfun == "Ins", "Ins", "Exp")),
  
  C15_vfun = ifelse(!(f2_II_vr$C15_vfun == f0_II_vr$C15_vfun), "Mix",
                    ifelse(f2_II_vr$C15_vfun == "Ins", "Ins", "Exp")))


#predict for II_ir
#get values from max expiration
f0_II_ir <-rbindlist(II_ir_list[c(3:4)])
f0_II_ir <- filter(f0_II_ir, time == "0")
f0_II_ir <- select(f0_II_ir, matches("um"))
f0_II_ir <- transpose(f0_II_ir)
f0_II_ir <- cbind(f0_II_ir, t_oROM_real[, rep(c(5:6))])

colnames(f0_II_ir) <- c("DIR11", "DIR13", 
                         "oROM11", "oROM13")
f0_II_ir <- f0_II_ir %>%
  mutate(Muscle = c("II_ir_u1_axis", "II_ir_u1_ab_ad", "II_ir_u1_pro_re",
                    "II_ir_u2_axis", "II_ir_u2_ab_ad", "II_ir_u2_pro_re",
                    "II_ir_u3_axis", "II_ir_u3_ab_ad", "II_ir_u3_pro_re"),
         DIR11_vfun = ifelse(sign(f0_II_ir$DIR11) == sign(f0_II_ir$oROM11), "Ins", "Exp"),
         DIR13_vfun = ifelse(sign(f0_II_ir$DIR13) == sign(f0_II_ir$oROM13), "Ins", "Exp")
  )

#get values from max inspiration
f2_II_ir <-rbindlist(II_ir_list[c(3:4)])
f2_II_ir <- filter(f2_II_ir, time == "2")
f2_II_ir <- select(f2_II_ir, matches("um"))
f2_II_ir <- transpose(f2_II_ir)
f2_II_ir <- cbind(f2_II_ir, t_oROM_real[, rep(c(5:6))])

colnames(f2_II_ir) <- c("DIR11", "DIR13",
                         "oROM11", "oROM13")
f2_II_ir <- f2_II_ir %>%
  mutate(Muscle = c("II_ir_u1_axis", "II_ir_u1_ab_ad", "II_ir_u1_pro_re",
                    "II_ir_u2_axis", "II_ir_u2_ab_ad", "II_ir_u2_pro_re",
                    "II_ir_u3_axis", "II_ir_u3_ab_ad", "II_ir_u3_pro_re"),
         DIR11_vfun = ifelse(sign(f2_II_ir$DIR11) == sign(f2_II_ir$oROM11), "Ins", "Exp"),
         DIR13_vfun = ifelse(sign(f2_II_ir$DIR13) == sign(f2_II_ir$oROM13), "Ins", "Exp")
  )

#create a consensus between the two
II_ir_fuc <- data.frame(
  muscle = rep("II_ir", nrow(f2_II_ir)),
  
  `muscle unit` = ifelse(str_detect(f2_II_ir$Muscle, "u1"), "unit 6", 
                         ifelse(str_detect(f2_II_ir$Muscle, "u2"), "unit 7", "unit 8")),
  
  `muscle action` = ifelse(str_detect(f2_II_ir$Muscle, "axis"), "axial rotation", 
                           ifelse(str_detect(f2_II_ir$Muscle, "ab_ad"), "abduction/adduction", 
                                  "protraction/retraction")),
  
  DIR11_vfun = ifelse(!(f2_II_ir$DIR11_vfun == f0_II_ir$DIR11_vfun), "Mix",
                      ifelse(f2_II_ir$DIR11_vfun == "Ins", "Ins", "Exp")),
  
  DIR13_vfun = ifelse(!(f2_II_ir$DIR13_vfun == f0_II_ir$DIR13_vfun), "Mix",
                      ifelse(f2_II_ir$DIR13_vfun == "Ins", "Ins", "Exp")))


#predict for SC
#get values from max expiration
f0_SC <-rbindlist(SC_list[c(4:6)])
f0_SC <- filter(f0_SC, time == "0")
f0_SC <- select(f0_SC, matches("um"))
f0_SC <- transpose(f0_SC)
f0_SC <- cbind(f0_SC, t_oROM_real[, rep(c(9:11))])

colnames(f0_SC) <- c("VIR11", "VIR13", "VIR15", 
                         "oROM11", "oROM13", "oROM15")
f0_SC <- f0_SC %>%
  mutate(Muscle = c("SC_u1_axis", "SC_u1_ab_ad", "SC_u1_pro_re",
                    "SC_u2_axis", "SC_u2_ab_ad", "SC_u2_pro_re",
                    "SC_u3_axis", "SC_u3_ab_ad", "SC_u3_pro_re"),
         VIR11_vfun = ifelse(sign(f0_SC$VIR11) == sign(f0_SC$oROM11), "Ins", "Exp"),
         VIR13_vfun = ifelse(sign(f0_SC$VIR13) == sign(f0_SC$oROM13), "Ins", "Exp"),
         VIR15_vfun = ifelse(sign(f0_SC$VIR15) == sign(f0_SC$oROM15), "Ins", "Exp")
  )

#get values from max inspiration
f2_SC <-rbindlist(SC_list[c(4:6)])
f2_SC <- filter(f2_SC, time == "2")
f2_SC <- select(f2_SC, matches("um"))
f2_SC <- transpose(f2_SC)
f2_SC <- cbind(f2_SC, t_oROM_real[, rep(c(9:11))])

colnames(f2_SC) <- c("VIR11", "VIR13", "VIR15", 
                         "oROM11", "oROM13", "oROM15")
f2_SC <- f2_SC %>%
  mutate(Muscle = c("SC_u1_axis", "SC_u1_ab_ad", "SC_u1_pro_re",
                    "SC_u2_axis", "SC_u2_ab_ad", "SC_u2_pro_re",
                    "SC_u3_axis", "SC_u3_ab_ad", "SC_u3_pro_re"),
         VIR11_vfun = ifelse(sign(f2_SC$VIR11) == sign(f2_SC$oROM11), "Ins", "Exp"),
         VIR13_vfun = ifelse(sign(f2_SC$VIR13) == sign(f2_SC$oROM13), "Ins", "Exp"),
         VIR15_vfun = ifelse(sign(f2_SC$VIR15) == sign(f2_SC$oROM15), "Ins", "Exp")
  )

#create a consensus between the two
SC_fuc <- data.frame(
  muscle = rep("SC", nrow(f2_SC)),
  
  `muscle unit` = ifelse(str_detect(f2_SC$Muscle, "u1"), "unit 1", 
                         ifelse(str_detect(f2_SC$Muscle, "u2"), "unit 2", "unit 3")),
  
  `muscle action` = ifelse(str_detect(f2_SC$Muscle, "axis"), "axial rotation", 
                           ifelse(str_detect(f2_SC$Muscle, "ab_ad"), "abduction/adduction", 
                                  "protraction/retraction")),
  
  VIR11_vfun = ifelse(!(f2_SC$VIR11_vfun == f0_SC$VIR11_vfun), "Mix",
                    ifelse(f2_SC$VIR11_vfun == "Ins", "Ins", "Exp")),
  
  VIR13_vfun = ifelse(!(f2_SC$VIR13_vfun == f0_SC$VIR13_vfun), "Mix",
                    ifelse(f2_SC$VIR13_vfun == "Ins", "Ins", "Exp")),
  
  VIR15_vfun = ifelse(!(f2_SC$VIR15_vfun == f0_SC$VIR15_vfun), "Mix",
                    ifelse(f2_SC$VIR15_vfun == "Ins", "Ins", "Exp")))


#predict for del_VIC
#get values from max expiration
f0_del_VIC <-rbindlist(del_VIC_point[c(3)])
f0_del_VIC <- filter(f0_del_VIC, time == "0")
f0_del_VIC <- select(f0_del_VIC, matches("um"))
f0_del_VIC <- transpose(f0_del_VIC)
f0_del_VIC <- cbind(f0_del_VIC, t_oROM_real[, rep(c(3))])

colnames(f0_del_VIC) <- c("C13", 
                      "oROM13")
f0_del_VIC <- f0_del_VIC %>%
  mutate(Muscle = c("del_VIC_u1_axis", "del_VIC_u1_ab_ad", "del_VIC_u1_pro_re",
                    "del_VIC_u2_axis", "del_VIC_u2_ab_ad", "del_VIC_u2_pro_re",
                    "del_VIC_u3_axis", "del_VIC_u3_ab_ad", "del_VIC_u3_pro_re",
                    "del_VIC_u4_axis", "del_VIC_u4_ab_ad", "del_VIC_u4_pro_re",
                    "del_VIC_u5_axis", "del_VIC_u5_ab_ad", "del_VIC_u5_pro_re"),
         C13_vfun = ifelse(sign(f0_del_VIC$C13) == sign(f0_del_VIC$oROM13), "Ins", "Exp")
  )

#get values from max inspiration
f2_del_VIC <-rbindlist(del_VIC_point[c(3)])
f2_del_VIC <- filter(f2_del_VIC, time == "2")
f2_del_VIC <- select(f2_del_VIC, matches("um"))
f2_del_VIC <- transpose(f2_del_VIC)
f2_del_VIC <- cbind(f2_del_VIC, t_oROM_real[, rep(c(3))])

colnames(f2_del_VIC) <- c("C13",
                      "oROM13")
f2_del_VIC <- f2_del_VIC %>%
  mutate(Muscle = c("del_VIC_u1_axis", "del_VIC_u1_ab_ad", "del_VIC_u1_pro_re",
                    "del_VIC_u2_axis", "del_VIC_u2_ab_ad", "del_VIC_u2_pro_re",
                    "del_VIC_u3_axis", "del_VIC_u3_ab_ad", "del_VIC_u3_pro_re",
                    "del_VIC_u4_axis", "del_VIC_u4_ab_ad", "del_VIC_u4_pro_re",
                    "del_VIC_u5_axis", "del_VIC_u5_ab_ad", "del_VIC_u5_pro_re"),
         C13_vfun = ifelse(sign(f2_del_VIC$C13) == sign(f2_del_VIC$oROM13), "Ins", "Exp")
  )

#create a consensus between the two
del_VIC_fuc <- data.frame(
  muscle = rep("del_VIC", nrow(f2_del_VIC)),
  
  `muscle unit` = ifelse(str_detect(f2_del_VIC$Muscle, "u1"), "unit 1", 
                         ifelse(str_detect(f2_del_VIC$Muscle, "u2"), "unit 2",
                                ifelse(str_detect(f2_del_VIC$Muscle, "u3"), "unit 3",
                                       ifelse(str_detect(f2_del_VIC$Muscle, "u4"), "unit 4", "unit 5")))),
  
  `muscle action` = ifelse(str_detect(f2_del_VIC$Muscle, "axis"), "axial rotation", 
                           ifelse(str_detect(f2_del_VIC$Muscle, "ab_ad"), "abduction/adduction", 
                                  "protraction/retraction")),
  
  C13_vfun = ifelse(!(f2_del_VIC$C13_vfun == f0_del_VIC$C13_vfun), "Mix",
                    ifelse(f2_del_VIC$C13_vfun == "Ins", "Ins", "Exp")))


#predict for del_IE
#get values from max expiration
f0_del_IE <-rbindlist(del_IE_point[c(3)])
f0_del_IE <- filter(f0_del_IE, time == "0")
f0_del_IE <- select(f0_del_IE, matches("um"))
f0_del_IE <- transpose(f0_del_IE)
f0_del_IE <- cbind(f0_del_IE, t_oROM_real[, rep(c(3))])

colnames(f0_del_IE) <- c("C13", 
                          "oROM13")
f0_del_IE <- f0_del_IE %>%
  mutate(Muscle = c("del_IE_u1_axis", "del_IE_u1_ab_ad", "del_IE_u1_pro_re",
                    "del_IE_u2_axis", "del_IE_u2_ab_ad", "del_IE_u2_pro_re",
                    "del_IE_u3_axis", "del_IE_u3_ab_ad", "del_IE_u3_pro_re",
                    "del_IE_u4_axis", "del_IE_u4_ab_ad", "del_IE_u4_pro_re"),
         C13_vfun = ifelse(sign(f0_del_IE$C13) == sign(f0_del_IE$oROM13), "Ins", "Exp")
  )

#get values from max inspiration
f2_del_IE <-rbindlist(del_IE_point[c(3)])
f2_del_IE <- filter(f2_del_IE, time == "2")
f2_del_IE <- select(f2_del_IE, matches("um"))
f2_del_IE <- transpose(f2_del_IE)
f2_del_IE <- cbind(f2_del_IE, t_oROM_real[, rep(c(3))])

colnames(f2_del_IE) <- c("C13",
                          "oROM13")
f2_del_IE <- f2_del_IE %>%
  mutate(Muscle = c("del_IE_u1_axis", "del_IE_u1_ab_ad", "del_IE_u1_pro_re",
                    "del_IE_u2_axis", "del_IE_u2_ab_ad", "del_IE_u2_pro_re",
                    "del_IE_u3_axis", "del_IE_u3_ab_ad", "del_IE_u3_pro_re",
                    "del_IE_u4_axis", "del_IE_u4_ab_ad", "del_IE_u4_pro_re"),
         C13_vfun = ifelse(sign(f2_del_IE$C13) == sign(f2_del_IE$oROM13), "Ins", "Exp")
  )

#create a consensus between the two
del_IE_fuc <- data.frame(
  muscle = rep("del_IE", nrow(f2_del_IE)),
  
  `muscle unit` = ifelse(str_detect(f2_del_IE$Muscle, "u1"), "unit 1", 
                         ifelse(str_detect(f2_del_IE$Muscle, "u2"), "unit 2",
                                ifelse(str_detect(f2_del_IE$Muscle, "u3"), "unit 3", "unit 4"))),
  
  `muscle action` = ifelse(str_detect(f2_del_IE$Muscle, "axis"), "axial rotation", 
                           ifelse(str_detect(f2_del_IE$Muscle, "ab_ad"), "abduction/adduction", 
                                  "protraction/retraction")),
  
  C13_vfun = ifelse(!(f2_del_IE$C13_vfun == f0_del_IE$C13_vfun), "Mix",
                    ifelse(f2_del_IE$C13_vfun == "Ins", "Ins", "Exp")))



#predict for del_II
#get values from max expiration
f0_del_II <-rbindlist(del_II_point[c(3)])
f0_del_II <- filter(f0_del_II, time == "0")
f0_del_II <- select(f0_del_II, matches("um"))
f0_del_II <- transpose(f0_del_II)
f0_del_II <- cbind(f0_del_II, t_oROM_real[, rep(c(3))])

colnames(f0_del_II) <- c("C13", 
                          "oROM13")
f0_del_II <- f0_del_II %>%
  mutate(Muscle = c("del_II_u1_axis", "del_II_u1_ab_ad", "del_II_u1_pro_re",
                    "del_II_u2_axis", "del_II_u2_ab_ad", "del_II_u2_pro_re",
                    "del_II_u3_axis", "del_II_u3_ab_ad", "del_II_u3_pro_re",
                    "del_II_u4_axis", "del_II_u4_ab_ad", "del_II_u4_pro_re",
                    "del_II_u5_axis", "del_II_u5_ab_ad", "del_II_u5_pro_re"),
         C13_vfun = ifelse(sign(f0_del_II$C13) == sign(f0_del_II$oROM13), "Ins", "Exp")
  )

#get values from max inspiration
f2_del_II <-rbindlist(del_II_point[c(3)])
f2_del_II <- filter(f2_del_II, time == "2")
f2_del_II <- select(f2_del_II, matches("um"))
f2_del_II <- transpose(f2_del_II)
f2_del_II <- cbind(f2_del_II, t_oROM_real[, rep(c(3))])

colnames(f2_del_II) <- c("C13",
                          "oROM13")
f2_del_II <- f2_del_II %>%
  mutate(Muscle = c("del_II_u1_axis", "del_II_u1_ab_ad", "del_II_u1_pro_re",
                    "del_II_u2_axis", "del_II_u2_ab_ad", "del_II_u2_pro_re",
                    "del_II_u3_axis", "del_II_u3_ab_ad", "del_II_u3_pro_re",
                    "del_II_u4_axis", "del_II_u4_ab_ad", "del_II_u4_pro_re",
                    "del_II_u5_axis", "del_II_u5_ab_ad", "del_II_u5_pro_re"),
         C13_vfun = ifelse(sign(f2_del_II$C13) == sign(f2_del_II$oROM13), "Ins", "Exp")
  )

#create a consensus between the two
del_II_fuc <- data.frame(
  muscle = rep("del_II", nrow(f2_del_II)),
  
  `muscle unit` = ifelse(str_detect(f2_del_II$Muscle, "u1"), "unit 1", 
                         ifelse(str_detect(f2_del_II$Muscle, "u2"), "unit 2",
                                ifelse(str_detect(f2_del_II$Muscle, "u3"), "unit 3",
                                       ifelse(str_detect(f2_del_II$Muscle, "u4"), "unit 4", "unit 5")))),
  
  `muscle action` = ifelse(str_detect(f2_del_II$Muscle, "axis"), "axial rotation", 
                           ifelse(str_detect(f2_del_II$Muscle, "ab_ad"), "abduction/adduction", 
                                  "protraction/retraction")),
  
  C13_vfun = ifelse(!(f2_del_II$C13_vfun == f0_del_II$C13_vfun), "Mix",
                    ifelse(f2_del_II$C13_vfun == "Ins", "Ins", "Exp")))


#compile all predictions into a table for supplementary information
mus_vr_fuc <- bind_rows(VIC_fuc, LC_fuc, IE_fuc, APC_vr_fuc, II_vr_fuc, del_VIC_fuc, del_IE_fuc, del_II_fuc)
mus_vr_fuc[is.na(mus_vr_fuc)] <- "-"
mus_ir_fuc <- bind_rows(APC_ir_fuc, II_ir_fuc)
mus_ir_fuc[is.na(mus_ir_fuc)] <- "-"
mus_sr_fuc <- bind_rows(SC_fuc)
mus_sr_fuc[is.na(mus_sr_fuc)] <- "-"
write.csv(mus_vr_fuc, "croc_vr_muscle_unit_function.csv", row.names = FALSE)
write.csv(mus_ir_fuc, "croc_ir_muscle_unit_function.csv", row.names = FALSE)
write.csv(mus_sr_fuc, "croc_sr_muscle_unit_function.csv", row.names = FALSE)